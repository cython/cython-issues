{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "<!--\r\n**Note:**\r\n- Do not use the bug and feature tracker for support requests. Use the `cython-users` mailing list instead.\r\n- Did you search for similar issues already? Please do, it helps to save us precious time that we otherwise could not invest into development.\r\n- Did you try the latest master branch or pre-release? It might already have what you want to report. Also see the [Changelog](https://github.com/cython/cython/blob/master/CHANGES.rst) regarding recent changes.\r\n-->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\nI'm writing some bindings for a C library called Miniaudio, where the user passes in a Python callback that gets called by my Cython code with an input buffer and an output buffer. You're supposed to write data to the output buffer while leaving the input buffer unchanged, but I don't know of a way to make a Cython array that is not writable from Python. I don't think there is a way to create a readonly memoryview to a Cython array, and even if there was, the 'base' attribute of Cython memoryview objects would still allow access to the underlying, very much writable array. In the past I have managed to accidentally write to the input buffer and then wonder why nothing was happening.\r\n\r\n\r\n**Describe the solution you'd like**\r\nI'd like to be able to pass an extra parameter, readonly, when creating Cython arrays that, when set to true, raises an exception when attempting to write to the array from Python. Converting that array into a memoryview also yields a readonly memoryview.\r\n\r\n**Describe alternatives you've considered**\r\n\r\n**Additional context**\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "COLLABORATOR",
            "body": "It's definitely possible to create a [readonly Cython memoryview](https://cython.readthedocs.io/en/latest/src/userguide/memoryviews.html#read-only-views). However I think you're right that if you cast a pointer to the create a Cython memoryview then the underlying `cython.view.array` object would have no read-only protection.\r\n\r\nYour best option would probably be to implement your own wrapper class for the pointer (similar https://cython.readthedocs.io/en/latest/src/userguide/buffer.html#a-matrix-class, but probably simpler because it'd be 1D).\r\n\r\nI'm not sure if we should necessarily support this within Cython. `cython.view.array` when we do provide the tools for users to write their own wrappers too. Maybe... but I'm not completely convinced.",
            "created_at": "2022-01-04T22:07:33Z",
            "html_url": "https://github.com/cython/cython/issues/4555#issuecomment-1005206189",
            "id": 1005206189,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4555",
            "node_id": "IC_kwDOABDGAc476jqt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1005206189/reactions"
            },
            "updated_at": "2022-01-04T22:07:54Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1005206189",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/4555/comments",
    "created_at": "2022-01-04T21:51:15Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2022-01-04T22:08:11Z",
            "event": "labeled",
            "id": 5843098630,
            "label": {
                "color": "444444",
                "name": "enhancement"
            },
            "node_id": "LE_lADOABDGAc5BMcs2zwAAAAFcRpwG",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/5843098630"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/4555/events",
    "html_url": "https://github.com/cython/cython/issues/4555",
    "id": 1093782326,
    "labels": [
        {
            "color": "444444",
            "default": true,
            "description": null,
            "id": 425556243,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw0MjU1NTYyNDM=",
            "url": "https://api.github.com/repos/cython/cython/labels/enhancement"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/4555/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5BMcs2",
    "number": 4555,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/4555/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/4555/timeline",
    "title": "[ENH] Add a 'readonly' parameter to the constructor of cython.view.array",
    "updated_at": "2022-01-04T22:08:11Z",
    "url": "https://api.github.com/repos/cython/cython/issues/4555",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/47483928?v=4",
        "events_url": "https://api.github.com/users/Keithcat1/events{/privacy}",
        "followers_url": "https://api.github.com/users/Keithcat1/followers",
        "following_url": "https://api.github.com/users/Keithcat1/following{/other_user}",
        "gists_url": "https://api.github.com/users/Keithcat1/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Keithcat1",
        "id": 47483928,
        "login": "Keithcat1",
        "node_id": "MDQ6VXNlcjQ3NDgzOTI4",
        "organizations_url": "https://api.github.com/users/Keithcat1/orgs",
        "received_events_url": "https://api.github.com/users/Keithcat1/received_events",
        "repos_url": "https://api.github.com/users/Keithcat1/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Keithcat1/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Keithcat1/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Keithcat1"
    }
}