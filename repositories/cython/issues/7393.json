{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Describe the bug\n\n## Context\n\nI'm working on [Godot-Python](https://github.com/touilleMan/godot-python), which provides Python bindings to the Godot game engine.\n\nThe bindings needs to expose to Python all the [Godot classes and builtins](https://docs.godotengine.org/en/stable/classes/), however I also want those bindings to be usable from Cython with minimal overhead (so that the end-user can write his game logic as a Cython module \\o/).\n\n## The issue\n\nConsider the binding code to work with the Godot String builtin type, it is located in `godot/builtins.pyx` and `godot/builtins.pxd` files and declares all its methods as `cpdef` and `inline` in the `.pxd` file:\n\n```cython\n# godot/builtins.pxd\n@cython.final\ncdef class GDString:\n    cdef gd_string_t _gd_data  # Pointer on the actual instance of the Godot class\n\n    cdef inline GDString reverse(self, ):\n        cdef GDString ret = GDString.__new__(GDString)\n        # Call the Godot C API, `gdapi.gd_string_meth_reverse` is a function pointer located in another Cython module\n        ret._gd_data = gdapi.gd_string_meth_reverse(\n            &self._gd_data,\n        )\n        return ret\n```\n\nHowever this leads to an unexpected behavior, let's consider another Cython module called `my.pyx`\n```cython\n# my.pyx\nfrom godot cimport builtins\n```\n\n## Expected behavior:\n\nThis module does nothing, so I would expect the `cpdef inline` statements to be simply ignored and the `my.so` compiled module to have no reference whatsoever to this `reverse` method (nor to the `GDString` builtin class).\n\n## Actual behavior:\n\nThe `my.so` compiled module contains symbols referring to this `reverse` method:\n```bash\n$ nm my.so | grep reverse\n                 U gdpy_gdptr_string_meth_reverse\n0000000000009e10 r __pyx_k_GDString_reverse\n0000000000009f18 r __pyx_k_reverse\n000000000000c940 d __pyx_mdef_5godot_8builtins_8GDString_1reverse\n0000000000007be0 t __pyx_pw_5godot_8builtins_8GDString_1reverse\n```\n\nIn practice what happens here is the `inline` directive is simply ignored and all the methods markes `cpdef inline` are simply added and compiled as part of the `my.pyx` module.\n\nFor Godot-Python this is really bad since Godot exposes more than a thousand methods, which means the extension is much slower to compile, and the resulting `my.so` is bigger and contains a ton of unneeded symbols :/\n\n## A workaround\n\nAs a workaround, I currently duplicate the code in two:\n- The Python binding (i.e. `def foo()`) in `builtins.pyx`\n- The Cython binding (i.e. `cdef inline foo()` in `builtins.pxd`\n\nThis works as expected, however this has two drawbacks:\n- It duplicates the code\n- It produce a lot of warnings during compilation since I obviously should be using `cpdef`: `warning: src/godot/builtins.c.p/godot/builtins.pyx:3026:4: Overriding a c(p)def method with a def method. This can lead to different methods being called depending on the call context. Consider using a cpdef method for both.`\n\n\n### Code to reproduce the behaviour:\n\n_No response_\n\n### Expected behaviour\n\n_No response_\n\n### OS\n\n_No response_\n\n### Python version\n\n3.13,3.14\n\n### Cython version\n\n3.1.3\n\n### Additional context\n\n_No response_",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/7393/comments",
    "created_at": "2025-12-07T11:04:15Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/7393/events",
    "html_url": "https://github.com/cython/cython/issues/7393",
    "id": 3703372645,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/7393/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc7cvPtl",
    "number": 7393,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/7393/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/7393/timeline",
    "title": "[BUG] `cpdef inline` in `.pxd` file lead to duplicated code in all `.pyx` cimporting it",
    "type": null,
    "updated_at": "2025-12-07T11:05:24Z",
    "url": "https://api.github.com/repos/cython/cython/issues/7393",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4",
        "events_url": "https://api.github.com/users/touilleMan/events{/privacy}",
        "followers_url": "https://api.github.com/users/touilleMan/followers",
        "following_url": "https://api.github.com/users/touilleMan/following{/other_user}",
        "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/touilleMan",
        "id": 3187637,
        "login": "touilleMan",
        "node_id": "MDQ6VXNlcjMxODc2Mzc=",
        "organizations_url": "https://api.github.com/users/touilleMan/orgs",
        "received_events_url": "https://api.github.com/users/touilleMan/received_events",
        "repos_url": "https://api.github.com/users/touilleMan/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/touilleMan",
        "user_view_type": "public"
    }
}