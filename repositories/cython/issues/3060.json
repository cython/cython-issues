{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Hello,\r\n\r\nI am encountering a compiler error in cython when compiling the following expression:\r\n\r\n`product(*[range(k) for k in reversed(range(1, N, 2))])`\r\n\r\nwhere N is a previously assigned integer.\r\n\r\nThe compiler error is:\r\n\r\n```\r\n File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/UtilNodes.py\", line 185, in result\r\n    return self.result_code\r\nAttributeError: 'ResultRefNode' object has no attribute 'result_code'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"setup.py\", line 5, in <module>\r\n    ext_modules=cythonize(\"util.pyx\", compiler_directives={'language_level' : \"3\"})) \r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Build/Dependencies.py\", line 1096, in cythonize\r\n    cythonize_one(*args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Build/Dependencies.py\", line 1202, in cythonize_one\r\n    result = compile_single(pyx_file, options, full_module_name=full_module_name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Main.py\", line 727, in compile_single\r\n    return run_pipeline(source, options, full_module_name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Main.py\", line 515, in run_pipeline\r\n    err, enddata = Pipeline.run_pipeline(pipeline, source)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Pipeline.py\", line 355, in run_pipeline\r\n    data = run(phase, data)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Pipeline.py\", line 335, in run\r\n    return phase(data)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Pipeline.py\", line 52, in generate_pyx_code_stage\r\n    module_node.process_implementation(options, result)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ModuleNode.py\", line 143, in process_implementation\r\n    self.generate_c_code(env, options, result)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ModuleNode.py\", line 384, in generate_c_code\r\n    self.body.generate_function_definitions(env, code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 442, in generate_function_definitions\r\n    stat.generate_function_definitions(env, code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 442, in generate_function_definitions\r\n    stat.generate_function_definitions(env, code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 3176, in generate_function_definitions\r\n    FuncDefNode.generate_function_definitions(self, env, code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 1983, in generate_function_definitions\r\n    self.generate_function_body(env, code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 1745, in generate_function_body\r\n    self.body.generate_execution_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 448, in generate_execution_code\r\n    stat.generate_execution_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 5973, in generate_execution_code\r\n    value.generate_evaluation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 767, in generate_evaluation_code\r\n    self.generate_subexpr_evaluation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 782, in generate_subexpr_evaluation_code\r\n    node.generate_evaluation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 767, in generate_evaluation_code\r\n    self.generate_subexpr_evaluation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 782, in generate_subexpr_evaluation_code\r\n    node.generate_evaluation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 8236, in generate_evaluation_code\r\n    generate_inner_evaluation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 773, in generate_evaluation_code\r\n    self.generate_result_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 8305, in generate_result_code\r\n    self.generate_operation_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 8321, in generate_operation_code\r\n    self.loop.generate_execution_code(code)\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/Nodes.py\", line 6901, in generate_execution_code\r\n    self.bound1.result(), offset,\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 499, in result\r\n    return self.calculate_result_code()\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 11321, in calculate_result_code\r\n    result1, result2 = self.operand1.result(), self.operand2.result()\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 499, in result\r\n    return self.calculate_result_code()\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 11321, in calculate_result_code\r\n    result1, result2 = self.operand1.result(), self.operand2.result()\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/UtilNodes.py\", line 188, in result\r\n    self.result_code = self.expression.result()\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 499, in result\r\n    return self.calculate_result_code()\r\n  File \"/usr/local/lib/python3.6/dist-packages/Cython/Compiler/ExprNodes.py\", line 1377, in calculate_result_code\r\n    return self.result_code\r\nAttributeError: 'IntNode' object has no attribute 'result_code'\r\n```\r\n\r\nThe following slightly simpler expressions do compile with no errors,\r\n\r\n`product(*[range(k) for k in (range(1, N, 2))])`\r\n\r\n^^ n.b no 'reversed' call\r\n\r\n`product(*[range(k) for k in reversed(range(1, N))])`\r\n\r\n^^ n.b no third argument to range function\r\n\r\nThe purpose of the code snippet I'm testing is similar to e.g. https://stackoverflow.com/a/13020502\r\n\r\nI'm using compiler_directives={'language_level' : \"3\"} with Cython 0.29.13 for use in Python 3.6.8.\r\n\r\nThanks in advance for any suggestions for fixing this and thanks for all the developers' work on cython!\r\n",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3060/comments",
    "created_at": "2019-07-29T16:07:58Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3060/events",
    "html_url": "https://github.com/cython/cython/issues/3060",
    "id": 474135138,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3060/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU0NzQxMzUxMzg=",
    "number": 3060,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Compiler error for reversed range with step parameter",
    "updated_at": "2019-07-29T16:07:58Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3060",
    "user": {
        "avatar_url": "https://avatars1.githubusercontent.com/u/1727426?v=4",
        "events_url": "https://api.github.com/users/nesanders/events{/privacy}",
        "followers_url": "https://api.github.com/users/nesanders/followers",
        "following_url": "https://api.github.com/users/nesanders/following{/other_user}",
        "gists_url": "https://api.github.com/users/nesanders/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/nesanders",
        "id": 1727426,
        "login": "nesanders",
        "node_id": "MDQ6VXNlcjE3Mjc0MjY=",
        "organizations_url": "https://api.github.com/users/nesanders/orgs",
        "received_events_url": "https://api.github.com/users/nesanders/received_events",
        "repos_url": "https://api.github.com/users/nesanders/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/nesanders/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/nesanders/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/nesanders"
    }
}