{
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "This is a feature request related to #1915 and #2079.\r\n\r\nOn at least two occasions, I would have found it useful to be able to add code in the Cython-generated `.c` file before all Cython code (i.e. before `#include <Python.h>`). This would typically be to fix some OS-dependent issues with an appropriate `#define`.\r\n\r\nThis would be relatively easy to implement but I'm not sure about a good syntax. The first that comes to my mind is an empty include file (making the mental association that the Cython file is still empty at the point where the code would be inserted):\r\n```\r\ncdef extern from \"\":\r\n    \"\"\"\r\n    /* This code appears before Cython's #include <Python.h> */\r\n    \"\"\"\r\n```",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "I've never seen a need to set a `#define`s for `Python.h`, and it seems to me that it should better not be necessary. Could you give a concrete example?",
            "created_at": "2018-04-08T10:28:09Z",
            "html_url": "https://github.com/cython/cython/issues/2183#issuecomment-379539255",
            "id": 379539255,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2183",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3OTUzOTI1NQ==",
            "updated_at": "2018-04-08T10:28:09Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/379539255",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Feature test macros: https://www.gnu.org/software/libc/manual/html_node/Feature-Test-Macros.html\r\n\r\nThese are explicitly documented as \"You should define these macros by using ‘#define’ preprocessor directives at the top of your source code files. These directives must come before any #include of a system header file.\"",
            "created_at": "2018-04-09T13:56:50Z",
            "html_url": "https://github.com/cython/cython/issues/2183#issuecomment-379761051",
            "id": 379761051,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2183",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3OTc2MTA1MQ==",
            "updated_at": "2018-04-09T13:56:50Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/379761051",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/3625785?v=4",
                "events_url": "https://api.github.com/users/jdemeyer/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdemeyer/followers",
                "following_url": "https://api.github.com/users/jdemeyer/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdemeyer/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdemeyer",
                "id": 3625785,
                "login": "jdemeyer",
                "node_id": "MDQ6VXNlcjM2MjU3ODU=",
                "organizations_url": "https://api.github.com/users/jdemeyer/orgs",
                "received_events_url": "https://api.github.com/users/jdemeyer/received_events",
                "repos_url": "https://api.github.com/users/jdemeyer/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdemeyer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdemeyer/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdemeyer"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That link also says: \"You could also use the ‘-D’ option to GCC, but it’s better if you make the source files indicate their own meaning in a self-contained way.\"\r\n\r\n\"It's better\" doesn't read like it's strictly required to `#define` these macros in the source file.",
            "created_at": "2018-04-17T19:01:22Z",
            "html_url": "https://github.com/cython/cython/issues/2183#issuecomment-382105224",
            "id": 382105224,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2183",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MjEwNTIyNA==",
            "updated_at": "2018-04-17T19:01:22Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/382105224",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "First of all, doing it in the sources also makes it easier to do system-specific stuff. Say\r\n```\r\n#ifdef __CYGWIN__\r\n/* Cygwin-specific defines here */\r\n#endif\r\n```\r\n\r\nSecond, this allows overriding macros even if the system `CFLAGS` contain flags breaking the build: whatever is in the sources overrides whatever is on the command line.",
            "created_at": "2018-04-17T19:05:56Z",
            "html_url": "https://github.com/cython/cython/issues/2183#issuecomment-382106603",
            "id": 382106603,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2183",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MjEwNjYwMw==",
            "updated_at": "2018-04-17T19:05:56Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/382106603",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/3625785?v=4",
                "events_url": "https://api.github.com/users/jdemeyer/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdemeyer/followers",
                "following_url": "https://api.github.com/users/jdemeyer/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdemeyer/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdemeyer",
                "id": 3625785,
                "login": "jdemeyer",
                "node_id": "MDQ6VXNlcjM2MjU3ODU=",
                "organizations_url": "https://api.github.com/users/jdemeyer/orgs",
                "received_events_url": "https://api.github.com/users/jdemeyer/received_events",
                "repos_url": "https://api.github.com/users/jdemeyer/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdemeyer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdemeyer/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdemeyer"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2183/comments",
    "created_at": "2018-03-28T09:58:42Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2183/events",
    "html_url": "https://github.com/cython/cython/issues/2183",
    "id": 309298451,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2183/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUzMDkyOTg0NTE=",
    "number": 2183,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Allow inserting verbatim code before all other code",
    "updated_at": "2018-04-17T19:05:57Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2183",
    "user": {
        "avatar_url": "https://avatars0.githubusercontent.com/u/3625785?v=4",
        "events_url": "https://api.github.com/users/jdemeyer/events{/privacy}",
        "followers_url": "https://api.github.com/users/jdemeyer/followers",
        "following_url": "https://api.github.com/users/jdemeyer/following{/other_user}",
        "gists_url": "https://api.github.com/users/jdemeyer/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/jdemeyer",
        "id": 3625785,
        "login": "jdemeyer",
        "node_id": "MDQ6VXNlcjM2MjU3ODU=",
        "organizations_url": "https://api.github.com/users/jdemeyer/orgs",
        "received_events_url": "https://api.github.com/users/jdemeyer/received_events",
        "repos_url": "https://api.github.com/users/jdemeyer/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/jdemeyer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jdemeyer/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/jdemeyer"
    }
}