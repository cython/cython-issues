{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Describe the bug\r\n\r\nWhen method of inherited class is overridden, the type of self argument is kept from parent class instead of child class. This occurs only for instances not for classes - see example below.\r\n\r\n### Code to reproduce the behaviour:\r\n\r\n```cython\r\nimport cython\r\ncdef class A:\r\n\r\n    cdef int plus(self, int a, int b):\r\n        return a + b\r\n\r\ncdef class B(A):\r\n    cdef int c\r\n    def __init__(self):\r\n        self.c = 5\r\n\r\n    cdef int plus(self, int a, int b):\r\n        return self.c - a - b\r\n\r\n\r\ncdef B b = B()\r\ncdef A a = A()\r\n\r\nprint('A.plus:', cython.typeof(A.plus))    # A.plus and a.plus have consistent type\r\nprint('a.plus:', cython.typeof(a.plus))\r\nprint('B.plus:', cython.typeof(B.plus))    # B.plus has different type than b.plus\r\nprint('b.plus:', cython.typeof(b.plus))\r\n\r\ncdef int (*meth)(A, int, int)\r\nmeth = b.plus                              # Wrong type of b.plus allows us to assign the value to wrong function pointer \r\n\r\nprint('B.plus():', b.plus(2, 2))\r\nprint('meth(B):', meth(b, 2, 2))\r\nprint('meth(A):', meth(a, 2, 2))           # This is causing wrong error returned since instance a has class A which does not have c attribute required by B.plus() method\r\n```\r\n\r\nResult:\r\n\r\n```\r\nA.plus: int (A, int, int) except *\r\na.plus: int (A, int, int) except *\r\nB.plus: int (B, int, int) except *\r\nb.plus: int (A, int, int) except *\r\nB.plus(): 1\r\nmeth(B): 1\r\nmeth(A): 238986829\r\n```\r\n\r\n### Expected behaviour\r\n\r\n1. `cython.typeof(b.plus)` should be ` int (B, int, int) except *`\r\n2. `meth = b.plus` should trigger an compilation error same as snippet bellow\r\n\r\n    ```cython\r\n    meth = B.plus\r\n    ```\r\n\r\n    which generates following error: `Cannot assign type 'int (B, int, int) except *' to 'int (*)(A, int, int) except *'`\r\n3. Following snippet should work (currently yields an error):\r\n    ```cython\r\n    cdef int (*meth2)(B, int, int)\r\n    meth2 = b.plus \r\n    ```\r\n    \r\n    \r\n### OS\r\n\r\nAny\r\n\r\n### Python version\r\n\r\nAny\r\n\r\n### Cython version\r\n\r\nmaster\r\n\r\n### Additional context\r\n\r\n_No response_",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "```\r\nmeth = b.plus\r\n```\r\n\r\nThis always seemed a bit dodgy to me because it doesn't create a bound method (because you can't really express that in C).\r\n\r\nOn that basis I'm not sure it's a huge issue - it's something that \"works\" largely by chance but not something we should encourage because it's misleading.",
            "created_at": "2024-01-01T09:39:13Z",
            "html_url": "https://github.com/cython/cython/issues/5932#issuecomment-1873247876",
            "id": 1873247876,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5932",
            "node_id": "IC_kwDOABDGAc5vp36E",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1873247876/reactions"
            },
            "updated_at": "2024-01-01T09:39:13Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1873247876",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> This always seemed a bit dodgy to me because it doesn't create a bound method (because you can't really express that in C).\r\n\r\nI imagine. I am creating (and trying to fix this issue) is mainly because of PR #5931 which breaks test due this issue - see comment: https://github.com/cython/cython/pull/5931#discussion_r1438940801",
            "created_at": "2024-01-01T10:16:06Z",
            "html_url": "https://github.com/cython/cython/issues/5932#issuecomment-1873260715",
            "id": 1873260715,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5932",
            "node_id": "IC_kwDOABDGAc5vp7Cr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1873260715/reactions"
            },
            "updated_at": "2024-01-01T10:16:21Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1873260715",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "https://github.com/cython/cython/issues/2747#issuecomment-1889945532 might be related as well. I always considered it hacky that we only remember the `cname` of `final` methods separately, instead of having a real `Entry` available that we can assign to the `AttributeNode` when we find out that we're referring to a `final` method.",
            "created_at": "2024-01-12T21:06:23Z",
            "html_url": "https://github.com/cython/cython/issues/5932#issuecomment-1889948854",
            "id": 1889948854,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5932",
            "node_id": "IC_kwDOABDGAc5wplS2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1889948854/reactions"
            },
            "updated_at": "2024-01-12T21:06:23Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1889948854",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5932/comments",
    "created_at": "2024-01-01T09:17:32Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-01T09:17:32Z",
            "event": "labeled",
            "id": 11364472396,
            "label": {
                "color": "444444",
                "name": "defect"
            },
            "node_id": "LE_lADOABDGAc563wJ0zwAAAAKlYBZM",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11364472396"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-01T09:17:32Z",
            "event": "labeled",
            "id": 11364472397,
            "label": {
                "color": "444444",
                "name": "Type Analysis"
            },
            "node_id": "LE_lADOABDGAc563wJ0zwAAAAKlYBZN",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11364472397"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-01T09:17:32Z",
            "event": "milestoned",
            "id": 11364472399,
            "milestone": {
                "title": "3.0.x"
            },
            "node_id": "MIE_lADOABDGAc563wJ0zwAAAAKlYBZP",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11364472399"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-01T10:24:34Z",
            "event": "demilestoned",
            "id": 11364627873,
            "milestone": {
                "title": "3.0.x"
            },
            "node_id": "DEME_lADOABDGAc563wJ0zwAAAAKlYnWh",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11364627873"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5932/events",
    "html_url": "https://github.com/cython/cython/issues/5932",
    "id": 2061435508,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425553654,
            "name": "defect",
            "node_id": "MDU6TGFiZWw0MjU1NTM2NTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/defect"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425558824,
            "name": "Type Analysis",
            "node_id": "MDU6TGFiZWw0MjU1NTg4MjQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/Type%20Analysis"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5932/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc563wJ0",
    "number": 5932,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5932/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5932/timeline",
    "title": "[BUG] Inherited instance method has wrong type",
    "updated_at": "2024-01-12T21:06:24Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5932",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
        "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
        "followers_url": "https://api.github.com/users/matusvalo/followers",
        "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
        "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/matusvalo",
        "id": 827060,
        "login": "matusvalo",
        "node_id": "MDQ6VXNlcjgyNzA2MA==",
        "organizations_url": "https://api.github.com/users/matusvalo/orgs",
        "received_events_url": "https://api.github.com/users/matusvalo/received_events",
        "repos_url": "https://api.github.com/users/matusvalo/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/matusvalo"
    }
}