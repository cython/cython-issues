{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nSetuptools/distutils is not able to locate VS2022 when running Python 3.10/3.11\r\n\r\n\n\n### Code to reproduce the behaviour:\n\n_No response_\n\n### Expected behaviour\n\n_No response_\n\n### Environment\n\nOS:: Windows\r\nPython version 3.10/3.11\r\nCython version any\r\nVisual Studio 2022\r\n\n\n### Additional context\n\nThis is not to report a bug. It is to report a solution to the bug. \r\n\r\nI am sure that there have been several bug reports about this..\r\n\r\nI wrote a library that properly detects all visual studio versions., all build tools versions and all Windows SDKs.\r\nPut it to you this way, it sets up an identical build environment that Visual Studio does. It does this without using the problematic vcvars*.batch files. \r\n\r\nTo use the fix add puMSVC to your build requirements and import the module. Then call `pyMSVC.setup_environment()` that's all there is to it. \r\n\r\nThe library does not monkey patch distutils or setup tools at all so nothing special needs to be done with your build code. Include directories and library directories get added automatically. You will have to add the python library when constructing the Extension instance.  ",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for pointing this out. I've added a quick note about it in the \"installing\" section of the docs (https://github.com/cython/cython/commit/1b028d34d6a3ec82f4687df1e0db598721c7a695) - hopefully it'll help some people out.",
            "created_at": "2022-11-13T09:07:19Z",
            "html_url": "https://github.com/cython/cython/issues/5126#issuecomment-1312679596",
            "id": 1312679596,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5126",
            "node_id": "IC_kwDOABDGAc5OPeas",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1312679596/reactions"
            },
            "updated_at": "2022-11-13T09:07:19Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1312679596",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "NONE",
            "body": "no worries m8. That pyMSVC library took me a long time to get all dialed in and it uses the same com interfaces that vswhere uses to collect information about vs2017 and newer installations of Visual Studio.\r\n\r\nWhat I would like to know is if there is anything that can be added to help out on the Cython side of things.\r\n\r\nI just thought of this and as a suggestion. If a person passes a .py file to have compiled using Cython it would be smashing if that py file was put into the same folder as the pyd/so file except change the extension to pyi. No reason why a python code file cannot be used as a stub file for the c extension.\r\n\r\n",
            "created_at": "2022-11-14T01:54:04Z",
            "html_url": "https://github.com/cython/cython/issues/5126#issuecomment-1312934907",
            "id": 1312934907,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5126",
            "node_id": "IC_kwDOABDGAc5OQcv7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1312934907/reactions"
            },
            "updated_at": "2022-11-14T01:54:04Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1312934907",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10932297?v=4",
                "events_url": "https://api.github.com/users/kdschlosser/events{/privacy}",
                "followers_url": "https://api.github.com/users/kdschlosser/followers",
                "following_url": "https://api.github.com/users/kdschlosser/following{/other_user}",
                "gists_url": "https://api.github.com/users/kdschlosser/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kdschlosser",
                "id": 10932297,
                "login": "kdschlosser",
                "node_id": "MDQ6VXNlcjEwOTMyMjk3",
                "organizations_url": "https://api.github.com/users/kdschlosser/orgs",
                "received_events_url": "https://api.github.com/users/kdschlosser/received_events",
                "repos_url": "https://api.github.com/users/kdschlosser/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kdschlosser/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kdschlosser/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kdschlosser"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5126/comments",
    "created_at": "2022-11-13T00:17:17Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5126/events",
    "html_url": "https://github.com/cython/cython/issues/5126",
    "id": 1446660246,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5126/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5WOkiW",
    "number": 5126,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5126/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5126/timeline",
    "title": "[BUG] compilation using setuptools and VS2022",
    "updated_at": "2022-11-14T01:54:05Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5126",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10932297?v=4",
        "events_url": "https://api.github.com/users/kdschlosser/events{/privacy}",
        "followers_url": "https://api.github.com/users/kdschlosser/followers",
        "following_url": "https://api.github.com/users/kdschlosser/following{/other_user}",
        "gists_url": "https://api.github.com/users/kdschlosser/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/kdschlosser",
        "id": 10932297,
        "login": "kdschlosser",
        "node_id": "MDQ6VXNlcjEwOTMyMjk3",
        "organizations_url": "https://api.github.com/users/kdschlosser/orgs",
        "received_events_url": "https://api.github.com/users/kdschlosser/received_events",
        "repos_url": "https://api.github.com/users/kdschlosser/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/kdschlosser/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kdschlosser/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/kdschlosser"
    }
}