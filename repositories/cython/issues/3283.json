{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Hello, I am implementing a efficient numeric circular buffer 'library' in Cython and I was surprised that it's not possible to use templating with extension types (cdef class), only methods can be templated. This way, it's impossible to implement any generic classes or containers! Is that true? If so, it would be a very useful new feature. Also if you know about a nice workaround, I would be glad to hear about it.",
    "closed_at": "2019-12-23T19:32:27Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Could you please provide an example of what you're trying to achieve?",
            "created_at": "2019-12-23T14:05:38Z",
            "html_url": "https://github.com/cython/cython/issues/3283#issuecomment-568484363",
            "id": 568484363,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3283",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODQ4NDM2Mw==",
            "updated_at": "2019-12-23T14:05:38Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568484363",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/13689192?v=4",
                "events_url": "https://api.github.com/users/McSinyx/events{/privacy}",
                "followers_url": "https://api.github.com/users/McSinyx/followers",
                "following_url": "https://api.github.com/users/McSinyx/following{/other_user}",
                "gists_url": "https://api.github.com/users/McSinyx/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/McSinyx",
                "id": 13689192,
                "login": "McSinyx",
                "node_id": "MDQ6VXNlcjEzNjg5MTky",
                "organizations_url": "https://api.github.com/users/McSinyx/orgs",
                "received_events_url": "https://api.github.com/users/McSinyx/received_events",
                "repos_url": "https://api.github.com/users/McSinyx/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/McSinyx/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/McSinyx/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/McSinyx"
            }
        },
        {
            "author_association": "NONE",
            "body": "```python\r\ncdef class CircularBufferInt:\r\n    ''' \r\n    Efficient cythonized implementation of circular buffer for numeric types.\r\n\r\n    Cache friendly implementation. Support for fixed size or automatic expansion and memory reallocation.\r\n    '''\r\n    cdef:\r\n        np.int[:] _buffer \r\n        long _last_position\r\n        long _first_position\r\n    cdef readonly:\r\n        long size\r\n        long pushed_count\r\n        bint autoexpand\r\n    \r\n    def __init__(self, size = 10, *, autoexpand = True):\r\n        if size >= 2**32:\r\n            raise ValueError(size)\r\n        self._buffer = np.zeros(size, dtype = np.int)\r\n        self._last_position = 0\r\n        self._first_position = 0\r\n        self.pushed_count = 0\r\n        self.size = size\r\n        self.autoexpand = autoexpand\r\n        \r\n    cpdef void push_back(self, np.int value):\r\n        if self.autoexpand and self.pushed_count == self.size:\r\n            self.expand(2 * self.size)\r\n\r\n        self._buffer[self._last_position] = value\r\n        self._last_position += 1\r\n        self._last_position %= self.size\r\n        if self._last_position == self._first_position:\r\n            self._first_position += 1\r\n        self._first_position %= self.size\r\n        self.pushed_count += 1\r\n        if self.pushed_count > self.size:\r\n            self.pushed_count = self.size\r\n    ...\r\n```\r\nI would like to use any numeric format instead of the `np.int` in `_buffer` and `push_back` `value`.",
            "created_at": "2019-12-23T14:47:17Z",
            "html_url": "https://github.com/cython/cython/issues/3283#issuecomment-568494487",
            "id": 568494487,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3283",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODQ5NDQ4Nw==",
            "updated_at": "2019-12-23T14:47:17Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568494487",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/1970226?v=4",
                "events_url": "https://api.github.com/users/leftys/events{/privacy}",
                "followers_url": "https://api.github.com/users/leftys/followers",
                "following_url": "https://api.github.com/users/leftys/following{/other_user}",
                "gists_url": "https://api.github.com/users/leftys/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/leftys",
                "id": 1970226,
                "login": "leftys",
                "node_id": "MDQ6VXNlcjE5NzAyMjY=",
                "organizations_url": "https://api.github.com/users/leftys/orgs",
                "received_events_url": "https://api.github.com/users/leftys/received_events",
                "repos_url": "https://api.github.com/users/leftys/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/leftys/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/leftys/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/leftys"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Extension types that use fused types in their attributes are not easy to support since they (may) lead to different object struct layouts for the same type. Or, they would require some form of internal subtype management, which is also not easy to support and almost certainly user visible.\r\n\r\nConsider asking on the cython-users mailing list how others have solved this use case.",
            "created_at": "2019-12-23T18:59:29Z",
            "html_url": "https://github.com/cython/cython/issues/3283#issuecomment-568553780",
            "id": 568553780,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3283",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODU1Mzc4MA==",
            "updated_at": "2019-12-23T18:59:29Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568553780",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "I though this is exactly the problem C++ templates are solving and it would be sufficient to just use them in the resulting C++ code. Imho templates are one of the strongest features of C++ as they allow writing very fast code while keeping generality and nice design without duplicating code. \r\n\r\nBtw, iirc templates are already supported in pxd files when importing templated C++ classes, but that's probably an entirely different problem.",
            "created_at": "2019-12-23T19:14:38Z",
            "html_url": "https://github.com/cython/cython/issues/3283#issuecomment-568557710",
            "id": 568557710,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3283",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODU1NzcxMA==",
            "updated_at": "2019-12-23T19:14:38Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568557710",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/1970226?v=4",
                "events_url": "https://api.github.com/users/leftys/events{/privacy}",
                "followers_url": "https://api.github.com/users/leftys/followers",
                "following_url": "https://api.github.com/users/leftys/following{/other_user}",
                "gists_url": "https://api.github.com/users/leftys/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/leftys",
                "id": 1970226,
                "login": "leftys",
                "node_id": "MDQ6VXNlcjE5NzAyMjY=",
                "organizations_url": "https://api.github.com/users/leftys/orgs",
                "received_events_url": "https://api.github.com/users/leftys/received_events",
                "repos_url": "https://api.github.com/users/leftys/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/leftys/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/leftys/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/leftys"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "You can use C++ templates (e.g. a simple vector), sure. But you can't use memory views (or buffers), because they require code generation support by Cython.\r\n\r\nI'll close this ticket as a duplicate of #2120, please ask on the mailing list if you need further help.",
            "created_at": "2019-12-23T19:32:27Z",
            "html_url": "https://github.com/cython/cython/issues/3283#issuecomment-568562238",
            "id": 568562238,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3283",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODU2MjIzOA==",
            "updated_at": "2019-12-23T19:34:05Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568562238",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3283/comments",
    "created_at": "2019-12-23T13:55:36Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-12-23T19:32:27Z",
            "event": "closed",
            "id": 2905498056,
            "node_id": "MDExOkNsb3NlZEV2ZW50MjkwNTQ5ODA1Ng==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2905498056"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-12-23T19:32:37Z",
            "event": "labeled",
            "id": 2905498249,
            "label": {
                "color": "444444",
                "name": "R: duplicate"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDI5MDU0OTgyNDk=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2905498249"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3283/events",
    "html_url": "https://github.com/cython/cython/issues/3283",
    "id": 541765705,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425556894,
            "name": "R: duplicate",
            "node_id": "MDU6TGFiZWw0MjU1NTY4OTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/R:%20duplicate"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3283/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU1NDE3NjU3MDU=",
    "number": 3283,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "Support for cdef class templating",
    "updated_at": "2019-12-23T19:34:05Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3283",
    "user": {
        "avatar_url": "https://avatars2.githubusercontent.com/u/1970226?v=4",
        "events_url": "https://api.github.com/users/leftys/events{/privacy}",
        "followers_url": "https://api.github.com/users/leftys/followers",
        "following_url": "https://api.github.com/users/leftys/following{/other_user}",
        "gists_url": "https://api.github.com/users/leftys/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/leftys",
        "id": 1970226,
        "login": "leftys",
        "node_id": "MDQ6VXNlcjE5NzAyMjY=",
        "organizations_url": "https://api.github.com/users/leftys/orgs",
        "received_events_url": "https://api.github.com/users/leftys/received_events",
        "repos_url": "https://api.github.com/users/leftys/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/leftys/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/leftys/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/leftys"
    }
}