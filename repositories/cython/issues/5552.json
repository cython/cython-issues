{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\n```\r\n$ cat example.pyx \r\ndef use_an_iterator(iterator):\r\n    return (x for x in iterator)\r\n$ cython3 --version\r\nCython version 3.0.0\r\n$ cython3 -3 example.pyx \r\n$ cython3 -3 --gdb example.pyx \r\n\r\nError compiling Cython file:\r\n------------------------------------------------------------\r\n...\r\ndef use_an_iterator(iterator):\r\n^\r\n------------------------------------------------------------\r\n\r\nexample.pyx:1:0: Compiler crash in DebugTransform\r\n\r\n\r\nCompiler crash traceback from this point on:\r\n  File \"Cython/Compiler/Visitor.py\", line 182, in Cython.Compiler.Visitor.TreeVisitor._visit\r\n  File \"/usr/lib/python3.11/site-packages/Cython/Compiler/ParseTreeTransforms.py\", line 4033, in visit_ModuleNode\r\n    self.visit_FuncDefNode(nested_funcdef)\r\n  File \"/usr/lib/python3.11/site-packages/Cython/Compiler/ParseTreeTransforms.py\", line 4093, in visit_FuncDefNode\r\n    self.tb.start(arg.name)\r\n  File \"/usr/lib/python3.11/site-packages/Cython/Debugger/DebugWriter.py\", line 42, in start\r\n    self.tb.start(name, attrs or {})\r\n  File \"src/lxml/saxparser.pxi\", line 841, in lxml.etree.TreeBuilder.start\r\n  File \"src/lxml/saxparser.pxi\", line 769, in lxml.etree.TreeBuilder._handleSaxStart\r\n  File \"src/lxml/apihelpers.pxi\", line 179, in lxml.etree._makeSubElement\r\n  File \"src/lxml/apihelpers.pxi\", line 1754, in lxml.etree._tagValidOrRaise\r\nValueError: Invalid tag name '.0'\r\n```\n\n### Code to reproduce the behaviour:\n\n```cython\r\ndef use_an_iterator(iterator):\r\n    return (x for x in iterator)\r\n```\r\n\n\n### Expected behaviour\n\n_No response_\n\n### OS\n\nlinux\n\n### Python version\n\n3.11.4\n\n### Cython version\n\n_No response_\n\n### Additional context\n\nThis happens *only* if python `lxml` package is installed.\r\n\r\nI reduced it to the simple function above, but this happens *a lot* in sagemath source code.",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "So the origin of this is: I've used function arguments with names like `.0` and `.1` as a way of passing arguments into generator expressions. This is by analogy with Python where\r\n\r\n```\r\n>>> [locals() for _ in range(1)]\r\n[{'.0': <range_iterator object at 0x7f9a4732c150>, '_': 0}]\r\n```\r\n(exact behaviour likely somewhat version dependent).\r\n\r\nIt looks like these don't play well with the debug output writer.\r\n\r\nIt's probably fairly simple to fix either by renaming the arguments or by excluding them from the debug output. I don't know much about the `--gdb` so I don't really know what the appropriate solution is. But one of those solutions should work.",
            "created_at": "2023-07-22T13:10:54Z",
            "html_url": "https://github.com/cython/cython/issues/5552#issuecomment-1646581371",
            "id": 1646581371,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5552",
            "node_id": "IC_kwDOABDGAc5iJNZ7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1646581371/reactions"
            },
            "updated_at": "2023-07-22T13:10:54Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1646581371",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5552/comments",
    "created_at": "2023-07-21T15:12:14Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5552/events",
    "html_url": "https://github.com/cython/cython/issues/5552",
    "id": 1815976468,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5552/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5sPZoU",
    "number": 5552,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5552/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5552/timeline",
    "title": "[BUG] invalid tag name with iterators in --gdb mode",
    "updated_at": "2023-07-22T13:10:54Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5552",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1581419?v=4",
        "events_url": "https://api.github.com/users/tornaria/events{/privacy}",
        "followers_url": "https://api.github.com/users/tornaria/followers",
        "following_url": "https://api.github.com/users/tornaria/following{/other_user}",
        "gists_url": "https://api.github.com/users/tornaria/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tornaria",
        "id": 1581419,
        "login": "tornaria",
        "node_id": "MDQ6VXNlcjE1ODE0MTk=",
        "organizations_url": "https://api.github.com/users/tornaria/orgs",
        "received_events_url": "https://api.github.com/users/tornaria/received_events",
        "repos_url": "https://api.github.com/users/tornaria/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tornaria/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tornaria/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tornaria"
    }
}