{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nHello there.\nI write my code using pure python, then use cython compile the code. I found out that, if your code right shift 32 bit, the result may be wrong. Here is a minimal reproduce code:\n\n### Code to reproduce the behaviour:\n\n### test_shift.py\n```python\nx = 0x6f\nprint('x >> 40 =', hex(x >> 40))\nprint('x >> 32 =', hex(x >> 32))\nprint('x >> 24 =', hex(x >> 24))\nprint('x >> 16 =', hex(x >> 16))\nprint('x >> 8 =', hex(x >> 8))\n```\ncompile it using cython:\n```batch\ncythonize.exe -i test_shift.py\n```\n### test.py\n```python\nimport test_shift\n```\nthen just run test.py\n\n### Expected behaviour\n\noutput is:\nx >> 40 = 0x0\nx >> 32 = 0x6f   <---- wrong result!\nx >> 24 = 0x0\nx >> 16 = 0x0\nx >> 8 = 0x0\n\n### OS\n\nWindows\n\n### Python version\n\n3.10.9 64bit\n\n### Cython version\n\n3.1.3\n\n### Additional context\n\nI use python 3.6 32bit first, I thought maybe it's 32bit python cause the problem. But I switch to python 3.10.9 64bit got same problem.\nAnd when I try to reproduce the bug, I also found out that if you just right shift 32bit only, the result is right. But if you right shift 32bit and other bits, the 32bit result will be wrong.\n\nI also want to know, is left shift may has this problem? Currently I don't find any problem, but I'm not sure.\n\nSorry for my poor English, and thanks for your help.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Yes - can reproduce this but it's Windows only.\n\nI get a warning on the line\n\n```\n        a = __Pyx_PyLong_CompactValue(op1);\n```\n\n> warning C4244: '=': conversion from 'Py_ssize_t' to 'long', possible loss of data\n\nwhich may be related\n\n",
            "created_at": "2025-08-15T07:15:09Z",
            "html_url": "https://github.com/cython/cython/issues/7089#issuecomment-3190820943",
            "id": 3190820943,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7089",
            "node_id": "IC_kwDOABDGAc6-MBBP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3190820943/reactions"
            },
            "updated_at": "2025-08-15T07:15:09Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3190820943",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "... and get the right answer if I disable that line",
            "created_at": "2025-08-15T07:17:52Z",
            "html_url": "https://github.com/cython/cython/issues/7089#issuecomment-3190824827",
            "id": 3190824827,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7089",
            "node_id": "IC_kwDOABDGAc6-MB97",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3190824827/reactions"
            },
            "updated_at": "2025-08-15T07:17:52Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3190824827",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks. But how can I disable this line when cythonize the code?\n\n> ... and get the right answer if I disable that line\n\n",
            "created_at": "2025-08-15T09:57:38Z",
            "html_url": "https://github.com/cython/cython/issues/7089#issuecomment-3191138842",
            "id": 3191138842,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7089",
            "node_id": "IC_kwDOABDGAc6-NOoa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3191138842/reactions"
            },
            "updated_at": "2025-08-15T09:57:38Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3191138842",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91939089?v=4",
                "events_url": "https://api.github.com/users/castieldc/events{/privacy}",
                "followers_url": "https://api.github.com/users/castieldc/followers",
                "following_url": "https://api.github.com/users/castieldc/following{/other_user}",
                "gists_url": "https://api.github.com/users/castieldc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/castieldc",
                "id": 91939089,
                "login": "castieldc",
                "node_id": "U_kgDOBXrhEQ",
                "organizations_url": "https://api.github.com/users/castieldc/orgs",
                "received_events_url": "https://api.github.com/users/castieldc/received_events",
                "repos_url": "https://api.github.com/users/castieldc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/castieldc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/castieldc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/castieldc",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Thanks. But how can I disable this line when cythonize the code?\n\nThe comment wasn't aimed at you. It was to help with investigating it later. You might be able to disable it though by defining the C macro `CYTHON_USE_PYLONG_INTERNALS` to 0.",
            "created_at": "2025-08-15T18:23:33Z",
            "html_url": "https://github.com/cython/cython/issues/7089#issuecomment-3192372620",
            "id": 3192372620,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7089",
            "node_id": "IC_kwDOABDGAc6-R72M",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3192372620/reactions"
            },
            "updated_at": "2025-08-15T18:23:33Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3192372620",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "To me this looks like an MSVC compiler bug.\n\nI've done a bit of printf debugging and it does:\n\n```\nif (likely(__Pyx_PyLong_IsCompact(op1))) {\n    a = __Pyx_PyLong_CompactValue(op1);\n}\n```\n\n`a` is correctly set to 111 here.\n\nThe next line that executes is\n\n```\nx = a >> b;\n```\n\nprintf says that `a` is 111, `b` is 32 and `x` is 111.  This just looks wrong and I don't see how any of the C code we've written can possibly produce that.\n\nIf `a` were negative then the result would be implementation defined in C. That's might be a real problem with the Cython code (although it looks like most C implementations do the same as Python here).",
            "created_at": "2025-08-15T18:37:14Z",
            "html_url": "https://github.com/cython/cython/issues/7089#issuecomment-3192403538",
            "id": 3192403538,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7089",
            "node_id": "IC_kwDOABDGAc6-SDZS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3192403538/reactions"
            },
            "updated_at": "2025-08-15T18:37:28Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3192403538",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Actually I'm wrong... this is undefined in C but defined in Python https://stackoverflow.com/a/19636580/",
            "created_at": "2025-08-15T18:48:54Z",
            "html_url": "https://github.com/cython/cython/issues/7089#issuecomment-3192430397",
            "id": 3192430397,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7089",
            "node_id": "IC_kwDOABDGAc6-SJ89",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3192430397/reactions"
            },
            "updated_at": "2025-08-15T18:48:54Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3192430397",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/7089/comments",
    "created_at": "2025-08-15T02:40:46Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            },
            "commit_id": "11c1247f2a442f2a31b37f5f6b50ef34d1e65f1f",
            "commit_url": "https://api.github.com/repos/da-woods/cython/commits/11c1247f2a442f2a31b37f5f6b50ef34d1e65f1f",
            "created_at": "2025-08-15T20:35:22Z",
            "event": "referenced",
            "id": 19181687785,
            "node_id": "REFE_lADOABDGAc7GInfZzwAAAAR3UVPp",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/19181687785"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            },
            "commit_id": "03394f58836dfe4510dddda9eb61a92b0e3b603a",
            "commit_url": "https://api.github.com/repos/da-woods/cython/commits/03394f58836dfe4510dddda9eb61a92b0e3b603a",
            "created_at": "2025-08-15T20:54:44Z",
            "event": "referenced",
            "id": 19181943769,
            "node_id": "REFE_lADOABDGAc7GInfZzwAAAAR3VTvZ",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/19181943769"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/7089/events",
    "html_url": "https://github.com/cython/cython/issues/7089",
    "id": 3324147673,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/7089/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc7GInfZ",
    "number": 7089,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/7089/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/7089/timeline",
    "title": "[BUG] Right shift operator gives wrong result",
    "type": null,
    "updated_at": "2025-08-15T18:48:54Z",
    "url": "https://api.github.com/repos/cython/cython/issues/7089",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/91939089?v=4",
        "events_url": "https://api.github.com/users/castieldc/events{/privacy}",
        "followers_url": "https://api.github.com/users/castieldc/followers",
        "following_url": "https://api.github.com/users/castieldc/following{/other_user}",
        "gists_url": "https://api.github.com/users/castieldc/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/castieldc",
        "id": 91939089,
        "login": "castieldc",
        "node_id": "U_kgDOBXrhEQ",
        "organizations_url": "https://api.github.com/users/castieldc/orgs",
        "received_events_url": "https://api.github.com/users/castieldc/received_events",
        "repos_url": "https://api.github.com/users/castieldc/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/castieldc/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/castieldc/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/castieldc",
        "user_view_type": "public"
    }
}