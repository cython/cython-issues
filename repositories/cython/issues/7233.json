{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Is your feature request related to a problem? Please describe.\n\nRunning \n`python setup.py build_ext --inplace --verbose`\non WIndows 10 ends with error message:\n```\nCompiling integrate1.pyx because it changed.\nCompiling integrate2.pyx because it changed.\nCompiling overflow_perf.pyx because it changed.\nCompiling primes.pyx because it changed.\nCompiling spam.pyx because it changed.\n[1/5] Cythonizing integrate1.pyx\n[2/5] Cythonizing integrate2.pyx\n[3/5] Cythonizing overflow_perf.pyx\n[4/5] Cythonizing primes.pyx\n[5/5] Cythonizing spam.pyx\nCompiling numpy_demo.pyx because it changed.\n[1/1] Cythonizing numpy_demo.pyx\nbm_cython.c\n   Creating library build\\temp.win-amd64-cpython-312\\Release\\benchmarks\\bm_cython.cp312-win_amd64.lib and object build\\temp.win-amd64-cpython-312\\Release\\benchmarks\\bm_cython.cp312-win_amd64.exp\nGenerating code\nFinished generating code\nlocks.c\n   Creating library build\\temp.win-amd64-cpython-312\\Release\\benchmarks\\locking\\locks.cp312-win_amd64.lib and object build\\temp.win-amd64-cpython-312\\Release\\benchmarks\\locking\\locks.cp312-win_amd64.exp\nGenerating code\nFinished generating code\ncheese.c\n   Creating library build\\temp.win-amd64-cpython-312\\Release\\callback\\cheese.cp312-win_amd64.lib and object build\\temp.win-amd64-cpython-312\\Release\\callback\\cheese.cp312-win_amd64.exp\ncheese.obj : error LNK2001: unresolved external symbol find_cheeses\nbuild\\lib.win-amd64-cpython-312\\cheese.cp312-win_amd64.pyd : fatal error LNK1120: 1 unresolved externals\nerror: command 'C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\VC\\\\Tools\\\\MSVC\\\\14.44.35207\\\\bin\\\\HostX86\\\\x64\\\\link.exe' failed with exit code 1120\n```\nCurrently I am in the mode of exploring with regards to precise root cause and exact steps to fix this issue, with the PR to follow.\nAt the moment I am assuming that the error is due to the following lines in this file:\n./Demos/callback/cheese.pyx\n```\ncdef extern from \"cheesefinder.h\":\n    ctypedef void (*cheesefunc)(char *name, void *user_data)\n    void find_cheeses(cheesefunc user_func, void *user_data)\n```\nrendering function find_cheeses to be marked as \"extern\".\nWhich prompts the final linker call to fail to find it in the list of exported functions.\nIt would seem reasonable to assume that the fix would involve strategically positioned Microsoft compiler specific and non - standard directive `__declspec(dllexport)`. However, once again, it's just a very raw grasp. I will expand as I learn better specific code change, that address same, and variants of thereof. Usually, by the end of investigation an ideal solution is seeing in grasp, that captures backwards compatibility, to keep existing code working as is, and add new behavior, that solves specific case, however, in some cases we do want things to change, rarely though, it does make sense.\nAdditional notes. As part of study covered the following, when library, .lib or .obj, file compiled on Windows platform, it ( to the extent I have covered ) exposes only one entry point, in this case\n`PyInit_cheese`\nor in general \n`PyInit_<module_name>`\nTaking step back, this error does not occur on Linux platform with attendant Linux platform compiler GCC. To compare between Windows and Linux platforms, how functions, with regards to \"export\" decorator treated on Linux by compiler and linker. Further below examples of the output of\n`nm --extern-only --demangle <library_path>`\nSo, on Linux there is a great deal of functions, that get exported and, I assume, can be linked externally against the .o library file. I am not 100% convinced this is the intent of the cython translator designers. It would seem, in an ideal world, that functions in modules should be accessible via standard python [c]import mechanism.\nAnd the situation when function is exposed to link externally should be exception, in which case it needs to be specially decorated ( hence my ideas above regarding possible rare exception of doing something different, than how things are done before/now ).\nGiven overall layout of the landscape I feel that this isn't really a bug, but a feature request, that, once again, going against the grain of what is normal best practices, holds two changes in behavior under one code change discovery / effort. One is to make it a bit more portable, so that same code works on both, Windows and Linux. And second, so that Linux better encapsulates its functions in the library .o file, exposing to linker `PyInit_<module_name>` only, unless export is enforced in some special unambiguous way.\n```\nnm --extern-only --demangle ./Demos/cheese.cpython-312-x86_64-linux-gnu.so\n0000000000208638 B __bss_start\n                 w __cxa_finalize@@GLIBC_2.2.5\n0000000000208638 D _edata\n0000000000208820 B _end\n                 U find_cheeses\n                 w __gmon_start__\n                 w _ITM_deregisterTMCloneTable\n                 w _ITM_registerTMCloneTable\n                 U memcmp@@GLIBC_2.2.5\n                 U PyArg_ValidateKeywordArguments\n                 U PyBaseObject_Type\n                 U PyBytes_AsString\n                 U PyBytes_FromStringAndSize\n                 U PyCFunction_Type\n                 U PyCode_NewEmpty\n                 U _Py_Dealloc\n                 U PyDict_GetItemString\n                 U PyDict_GetItemWithError\n                 U PyDict_New\n                 U PyDict_Next\n                 U PyDict_SetDefault\n                 U PyDict_SetItem\n                 U PyDict_SetItemString\n                 U PyDict_Size\n                 U PyDict_Type\n                 U Py_EnterRecursiveCall\n                 U PyErr_Clear\n                 U PyErr_ExceptionMatches\n                 U PyErr_Format\n                 U PyErr_NoMemory\n                 U PyErr_Occurred\n                 U PyErr_PrintEx\n                 U PyErr_SetString\n                 U PyErr_WarnEx\n                 U PyErr_WriteUnraisable\n                 U PyExc_AttributeError\n                 U PyException_SetTraceback\n                 U PyExc_ImportError\n                 U PyExc_RuntimeError\n                 U PyExc_RuntimeWarning\n                 U PyExc_SystemError\n                 U PyExc_TypeError\n                 U _Py_FalseStruct\n                 U PyFrame_New\n                 U PyImport_AddModule\n                 U PyImport_GetModuleDict\n                 U PyImport_ImportModule\n                 U PyImport_ImportModuleLevelObject\n0000000000003e37 T PyInit_cheese\n                 U PyInterpreterState_GetID\n                 U Py_LeaveRecursiveCall\n                 U PyList_New\n                 U PyMem_Free\n                 U PyMem_Malloc\n                 U PyMemoryView_FromMemory\n                 U PyMem_Realloc\n                 U PyMethod_New\n                 U PyMethod_Type\n                 U PyModuleDef_Init\n                 U PyModule_GetDict\n                 U PyModule_NewObject\n                 U _Py_NoneStruct\n                 U PyObject_CallFunctionObjArgs\n                 U _PyObject_ClearManagedDict\n                 U PyObject_ClearWeakRefs\n                 U PyObject_GC_Del\n                 U _PyObject_GC_New\n                 U PyObject_GC_Track\n                 U PyObject_GC_UnTrack\n                 U PyObject_GenericGetDict\n                 U PyObject_GenericSetDict\n                 U PyObject_GetAttr\n                 U PyObject_GetAttrString\n                 U PyObject_Hash\n                 U PyObject_RichCompareBool\n                 U PyObject_SetAttr\n                 U PyObject_SetAttrString\n                 U PyObject_VectorcallDict\n                 U _PyObject_VisitManagedDict\n                 U PyOS_snprintf\n                 U PyThreadState_Get\n                 U _PyThreadState_UncheckedGet\n                 U PyTraceBack_Here\n                 U _Py_TrueStruct\n                 U PyTuple_GetItem\n                 U PyTuple_GetSlice\n                 U PyTuple_New\n                 U PyTuple_Pack\n                 U PyType_FromMetaclass\n                 U PyType_Type\n                 U PyUnicode_DecodeUTF8\n                 U PyUnicode_FromFormat\n                 U PyUnicode_FromString\n                 U PyUnicode_FromStringAndSize\n                 U PyUnicode_InternFromString\n                 U PyUnicode_InternInPlace\n                 U PyUnicode_Type\n                 U PyUnstable_Code_NewWithPosOnlyArgs\n                 U Py_Version\n0000000000208660 B __pyx_module_is_main_cheese\n                 U __stack_chk_fail@@GLIBC_2.4\n                 U strlen@@GLIBC_2.2.5\n                 U strrchr@@GLIBC_2.2.5\n\nnm --extern-only --demangle bm_cython.cpython-312-x86_64-linux-gnu.so\n0000000000230a18 B __bss_start\n                 w __cxa_finalize@@GLIBC_2.2.5\n0000000000230a18 D _edata\n0000000000231540 B _end\n                 U free@@GLIBC_2.2.5\n                 w __gmon_start__\n                 w _ITM_deregisterTMCloneTable\n                 w _ITM_registerTMCloneTable\n                 U malloc@@GLIBC_2.2.5\n                 U memcmp@@GLIBC_2.2.5\n                 U memcpy@@GLIBC_2.14\n                 U PyArg_ValidateKeywordArguments\n                 U PyBaseObject_Type\n                 U PyBuffer_Release\n                 U PyByteArray_Type\n                 U PyBytes_AsString\n                 U PyBytes_FromString\n                 U PyBytes_FromStringAndSize\n                 U PyBytes_Type\n                 U PyCapsule_GetPointer\n                 U PyCapsule_New\n                 U PyCFunction_Type\n                 U PyCMethod_New\n                 U PyCode_NewEmpty\n                 U _Py_Dealloc\n                 U PyDict_DelItem\n                 U _PyDict_GetItem_KnownHash\n                 U PyDict_GetItemString\n                 U PyDict_GetItemWithError\n                 U PyDict_New\n                 U PyDict_Next\n                 U PyDict_SetDefault\n                 U PyDict_SetItem\n                 U _PyDict_SetItem_KnownHash\n                 U PyDict_SetItemString\n                 U PyDict_Size\n                 U PyDict_Type\n                 U PyDict_Update\n                 U Py_EnterRecursiveCall\n                 U PyErr_Clear\n                 U PyErr_ExceptionMatches\n                 U PyErr_Fetch\n                 U PyErr_Format\n                 U PyErr_GivenExceptionMatches\n                 U PyErr_NoMemory\n                 U PyErr_Occurred\n                 U PyErr_Restore\n                 U PyErr_SetObject\n                 U PyErr_SetString\n                 U PyErr_WarnEx\n                 U PyErr_WarnFormat\n                 U PyEval_GetBuiltins\n                 U PyExc_AssertionError\n                 U PyExc_AttributeError\n                 U PyExc_BufferError\n                 U PyExc_DeprecationWarning\n                 U PyException_GetTraceback\n                 U PyException_SetTraceback\n                 U PyExc_ImportError\n                 U PyExc_IndexError\n                 U PyExc_MemoryError\n                 U PyExc_NameError\n                 U PyExc_NotImplementedError\n                 U PyExc_OverflowError\n                 U PyExc_RuntimeError\n                 U PyExc_RuntimeWarning\n                 U PyExc_StopIteration\n                 U PyExc_SystemError\n                 U PyExc_TypeError\n                 U PyExc_UnboundLocalError\n                 U PyExc_ValueError\n                 U PyExc_ZeroDivisionError\n                 U _Py_FalseStruct\n                 U _Py_FatalErrorFunc\n                 U PyFloat_Type\n                 U PyFrame_New\n                 U PyGC_Disable\n                 U PyGC_Enable\n                 U PyGILState_Ensure\n                 U PyGILState_Release\n                 U PyImport_AddModule\n                 U PyImport_GetModule\n                 U PyImport_GetModuleDict\n                 U PyImport_ImportModule\n                 U PyImport_ImportModuleLevelObject\n                 U PyIndex_Check\n0000000000009c35 T PyInit_bm_cython\n                 U PyInterpreterState_GetID\n                 U PyIter_Next\n                 U Py_LeaveRecursiveCall\n                 U PyList_Append\n                 U PyList_AsTuple\n                 U PyList_New\n                 U PyList_Type\n                 U PyLong_AsLong\n                 U PyLong_AsSsize_t\n                 U PyLong_FromLong\n                 U PyLong_FromSsize_t\n                 U PyLong_Type\n                 U PyMem_Free\n                 U PyMem_Malloc\n                 U PyMemoryView_FromMemory\n                 U PyMem_Realloc\n                 U PyMethod_New\n                 U PyMethod_Type\n                 U PyModuleDef_Init\n                 U PyModule_GetDict\n                 U PyModule_NewObject\n                 U _Py_NoneStruct\n                 U PyNumber_Add\n                 U PyNumber_Index\n                 U PyNumber_InPlaceAdd\n                 U PyNumber_InPlaceMultiply\n                 U PyNumber_Multiply\n                 U PyNumber_Remainder\n                 U PyNumber_Subtract\n                 U PyObject_Call\n                 U PyObject_CallFinalizerFromDealloc\n                 U PyObject_CallFunctionObjArgs\n                 U PyObject_CallMethodObjArgs\n                 U PyObject_CallObject\n                 U _PyObject_ClearManagedDict\n                 U PyObject_ClearWeakRefs\n                 U PyObject_Format\n                 U PyObject_Free\n                 U PyObject_GC_Del\n                 U PyObject_GC_IsFinalized\n                 U _PyObject_GC_New\n                 U PyObject_GC_Track\n                 U PyObject_GC_UnTrack\n                 U PyObject_GenericGetAttr\n                 U _PyObject_GenericGetAttrWithDict\n                 U PyObject_GenericGetDict\n                 U PyObject_GenericSetDict\n                 U PyObject_GetAttr\n                 U PyObject_GetAttrString\n                 U PyObject_GetBuffer\n                 U PyObject_GetItem\n                 U PyObject_GetIter\n                 U PyObject_HasAttr\n                 U PyObject_Hash\n                 U PyObject_Init\n                 U PyObject_IsSubclass\n                 U PyObject_IsTrue\n                 U PyObject_Malloc\n                 U PyObject_Repr\n                 U PyObject_RichCompare\n                 U PyObject_RichCompareBool\n                 U PyObject_SetAttr\n                 U PyObject_SetAttrString\n                 U PyObject_SetItem\n                 U PyObject_VectorcallDict\n                 U PyObject_VectorcallMethod\n                 U _PyObject_VisitManagedDict\n                 U PyOS_snprintf\n                 U PySequence_Tuple\n                 U PySlice_New\n                 U PySlice_Type\n                 U PyThread_allocate_lock\n                 U PyThread_free_lock\n                 U PyThreadState_Get\n                 U _PyThreadState_UncheckedGet\n                 U PyTraceBack_Here\n                 U _Py_TrueStruct\n                 U PyTuple_GetItem\n                 U PyTuple_GetSlice\n                 U PyTuple_New\n                 U PyTuple_Pack\n                 U PyTuple_Type\n                 U PyType_FromMetaclass\n                 U _PyType_Lookup\n                 U PyType_Modified\n                 U PyType_Ready\n                 U PyType_Type\n                 U PyUnicode_Concat\n                 U PyUnicode_DecodeUTF8\n                 U _PyUnicode_FastCopyCharacters\n                 U PyUnicode_FindChar\n                 U PyUnicode_Format\n                 U PyUnicode_FromFormat\n                 U PyUnicode_FromOrdinal\n                 U PyUnicode_FromString\n                 U PyUnicode_FromStringAndSize\n                 U PyUnicode_InternFromString\n                 U PyUnicode_InternInPlace\n                 U PyUnicode_New\n                 U PyUnicode_Substring\n                 U PyUnicode_Type\n                 U PyUnstable_Code_NewWithPosOnlyArgs\n                 U Py_Version\n0000000000230a40 B __pyx_module_is_main_bm_cython\n                 U __stack_chk_fail@@GLIBC_2.4\n                 U strlen@@GLIBC_2.2.5\n                 U strrchr@@GLIBC_2.2.5\n                 U __vsnprintf_chk@@GLIBC_2.3.4\n```\nA few words regarding motivation for this request. Working on spaCy NLP library/framework transition to cython 3.2 found one particular case, related to its morphology feature, where it could potentially benefit from writing a few classes / structures in C/C++ and then exporting those baseline data structures, without intermediary V table or other redirect features, spotted in the translator output. More so, in a few corner cases to be able to express directly an C++ class, would be really - really nice.\nAnd so, after adding a block of C++ code and applying extern directive ran into same error message.\nOne could argue, there is a workaround, rewrite code in pyx file with appropriate decorations, and \"it will work\".\nBut it is so very nice to be able to keep rich expressive cython with regards to exception handling declaration, or performance advantages of raw C/C++ code embedding into cython, which can be further applied to performance. And to top it all, in this rare case we have time to make it happen.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/7233/comments",
    "created_at": "2025-10-18T23:51:34Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/7233/events",
    "html_url": "https://github.com/cython/cython/issues/7233",
    "id": 3529349346,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/7233/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc7SXZji",
    "number": 7233,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/7233/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/7233/timeline",
    "title": "[ENH] Compiling ./Demos on WIndows 10 fails to cheese.obj : error LNK2001: unresolved external symbol find_cheeses",
    "type": null,
    "updated_at": "2025-10-20T16:13:41Z",
    "url": "https://api.github.com/repos/cython/cython/issues/7233",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/18360184?v=4",
        "events_url": "https://api.github.com/users/MironAtHome/events{/privacy}",
        "followers_url": "https://api.github.com/users/MironAtHome/followers",
        "following_url": "https://api.github.com/users/MironAtHome/following{/other_user}",
        "gists_url": "https://api.github.com/users/MironAtHome/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/MironAtHome",
        "id": 18360184,
        "login": "MironAtHome",
        "node_id": "MDQ6VXNlcjE4MzYwMTg0",
        "organizations_url": "https://api.github.com/users/MironAtHome/orgs",
        "received_events_url": "https://api.github.com/users/MironAtHome/received_events",
        "repos_url": "https://api.github.com/users/MironAtHome/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/MironAtHome/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/MironAtHome/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/MironAtHome",
        "user_view_type": "public"
    }
}