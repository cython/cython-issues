{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Hello, \r\n\r\nI want to use coverage with Cython for a large project, but i have a problem when using Coverage and working-directory command line option with pxi files.\r\n\r\nIn my project, i want to create cython module in a build repository and after i made a copy into install directory so i use working directory\r\n\r\nThe coverage report fail on pxi files if use working directory in src directory.\r\n\r\nI reproduce the pb on a small case with this source_tree : \r\n```\r\n├── [2.0K]  src\r\n│   ├── [880]  hello.pyx\r\n│   ├── [0]  __init__.py\r\n│   ├── [102]  other.pxi\r\n│   └── [2.0K]  wrap\r\n│       ├── [0]  __init__.py\r\n│       ├── [48]  wrap_other.pxi\r\n│       └── [209]  wrap.pyx\r\n```\r\n[coverage_2.zip](https://github.com/cython/cython/files/4528319/coverage_2.zip)\r\n\r\nI write two script : \r\n\r\n1. `compile.sh` : this one works and i have the good coverage on pxi and pyx files\r\n2. `compile_fail.sh` : this ones return error on Coverage plugin and the report not contains the `other.pxi`\r\n\r\n\r\nBest regards,\r\nBruno\r\n\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for the report. It could just be that the path lookup doesn't work for your setup.\r\n\r\nThere are several tests in `tests/run/coverage*.srctree` (which use a simple single file directory format), and the implementation is in `Cython/Coverage.py`. Maybe you can investigate a bit what goes wrong in your case, building a new test file from your setup?",
            "created_at": "2020-04-27T10:36:39Z",
            "html_url": "https://github.com/cython/cython/issues/3547#issuecomment-619893546",
            "id": 619893546,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3547",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYxOTg5MzU0Ng==",
            "updated_at": "2020-04-27T10:37:31Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/619893546",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "This sounds similar to https://github.com/cython/cython/issues/3636 in a way",
            "created_at": "2020-05-28T20:40:20Z",
            "html_url": "https://github.com/cython/cython/issues/3547#issuecomment-635595465",
            "id": 635595465,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3547",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTU5NTQ2NQ==",
            "updated_at": "2020-05-28T20:40:20Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/635595465",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/578543?v=4",
                "events_url": "https://api.github.com/users/webknjaz/events{/privacy}",
                "followers_url": "https://api.github.com/users/webknjaz/followers",
                "following_url": "https://api.github.com/users/webknjaz/following{/other_user}",
                "gists_url": "https://api.github.com/users/webknjaz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/webknjaz",
                "id": 578543,
                "login": "webknjaz",
                "node_id": "MDQ6VXNlcjU3ODU0Mw==",
                "organizations_url": "https://api.github.com/users/webknjaz/orgs",
                "received_events_url": "https://api.github.com/users/webknjaz/received_events",
                "repos_url": "https://api.github.com/users/webknjaz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/webknjaz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/webknjaz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/webknjaz"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3547/comments",
    "created_at": "2020-04-24T10:36:09Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-27T10:34:11Z",
            "event": "labeled",
            "id": 3275110617,
            "label": {
                "color": "444444",
                "name": "defect"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDMyNzUxMTA2MTc=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/3275110617"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-27T10:34:11Z",
            "event": "labeled",
            "id": 3275110619,
            "label": {
                "color": "444444",
                "name": "Tools"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDMyNzUxMTA2MTk=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/3275110619"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3547/events",
    "html_url": "https://github.com/cython/cython/issues/3547",
    "id": 606215580,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425563280,
            "name": "Tools",
            "node_id": "MDU6TGFiZWw0MjU1NjMyODA=",
            "url": "https://api.github.com/repos/cython/cython/labels/Tools"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425553654,
            "name": "defect",
            "node_id": "MDU6TGFiZWw0MjU1NTM2NTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/defect"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3547/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU2MDYyMTU1ODA=",
    "number": 3547,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Coverage with working directory and include file (pxi) in pyx files",
    "updated_at": "2020-05-28T20:40:21Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3547",
    "user": {
        "avatar_url": "https://avatars3.githubusercontent.com/u/2572528?v=4",
        "events_url": "https://api.github.com/users/maugarsb/events{/privacy}",
        "followers_url": "https://api.github.com/users/maugarsb/followers",
        "following_url": "https://api.github.com/users/maugarsb/following{/other_user}",
        "gists_url": "https://api.github.com/users/maugarsb/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/maugarsb",
        "id": 2572528,
        "login": "maugarsb",
        "node_id": "MDQ6VXNlcjI1NzI1Mjg=",
        "organizations_url": "https://api.github.com/users/maugarsb/orgs",
        "received_events_url": "https://api.github.com/users/maugarsb/received_events",
        "repos_url": "https://api.github.com/users/maugarsb/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/maugarsb/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/maugarsb/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/maugarsb"
    }
}