{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "This causes test failures for NumPy and isn't fixed in 3.0.a5. It can be worked around if needed but it would be nice if it was fixed before Python 3.9 came out.",
    "closed_at": "2020-07-04T17:33:20Z",
    "comment_data": [
        {
            "author_association": "COLLABORATOR",
            "body": "I think this has been fixed since the release of 3.0.a5. It might be worth trying the current master (or waiting for a6).\r\n\r\nAll the usages I can find in the source look to be conditionally compiled (so shouldn't be used on 3.9). \r\n\r\n--------------\r\n\r\nActually - not completely convinced that's true - it does look to be used in StringTools.c https://github.com/cython/cython/blob/9c26b302791515f608d4b200f692dcec9f066229/Cython/Utility/StringTools.c#L145 __Pyx_UnicodeContainsUCS4",
            "created_at": "2020-07-04T16:41:30Z",
            "html_url": "https://github.com/cython/cython/issues/3724#issuecomment-653787251",
            "id": 653787251,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3724",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mzc4NzI1MQ==",
            "updated_at": "2020-07-04T16:47:30Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/653787251",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "NONE",
            "body": "I installed Cython from master this morning, hence the report :)",
            "created_at": "2020-07-04T17:09:21Z",
            "html_url": "https://github.com/cython/cython/issues/3724#issuecomment-653789877",
            "id": 653789877,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3724",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mzc4OTg3Nw==",
            "updated_at": "2020-07-04T17:09:21Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/653789877",
            "user": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
                "events_url": "https://api.github.com/users/charris/events{/privacy}",
                "followers_url": "https://api.github.com/users/charris/followers",
                "following_url": "https://api.github.com/users/charris/following{/other_user}",
                "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/charris",
                "id": 77272,
                "login": "charris",
                "node_id": "MDQ6VXNlcjc3Mjcy",
                "organizations_url": "https://api.github.com/users/charris/orgs",
                "received_events_url": "https://api.github.com/users/charris/received_events",
                "repos_url": "https://api.github.com/users/charris/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/charris"
            }
        },
        {
            "author_association": "NONE",
            "body": "The actual problem is `PyUnicode_DATA`\r\n```\r\n#elif PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)\r\n  #define CYTHON_PEP393_ENABLED 1\r\n  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\\\r\n                                              0 : _PyUnicode_Ready((PyObject *)(op)))\r\n  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)\r\n  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)\r\n  #define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)   PyUnicode_MAX_CHAR_VALUE(u)\r\n  #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)\r\n  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)\r\n```\r\n",
            "created_at": "2020-07-04T17:17:21Z",
            "html_url": "https://github.com/cython/cython/issues/3724#issuecomment-653790747",
            "id": 653790747,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3724",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mzc5MDc0Nw==",
            "updated_at": "2020-07-04T17:17:21Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/653790747",
            "user": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
                "events_url": "https://api.github.com/users/charris/events{/privacy}",
                "followers_url": "https://api.github.com/users/charris/followers",
                "following_url": "https://api.github.com/users/charris/following{/other_user}",
                "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/charris",
                "id": 77272,
                "login": "charris",
                "node_id": "MDQ6VXNlcjc3Mjcy",
                "organizations_url": "https://api.github.com/users/charris/orgs",
                "received_events_url": "https://api.github.com/users/charris/received_events",
                "repos_url": "https://api.github.com/users/charris/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/charris"
            }
        },
        {
            "author_association": "NONE",
            "body": "I think you need to use `PyUnicode_KIND` and call the correct version of `PyUnicode_nBYTE_DATA`, where `n` is 1, 2, or 4. \r\n\r\nEDIT: and call `PyUnicode_READY()` first.",
            "created_at": "2020-07-04T17:22:03Z",
            "html_url": "https://github.com/cython/cython/issues/3724#issuecomment-653791191",
            "id": 653791191,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3724",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mzc5MTE5MQ==",
            "updated_at": "2020-07-04T17:23:39Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/653791191",
            "user": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
                "events_url": "https://api.github.com/users/charris/events{/privacy}",
                "followers_url": "https://api.github.com/users/charris/followers",
                "following_url": "https://api.github.com/users/charris/following{/other_user}",
                "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/charris",
                "id": 77272,
                "login": "charris",
                "node_id": "MDQ6VXNlcjc3Mjcy",
                "organizations_url": "https://api.github.com/users/charris/orgs",
                "received_events_url": "https://api.github.com/users/charris/received_events",
                "repos_url": "https://api.github.com/users/charris/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/charris"
            }
        },
        {
            "author_association": "NONE",
            "body": "Oops, looks like the remaining errors actually come from NumPy C code. `PyUnicode_DATA` is used in the define, but is no longer used in the generated code.",
            "created_at": "2020-07-04T17:31:33Z",
            "html_url": "https://github.com/cython/cython/issues/3724#issuecomment-653792111",
            "id": 653792111,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3724",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mzc5MjExMQ==",
            "updated_at": "2020-07-04T17:33:08Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/653792111",
            "user": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
                "events_url": "https://api.github.com/users/charris/events{/privacy}",
                "followers_url": "https://api.github.com/users/charris/followers",
                "following_url": "https://api.github.com/users/charris/following{/other_user}",
                "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/charris",
                "id": 77272,
                "login": "charris",
                "node_id": "MDQ6VXNlcjc3Mjcy",
                "organizations_url": "https://api.github.com/users/charris/orgs",
                "received_events_url": "https://api.github.com/users/charris/received_events",
                "repos_url": "https://api.github.com/users/charris/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/charris"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yeah, all these deprecations are really annoying and difficult to work around. It's easy to write code that works with and without `Py_UNICODE`, but it's difficult to write correct code while `Py_UNICODE` is still available and used in CPython without running into deprecation warning that make user code fail.\r\n\r\nI've just disabled the usage for Py3.9+ in 336363893b6cc02f6c1d0f26102ea2501784f7d7 and now require PEP-393 to be available. Users shouldn't have an interest in disabling the support in Cython.",
            "created_at": "2020-07-05T19:11:24Z",
            "html_url": "https://github.com/cython/cython/issues/3724#issuecomment-653927159",
            "id": 653927159,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3724",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzkyNzE1OQ==",
            "updated_at": "2020-07-05T19:11:24Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/653927159",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3724/comments",
    "created_at": "2020-07-04T16:01:22Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
                "events_url": "https://api.github.com/users/charris/events{/privacy}",
                "followers_url": "https://api.github.com/users/charris/followers",
                "following_url": "https://api.github.com/users/charris/following{/other_user}",
                "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/charris",
                "id": 77272,
                "login": "charris",
                "node_id": "MDQ6VXNlcjc3Mjcy",
                "organizations_url": "https://api.github.com/users/charris/orgs",
                "received_events_url": "https://api.github.com/users/charris/received_events",
                "repos_url": "https://api.github.com/users/charris/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/charris"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-07-04T17:33:20Z",
            "event": "closed",
            "id": 3512722594,
            "node_id": "MDExOkNsb3NlZEV2ZW50MzUxMjcyMjU5NA==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/3512722594"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3724/events",
    "html_url": "https://github.com/cython/cython/issues/3724",
    "id": 650914805,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3724/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU2NTA5MTQ4MDU=",
    "number": 3724,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "PyUnicode_AS_UNICODE is deprecated in Python 3.9",
    "updated_at": "2020-07-05T19:11:24Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3724",
    "user": {
        "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
        "events_url": "https://api.github.com/users/charris/events{/privacy}",
        "followers_url": "https://api.github.com/users/charris/followers",
        "following_url": "https://api.github.com/users/charris/following{/other_user}",
        "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/charris",
        "id": 77272,
        "login": "charris",
        "node_id": "MDQ6VXNlcjc3Mjcy",
        "organizations_url": "https://api.github.com/users/charris/orgs",
        "received_events_url": "https://api.github.com/users/charris/received_events",
        "repos_url": "https://api.github.com/users/charris/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/charris"
    }
}