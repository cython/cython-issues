{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "The Cython code `obj[i]` where `i` is a `cdef int` is translated to a call to `__Pyx_GetItemInt_Fast`.\r\n\r\nThis will use the *sequence protocol* to get `obj[i]`. More precisely, `Py_TYPE(obj)->tp_as_sequence->sq_item(obj, i)` will be called.\r\n\r\nHowever, Python always tries the *mapping protocol* first. Because of this, it can happen that `obj[i]` in Cython behaves differently from Python. There is nothing in the Python docs that says that the mapping and sequence protocols should agree, so this is a bug.\r\n\r\nSimple repro:\r\n```\r\ndef get(obj, int i):\r\n    return obj[i]\r\n\r\nclass D(dict):\r\n    pass \r\n```\r\n\r\nThis gives:\r\n```\r\n>>> d = D([(-1, \"hello\")]); d\r\n{-1: 'hello'}\r\n>>> d[-1]\r\n'hello' \r\n>>> get(d, -1)\r\nKeyError: 0\r\n```",
    "closed_at": "2019-01-11T13:42:10Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "I'm sure this was done because the sequence protocol accepts C integer indices (which makes it more efficient if the index is passed as a C integer), but I agree that this is a bug.",
            "created_at": "2017-08-07T12:24:23Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-320649385",
            "id": 320649385,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDY0OTM4NQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/320649385/reactions"
            },
            "updated_at": "2017-08-07T12:24:23Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/320649385",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "IIRC many types won't have `tp_as_mapping` anyways so it can still be skipped over easily in that case.  But otherwise it should be checked first.",
            "created_at": "2017-08-07T17:47:03Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-320732228",
            "id": 320732228,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDczMjIyOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/320732228/reactions"
            },
            "updated_at": "2017-08-07T17:47:03Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/320732228",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/676149?v=4",
                "events_url": "https://api.github.com/users/embray/events{/privacy}",
                "followers_url": "https://api.github.com/users/embray/followers",
                "following_url": "https://api.github.com/users/embray/following{/other_user}",
                "gists_url": "https://api.github.com/users/embray/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/embray",
                "id": 676149,
                "login": "embray",
                "node_id": "MDQ6VXNlcjY3NjE0OQ==",
                "organizations_url": "https://api.github.com/users/embray/orgs",
                "received_events_url": "https://api.github.com/users/embray/received_events",
                "repos_url": "https://api.github.com/users/embray/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/embray/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/embray/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/embray"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "The main difference will be for Python (non-extension) types, since `__getitem__` is put both in the mapping protocol as well as the sequence protocol. That is also why `class D(dict): pass` behaves differently from a plain `dict`.",
            "created_at": "2017-08-08T07:54:01Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-320880169",
            "id": 320880169,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDg4MDE2OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/320880169/reactions"
            },
            "updated_at": "2017-08-08T07:54:01Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/320880169",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3625785?v=4",
                "events_url": "https://api.github.com/users/jdemeyer/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdemeyer/followers",
                "following_url": "https://api.github.com/users/jdemeyer/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdemeyer/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdemeyer",
                "id": 3625785,
                "login": "jdemeyer",
                "node_id": "MDQ6VXNlcjM2MjU3ODU=",
                "organizations_url": "https://api.github.com/users/jdemeyer/orgs",
                "received_events_url": "https://api.github.com/users/jdemeyer/received_events",
                "repos_url": "https://api.github.com/users/jdemeyer/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdemeyer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdemeyer/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdemeyer"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Well, yes, for classes with `__getitem__`  that's definitely true.",
            "created_at": "2017-08-08T09:42:17Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-320906181",
            "id": 320906181,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDkwNjE4MQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/320906181/reactions"
            },
            "updated_at": "2017-08-08T09:42:17Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/320906181",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/676149?v=4",
                "events_url": "https://api.github.com/users/embray/events{/privacy}",
                "followers_url": "https://api.github.com/users/embray/followers",
                "following_url": "https://api.github.com/users/embray/following{/other_user}",
                "gists_url": "https://api.github.com/users/embray/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/embray",
                "id": 676149,
                "login": "embray",
                "node_id": "MDQ6VXNlcjY3NjE0OQ==",
                "organizations_url": "https://api.github.com/users/embray/orgs",
                "received_events_url": "https://api.github.com/users/embray/received_events",
                "repos_url": "https://api.github.com/users/embray/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/embray/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/embray/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/embray"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "But types that use the mapping protocol will require Python conversion of the 'index' value anyway, whether it's called through the sequence or mapping protocol.\r\n\r\nThere's a tiny performance impact for types that only use the sequence protocol, because Cython would now have to check the mapping protocol first. As long as the work done inside of the getitem method is non-trivial, it won't make a difference, but getitem might actually be really trivial in many important sequence cases.\r\n\r\nI think the only thing we can do is: implement, then measure. Open for pull requests.",
            "created_at": "2017-08-08T10:03:10Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-320911274",
            "id": 320911274,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDkxMTI3NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/320911274/reactions"
            },
            "updated_at": "2017-08-08T10:03:10Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/320911274",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This seems to have a major impact on speed for indexing NumPy arrays in cython, see https://github.com/pandas-dev/pandas/pull/55179#issuecomment-1775566417\r\n\r\nI suppose, NumPy could have an integer fast path earlier on, not quite sure how much that will help.  Is that needed?",
            "created_at": "2023-11-08T20:25:51Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1802599201",
            "id": 1802599201,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5rcXsh",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1802599201/reactions"
            },
            "updated_at": "2023-11-08T20:25:51Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1802599201",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61977?v=4",
                "events_url": "https://api.github.com/users/seberg/events{/privacy}",
                "followers_url": "https://api.github.com/users/seberg/followers",
                "following_url": "https://api.github.com/users/seberg/following{/other_user}",
                "gists_url": "https://api.github.com/users/seberg/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seberg",
                "id": 61977,
                "login": "seberg",
                "node_id": "MDQ6VXNlcjYxOTc3",
                "organizations_url": "https://api.github.com/users/seberg/orgs",
                "received_events_url": "https://api.github.com/users/seberg/received_events",
                "repos_url": "https://api.github.com/users/seberg/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seberg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seberg/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seberg"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "One option would be `from cpython.sequence cimport PySequence_GetItem` then to use `PySequence_GetItem(arr, i)` instead of `arr[i]` where you're certain that the types justify it.\r\n\r\nWe could definitely look at other options though - I guess in principle a compiler directive might be a possibility. Would be good to see the use-case to think about if there's anything cleverer we should be doing.",
            "created_at": "2023-11-08T20:51:34Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1802656280",
            "id": 1802656280,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5rcloY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1802656280/reactions"
            },
            "updated_at": "2023-11-08T20:51:34Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1802656280",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">I suppose, NumPy could have an integer fast path earlier on, not quite sure how much that will help.  Is that needed?\n\nThe main performance difference is that we have to create a temporary Python int object when going through the mapping protocol, whereas the sequence protocol accepts the C integer index directly. That is definitely measurable.\n\nThe problem is that NumPy must implement the mapping protocol for its extended slicing and all, so the sequence protocol is not actually used by conforming Python (and thus Cython) code, because Python prioritises the mapping protocol.\n",
            "created_at": "2023-11-08T20:58:48Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1802664686",
            "id": 1802664686,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5rcnru",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1802664686/reactions"
            },
            "updated_at": "2023-11-08T20:58:48Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1802664686",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think @seberg meant to link to https://github.com/pandas-dev/pandas/pull/55179#issuecomment-1802484187 above\r\n\r\n> One option would be `from cpython.sequence cimport PySequence_GetItem` then to use `PySequence_GetItem(arr, i)` instead of `arr[i]` where you're certain that the types justify it.\r\n\r\nThanks for the workaround.  FWIW from a pandas perspective where we often turn off boundschecking I have pretty much always expected `arr[i]` to work just like a pointer offset. The idea of treating that like a mapping has never really crossed my mind",
            "created_at": "2023-11-08T22:00:03Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1802746151",
            "id": 1802746151,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5rc7kn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1802746151/reactions"
            },
            "updated_at": "2023-11-08T22:00:03Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1802746151",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/609873?v=4",
                "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
                "followers_url": "https://api.github.com/users/WillAyd/followers",
                "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
                "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/WillAyd",
                "id": 609873,
                "login": "WillAyd",
                "node_id": "MDQ6VXNlcjYwOTg3Mw==",
                "organizations_url": "https://api.github.com/users/WillAyd/orgs",
                "received_events_url": "https://api.github.com/users/WillAyd/received_events",
                "repos_url": "https://api.github.com/users/WillAyd/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/WillAyd"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> boundschecking I have pretty much always expected `arr[i]` to work just like a pointer offset.\r\n\r\nboundschecking only really applies when Cython knows the type well enough to have special address to the internals. That's mainly for memoryviews and a few other known Python types like list, tuple, bytes (but only if Cython knows the variable type). That's a non-exhaustive list but hopefully gives the idea.\r\n\r\nIf Cython doesn't know the variable type then it just goes through normal Python `__getitem__` lookup. In this case boundschecking doesn't do anything because `__getitem__` generates the exception.",
            "created_at": "2023-11-08T22:18:39Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1802769857",
            "id": 1802769857,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5rdBXB",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1802769857/reactions"
            },
            "updated_at": "2023-11-08T22:18:39Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1802769857",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "In the pandas case, we have typed as `ndarray`, so a custom method just for cython would also work.  It isn't yet quite clear to me if this regression is big enough to worry much (at least in most places).\r\nAlso since indexing has a lot of additional overheads that are harder to avoid if you don't go down to the buffer level. (something Brock was wondering about whether we could add more API, but it seemed a bit like we need to target it to the use-case and see what we actually need.)",
            "created_at": "2023-11-09T06:46:33Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1803251703",
            "id": 1803251703,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5re2_3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1803251703/reactions"
            },
            "updated_at": "2023-11-09T06:46:33Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1803251703",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61977?v=4",
                "events_url": "https://api.github.com/users/seberg/events{/privacy}",
                "followers_url": "https://api.github.com/users/seberg/followers",
                "following_url": "https://api.github.com/users/seberg/following{/other_user}",
                "gists_url": "https://api.github.com/users/seberg/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seberg",
                "id": 61977,
                "login": "seberg",
                "node_id": "MDQ6VXNlcjYxOTc3",
                "organizations_url": "https://api.github.com/users/seberg/orgs",
                "received_events_url": "https://api.github.com/users/seberg/received_events",
                "repos_url": "https://api.github.com/users/seberg/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seberg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seberg/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seberg"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Here is a pretty trivial MRE:\r\n\r\n```python\r\nfrom numpy cimport ndarray\r\n\r\n\r\ndef check_timing(ndarray arr):\r\n    cdef:\r\n        Py_ssize_t n = len(arr), i\r\n        object val\r\n\r\n    for i in range(n):\r\n        val = arr[i]\r\n```\r\n\r\nCompiling with with -O2 optimization with 0.29.34 yields the following timing:\r\n\r\n```python\r\nIn [1]: import numpy as np\r\nIn [2]: from cython_perf import check_timing\r\nIn [3]: arr = np.arange(1000)\r\nIn [4]: %timeit check_timing(arr)\r\n18.6 µs ± 512 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)\r\n```\r\n\r\nVersus 3.0.5\r\n\r\n```python\r\nIn [1]: import numpy as np\r\nIn [2]: from cython_perf import check_timing\r\nIn [3]: arr = np.arange(1000)\r\nIn [4]: %timeit check_timing(arr)\r\n35.9 µs ± 1.59 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)\r\n```\r\n",
            "created_at": "2023-11-09T22:49:25Z",
            "html_url": "https://github.com/cython/cython/issues/1807#issuecomment-1804803986",
            "id": 1804803986,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1807",
            "node_id": "IC_kwDOABDGAc5rkx-S",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1804803986/reactions"
            },
            "updated_at": "2023-11-09T22:49:25Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1804803986",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/609873?v=4",
                "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
                "followers_url": "https://api.github.com/users/WillAyd/followers",
                "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
                "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/WillAyd",
                "id": 609873,
                "login": "WillAyd",
                "node_id": "MDQ6VXNlcjYwOTg3Mw==",
                "organizations_url": "https://api.github.com/users/WillAyd/orgs",
                "received_events_url": "https://api.github.com/users/WillAyd/received_events",
                "repos_url": "https://api.github.com/users/WillAyd/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/WillAyd"
            }
        }
    ],
    "comments": 12,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1807/comments",
    "created_at": "2017-08-07T12:19:22Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-08-07T12:24:45Z",
            "event": "labeled",
            "id": 1195305189,
            "label": {
                "color": "444444",
                "name": "Code Generation"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDExOTUzMDUxODk=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/1195305189"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-08-07T12:24:45Z",
            "event": "labeled",
            "id": 1195305192,
            "label": {
                "color": "444444",
                "name": "Python Semantics"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDExOTUzMDUxOTI=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/1195305192"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": "a1cd13a22c3c1fc5ac93829f05e2104c89143277",
            "commit_url": "https://api.github.com/repos/cython/cython/commits/a1cd13a22c3c1fc5ac93829f05e2104c89143277",
            "created_at": "2019-01-07T20:08:59Z",
            "event": "referenced",
            "id": 2058528146,
            "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDIwNTg1MjgxNDY=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/2058528146"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-01-07T20:17:18Z",
            "event": "milestoned",
            "id": 2058544922,
            "milestone": {
                "title": "3.0"
            },
            "node_id": "MDE1Ok1pbGVzdG9uZWRFdmVudDIwNTg1NDQ5MjI=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/2058544922"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-01-11T13:42:10Z",
            "event": "closed",
            "id": 2068569227,
            "node_id": "MDExOkNsb3NlZEV2ZW50MjA2ODU2OTIyNw==",
            "performed_via_github_app": null,
            "state_reason": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/2068569227"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61977?v=4",
                "events_url": "https://api.github.com/users/seberg/events{/privacy}",
                "followers_url": "https://api.github.com/users/seberg/followers",
                "following_url": "https://api.github.com/users/seberg/following{/other_user}",
                "gists_url": "https://api.github.com/users/seberg/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seberg",
                "id": 61977,
                "login": "seberg",
                "node_id": "MDQ6VXNlcjYxOTc3",
                "organizations_url": "https://api.github.com/users/seberg/orgs",
                "received_events_url": "https://api.github.com/users/seberg/received_events",
                "repos_url": "https://api.github.com/users/seberg/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seberg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seberg/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seberg"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-11-08T22:00:04Z",
            "event": "mentioned",
            "id": 10906256036,
            "node_id": "MEE_lADOABDGAc4OzjAzzwAAAAKKEEKk",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/10906256036"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61977?v=4",
                "events_url": "https://api.github.com/users/seberg/events{/privacy}",
                "followers_url": "https://api.github.com/users/seberg/followers",
                "following_url": "https://api.github.com/users/seberg/following{/other_user}",
                "gists_url": "https://api.github.com/users/seberg/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seberg",
                "id": 61977,
                "login": "seberg",
                "node_id": "MDQ6VXNlcjYxOTc3",
                "organizations_url": "https://api.github.com/users/seberg/orgs",
                "received_events_url": "https://api.github.com/users/seberg/received_events",
                "repos_url": "https://api.github.com/users/seberg/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seberg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seberg/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seberg"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-11-08T22:00:04Z",
            "event": "subscribed",
            "id": 10906256042,
            "node_id": "SE_lADOABDGAc4OzjAzzwAAAAKKEEKq",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/10906256042"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1807/events",
    "html_url": "https://github.com/cython/cython/issues/1807",
    "id": 248393779,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425556315,
            "name": "Python Semantics",
            "node_id": "MDU6TGFiZWw0MjU1NTYzMTU=",
            "url": "https://api.github.com/repos/cython/cython/labels/Python%20Semantics"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425556330,
            "name": "Code Generation",
            "node_id": "MDU6TGFiZWw0MjU1NTYzMzA=",
            "url": "https://api.github.com/repos/cython/cython/labels/Code%20Generation"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1807/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 947,
        "created_at": "2018-08-18T06:33:08Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
            "events_url": "https://api.github.com/users/scoder/events{/privacy}",
            "followers_url": "https://api.github.com/users/scoder/followers",
            "following_url": "https://api.github.com/users/scoder/following{/other_user}",
            "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/scoder",
            "id": 491659,
            "login": "scoder",
            "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
            "organizations_url": "https://api.github.com/users/scoder/orgs",
            "received_events_url": "https://api.github.com/users/scoder/received_events",
            "repos_url": "https://api.github.com/users/scoder/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/scoder"
        },
        "description": "Goals:\r\n– New version scheme: 3.x instead of 0.x.\r\n– Change default `language_level` from `2` to `3str`.\r\n– Change default for `binding` directive from `False` to `True`.\r\n– Fix some Python compatibility issues (if possible, allowing for breaking changes).\r\n",
        "due_on": null,
        "html_url": "https://github.com/cython/cython/milestone/58",
        "id": 3580387,
        "labels_url": "https://api.github.com/repos/cython/cython/milestones/58/labels",
        "node_id": "MDk6TWlsZXN0b25lMzU4MDM4Nw==",
        "number": 58,
        "open_issues": 1,
        "state": "open",
        "title": "3.0",
        "updated_at": "2023-07-25T06:58:14Z",
        "url": "https://api.github.com/repos/cython/cython/milestones/58"
    },
    "node_id": "MDU6SXNzdWUyNDgzOTM3Nzk=",
    "number": 1807,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/1807/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/1807/timeline",
    "title": "__Pyx_GetItemInt_Fast should prefer mapping over sequence protocol",
    "updated_at": "2023-11-09T22:49:26Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1807",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3625785?v=4",
        "events_url": "https://api.github.com/users/jdemeyer/events{/privacy}",
        "followers_url": "https://api.github.com/users/jdemeyer/followers",
        "following_url": "https://api.github.com/users/jdemeyer/following{/other_user}",
        "gists_url": "https://api.github.com/users/jdemeyer/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/jdemeyer",
        "id": 3625785,
        "login": "jdemeyer",
        "node_id": "MDQ6VXNlcjM2MjU3ODU=",
        "organizations_url": "https://api.github.com/users/jdemeyer/orgs",
        "received_events_url": "https://api.github.com/users/jdemeyer/received_events",
        "repos_url": "https://api.github.com/users/jdemeyer/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/jdemeyer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jdemeyer/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/jdemeyer"
    }
}