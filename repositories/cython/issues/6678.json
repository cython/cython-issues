{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nI am trying to boost my existing lib `ididi` by converting some moduels into cython, and i do so by creating pxd files and compile,  when i randomly convert a class with a attribute named `default`, error happens.\n\n\n\n\n### Expected behaviour\n\nto not raise \"error: expected identifier before ‘default’\" when compile\n\n### OS\n\nUbuntu 20.04.6 LTS\n\n### Python version\n\nPython 3.9.0\n\n### Cython version\n\n3.0.12\n\n### Additional context\n\nConsole log\n```bash\n/_node.c:1525:13: error: expected identifier or ‘(’ before ‘default’\n 1525 |   PyObject *default;\n      |             ^~~~~~~\nIn file included from .pixi/envs/default/include/python3.9/pytime.h:6,\n                 from .pixi/envs/default/include/python3.9/Python.h:85,\n                 from /_node.c:28:\n/_node.c: In function ‘__pyx_pf_5ididi_5_node_10Dependency___init__’:\n/_node.c:5914:30: error: expected identifier before ‘default’\n 5914 |   __Pyx_DECREF(__pyx_v_self->default);\n      |                              ^~~~~~~\n.pixi/envs/default/include/python3.9/object.h:112:41: note: in definition of macro ‘_PyObject_CAST’\n  112 | #define _PyObject_CAST(op) ((PyObject*)(op))\n      |                                         ^~\n/_node.c:1625:27: note: in expansion of macro ‘Py_DECREF’\n 1625 |   #define __Pyx_DECREF(r) Py_DECREF(r)\n      |                           ^~~~~~~~~\n/_node.c:5914:3: note: in expansion of macro ‘__Pyx_DECREF’\n 5914 |   __Pyx_DECREF(__pyx_v_self->default);\n      |   ^~~~~~~~~~~~\n/_node.c:5915:17: error: expected identifier before ‘default’\n 5915 |   __pyx_v_self->default = __pyx_v_default;\n      |                 ^~~~~~~\n/_node.c: In function ‘__pyx_pf_5ididi_5_node_10Dependency_2__repr__’:\n/_node.c:6051:80: error: expected identifier before ‘default’\n 6051 |   __pyx_t_5 = __Pyx_PyObject_FormatSimpleAndDecref(PyObject_Repr(__pyx_v_self->default), __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 182, __pyx_L1_error)\n      |                                                                                ^~~~~~~\n/_node.c: In function ‘__pyx_pf_5ididi_5_node_10Dependency_4replace_type’:\n/_node.c:6315:66: error: expected identifier before ‘default’\n 6315 |   if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_default, __pyx_v_self->default) < 0) __PYX_ERR(0, 190, __pyx_L1_error)\n      |                                                                  ^~~~~~~\nIn file included from .pixi/envs/default/include/python3.9/pytime.h:6,\n                 from .pixi/envs/default/include/python3.9/Python.h:85,\n                 from /_node.c:28:\n/_node.c: In function ‘__pyx_pf_5ididi_5_node_10Dependency_7default___get__’:\n/_node.c:6455:30: error: expected identifier before ‘default’\n 6455 |   __Pyx_INCREF(__pyx_v_self->default);\n      |                              ^~~~~~~\n.pixi/envs/default/include/python3.9/object.h:112:41: note: in definition of macro ‘_PyObject_CAST’\n  112 | #define _PyObject_CAST(op) ((PyObject*)(op))\n      |                                         ^~\n/_node.c:1624:27: note: in expansion of macro ‘Py_INCREF’\n 1624 |   #define __Pyx_INCREF(r) Py_INCREF(r)\n      |                           ^~~~~~~~~\n/_node.c:6455:3: note: in expansion of macro ‘__Pyx_INCREF’\n 6455 |   __Pyx_INCREF(__pyx_v_self->default);\n      |   ^~~~~~~~~~~~\n/_node.c:6456:27: error: expected identifier before ‘default’\n 6456 |   __pyx_r = __pyx_v_self->default;\n      |                           ^~~~~~~\nIn file included from .pixi/envs/default/include/python3.9/pytime.h:6,\n                 from .pixi/envs/default/include/python3.9/Python.h:85,\n                 from /_node.c:28:\n/_node.c: In function ‘__pyx_pf_5ididi_5_node_10Dependency_6__reduce_cython__’:\n/_node.c:6587:30: error: expected identifier before ‘default’\n 6587 |   __Pyx_INCREF(__pyx_v_self->default);\n      |                              ^~~~~~~\n.pixi/envs/default/include/python3.9/object.h:112:41: note: in definition of macro ‘_PyObject_CAST’\n  112 | #define _PyObject_CAST(op) ((PyObject*)(op))\n      |                                         ^~\n/_node.c:1624:27: note: in expansion of macro ‘Py_INCREF’\n 1624 |   #define __Pyx_INCREF(r) Py_INCREF(r)\n      |                           ^~~~~~~~~\n/_node.c:6587:3: note: in expansion of macro ‘__Pyx_INCREF’\n 6587 |   __Pyx_INCREF(__pyx_v_self->default);\n      |   ^~~~~~~~~~~~\nIn file included from .pixi/envs/default/include/python3.9/tupleobject.h:39,\n                 from .pixi/envs/default/include/python3.9/Python.h:105,\n                 from /_node.c:28:\n/_node.c:6589:58: error: expected identifier before ‘default’\n 6589 |   if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->default)) __PYX_ERR(2, 5, __pyx_L1_error);\n      |                                                          ^~~~~~~\n.pixi/envs/default/include/python3.9/cpython/tupleobject.h:30:69: note: in definition of macro ‘PyTuple_SET_ITEM’\n   30 | #define PyTuple_SET_ITEM(op, i, v) (_PyTuple_CAST(op)->ob_item[i] = v)\n      |                                                                     ^\n/_node.c:6589:7: note: in expansion of macro ‘__Pyx_PyTuple_SET_ITEM’\n 6589 |   if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->default)) __PYX_ERR(2, 5, __pyx_L1_error);\n      |       ^~~~~~~~~~~~~~~~~~~~~~\n/_node.c:1105:69: warning: left-hand operand of comma expression has no effect [-Wunused-value]\n 1105 |   #define __Pyx_PyTuple_SET_ITEM(o, i, v) (PyTuple_SET_ITEM(o, i, v), (0))\n      |                                                                     ^\n/_node.c:6589:7: note: in expansion of macro ‘__Pyx_PyTuple_SET_ITEM’\n 6589 |   if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->default)) __PYX_ERR(2, 5, __pyx_L1_error);\n      |       ^~~~~~~~~~~~~~~~~~~~~~\n/_node.c:6669:32: error: expected identifier before ‘default’\n 6669 |     __pyx_t_4 = (__pyx_v_self->default != Py_None);\n      |                                ^~~~~~~\nIn file included from .pixi/envs/default/include/python3.9/pytime.h:6,\n                 from .pixi/envs/default/include/python3.9/Python.h:85,\n                 from /_node.c:28:\n/_node.c: In function ‘__pyx_f_5ididi_5_node___pyx_unpickle_Dependency__set_state’:\n/_node.c:13235:38: error: expected identifier before ‘default’\n13235 |   __Pyx_DECREF(__pyx_v___pyx_result->default);\n      |                                      ^~~~~~~\n.pixi/envs/default/include/python3.9/object.h:112:41: note: in definition of macro ‘_PyObject_CAST’\n  112 | #define _PyObject_CAST(op) ((PyObject*)(op))\n      |                                         ^~\n/_node.c:1625:27: note: in expansion of macro ‘Py_DECREF’\n 1625 |   #define __Pyx_DECREF(r) Py_DECREF(r)\n      |                           ^~~~~~~~~\n/_node.c:13235:3: note: in expansion of macro ‘__Pyx_DECREF’\n13235 |   __Pyx_DECREF(__pyx_v___pyx_result->default);\n      |   ^~~~~~~~~~~~\n/_node.c:13236:25: error: expected identifier before ‘default’\n13236 |   __pyx_v___pyx_result->default = __pyx_t_1;\n      |                         ^~~~~~~\n/_node.c: In function ‘__pyx_tp_new_5ididi_5_node_Dependency’:\n/_node.c:13383:6: error: expected identifier before ‘default’\n13383 |   p->default = Py_None; Py_INCREF(Py_None);\n      |      ^~~~~~~\nIn file included from .pixi/envs/default/include/python3.9/pytime.h:6,\n                 from .pixi/envs/default/include/python3.9/Python.h:85,\n                 from /_node.c:28:\n/_node.c: In function ‘__pyx_tp_dealloc_5ididi_5_node_Dependency’:\n/_node.c:13399:15: error: expected identifier before ‘default’\n13399 |   Py_CLEAR(p->default);\n      |               ^~~~~~~\n.pixi/envs/default/include/python3.9/object.h:112:41: note: in definition of macro ‘_PyObject_CAST’\n  112 | #define _PyObject_CAST(op) ((PyObject*)(op))\n      |                                         ^~\n/_node.c:13399:3: note: in expansion of macro ‘Py_CLEAR’\n13399 |   Py_CLEAR(p->default);\n      |   ^~~~~~~~\n/_node.c:13399:15: error: expected identifier before ‘default’\n13399 |   Py_CLEAR(p->default);\n      |               ^~~~~~~\n.pixi/envs/default/include/python3.9/object.h:479:14: note: in definition of macro ‘Py_CLEAR’\n  479 |             (op) = NULL;                        \\\n      |              ^~\n/_node.c: In function ‘__pyx_tp_traverse_5ididi_5_node_Dependency’:\n/_node.c:13416:10: error: expected identifier before ‘default’\n13416 |   if (p->default) {\n      |          ^~~~~~~\n/_node.c:13417:17: error: expected identifier before ‘default’\n13417 |     e = (*v)(p->default, a); if (e) return e;\n      |                 ^~~~~~~\n/_node.c:13417:10: error: too few arguments to function ‘v’\n13417 |     e = (*v)(p->default, a); if (e) return e;\n      |         ~^~~\n/_node.c: In function ‘__pyx_tp_clear_5ididi_5_node_Dependency’:\n/_node.c:13428:24: error: expected identifier before ‘default’\n13428 |   tmp = ((PyObject*)p->default);\n      |                        ^~~~~~~\n/_node.c:13429:6: error: expected identifier before ‘default’\n13429 |   p->default = Py_None; Py_INCREF(Py_None);\n```\n\n### Code to reproduce the behaviour:\n\n```cython\n\n#_node.pxd\ncdef class Dependency:\n    cdef readonly str name\n    cdef readonly object param_type\n    cdef readonly object default\n    cdef readonly bint unresolvable\n```\n```py\n# _node.py\nclass Dependency:\n    def __init__(\n        self,\n        name: str,\n        param_type: IDependent[T],\n        default: Maybe[T],\n    ) -> None:\n        self.name = name\n        self.param_type = param_type\n        self.default = default\n        self.unresolvable = is_unsolvable_type(param_type)\n```\n",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "there is an easy and obvious workaround: rename `default` to anything other than `default`, but just in case this something you would like to fix.",
            "created_at": "2025-02-17T12:25:13Z",
            "html_url": "https://github.com/cython/cython/issues/6678#issuecomment-2662968885",
            "id": 2662968885,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6678",
            "node_id": "IC_kwDOABDGAc6eua41",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2662968885/reactions"
            },
            "updated_at": "2025-02-17T12:25:13Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2662968885",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/75417963?v=4",
                "events_url": "https://api.github.com/users/raceychan/events{/privacy}",
                "followers_url": "https://api.github.com/users/raceychan/followers",
                "following_url": "https://api.github.com/users/raceychan/following{/other_user}",
                "gists_url": "https://api.github.com/users/raceychan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/raceychan",
                "id": 75417963,
                "login": "raceychan",
                "node_id": "MDQ6VXNlcjc1NDE3OTYz",
                "organizations_url": "https://api.github.com/users/raceychan/orgs",
                "received_events_url": "https://api.github.com/users/raceychan/received_events",
                "repos_url": "https://api.github.com/users/raceychan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/raceychan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/raceychan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/raceychan",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/6678/comments",
    "created_at": "2025-02-17T12:17:55Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/6678/events",
    "html_url": "https://github.com/cython/cython/issues/6678",
    "id": 2857687776,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/6678/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc6qVNrg",
    "number": 6678,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/6678/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/6678/timeline",
    "title": "[BUG] setting a cdef class attribute with name \"default\"  would cause error",
    "updated_at": "2025-02-17T12:25:14Z",
    "url": "https://api.github.com/repos/cython/cython/issues/6678",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/75417963?v=4",
        "events_url": "https://api.github.com/users/raceychan/events{/privacy}",
        "followers_url": "https://api.github.com/users/raceychan/followers",
        "following_url": "https://api.github.com/users/raceychan/following{/other_user}",
        "gists_url": "https://api.github.com/users/raceychan/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/raceychan",
        "id": 75417963,
        "login": "raceychan",
        "node_id": "MDQ6VXNlcjc1NDE3OTYz",
        "organizations_url": "https://api.github.com/users/raceychan/orgs",
        "received_events_url": "https://api.github.com/users/raceychan/received_events",
        "repos_url": "https://api.github.com/users/raceychan/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/raceychan/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/raceychan/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/raceychan",
        "user_view_type": "public"
    }
}