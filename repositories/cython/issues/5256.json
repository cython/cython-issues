{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "I am trying to use a NumPy array of strings as an input for a cython function. However, I can't seem to figure out how to actually use a numPy array of strings with cython.\r\n\r\nHere is an example of the array I am trying to use as an input for my function:\r\n\r\n`np.array(['foo', 'bar', 'baz', 'foo', 'bar'])`\r\n\r\n**Attempt 1:**\r\n```\r\n#cython: language_level=3\r\nimport numpy as np\r\ncimport numpy as np\r\ncimport cython\r\n\r\ndef test_print(np.ndarray[str, ndim=1] unique_product_uids_np):\r\n    cdef str key\r\n    for key in unique_product_uids_np:\r\n        print(key)\r\n```\r\nThe above code compiles but when you try and use the function, you get the following error\r\n\r\n```\r\narr = np.array(['foo', 'bar', 'baz', 'foo', 'bar'])\r\ndoes_this_work.test_print(arr)\r\n```\r\n`Does not understand character buffer dtype format string ('w')`\r\n\r\n**Attempt 2**:\r\n\r\n```\r\n#cython: language_level=3\r\nimport numpy as np\r\ncimport numpy as np\r\ncimport cython\r\n\r\ndef test_print(np.ndarray[np.str_, ndim=1] unique_product_uids_np):\r\n    cdef np.str_ key\r\n    for key in unique_product_uids_np:\r\n        print(key)\r\n```\r\n\r\n```\r\nError when compiling:\r\n    def test_print(np.ndarray[np.str_, ndim=1] unique_product_uids_np):\r\n                               ^\r\n    does_this_work.pyx:6:33: Invalid type.\r\n```\r\nI did the exact same test for unicode and got the same results as above. where unicode compiled but threw the Does not understand character buffer dtype format string ('w') and np.unicode_ didn't compile and threw the Invalid type error while compiling.\r\n\r\nHere is what my setup.py file looks\r\n\r\n```\r\nfrom distutils.core import setup\r\nfrom Cython.Build import cythonize\r\nimport numpy\r\n\r\nsetup(ext_modules = cythonize('does_this_work.pyx', annotate=True),\r\n      compiler_directives={'language_level' : \"3\"},\r\n      include_dirs=[numpy.get_include()])\r\n```\r\nand here is the command I am using to compile:\r\n\r\n`python setup.py build_ext --inplace`\r\n\r\nI am using: Python version 3.10, Cython version 0.29.33, NumPy version 1.24.2",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5256/comments",
    "created_at": "2023-02-22T12:37:56Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5256/events",
    "html_url": "https://github.com/cython/cython/issues/5256",
    "id": 1595033609,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5256/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5fEkgJ",
    "number": 5256,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5256/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5256/timeline",
    "title": "Does not understand character buffer dtype format string ('w')",
    "updated_at": "2023-02-22T12:38:57Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5256",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/104008548?v=4",
        "events_url": "https://api.github.com/users/brianwilliams112/events{/privacy}",
        "followers_url": "https://api.github.com/users/brianwilliams112/followers",
        "following_url": "https://api.github.com/users/brianwilliams112/following{/other_user}",
        "gists_url": "https://api.github.com/users/brianwilliams112/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/brianwilliams112",
        "id": 104008548,
        "login": "brianwilliams112",
        "node_id": "U_kgDOBjMLZA",
        "organizations_url": "https://api.github.com/users/brianwilliams112/orgs",
        "received_events_url": "https://api.github.com/users/brianwilliams112/received_events",
        "repos_url": "https://api.github.com/users/brianwilliams112/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/brianwilliams112/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/brianwilliams112/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/brianwilliams112"
    }
}