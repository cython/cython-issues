{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "**Describe the bug**\r\nSeems like cython generated C code does some invalid pointer arithmethics.\r\n\r\nOn freebsd, `pthread_t` is `struct pthread *` - an opaque pointer to a pthread struct (of unknown content).\r\n\r\nSee there:  https://github.com/python-llfuse/python-llfuse/issues/28\r\n\r\n**To Reproduce**\r\n\r\n```\r\npip install llfuse==1.3.7 # FAILS on e.g. freebsd 12.1 64bit\r\npip install llfuse==1.3.6 # WORKS on e.g. freebsd 12.1 64bit\r\n```\r\n\r\n**Expected behavior**\r\nOlder 1.3.6 (from 2019, with C code being generated by older cython 0.29.xx): compilations works.\r\n\r\nWith current 1.3.7 (from now, with C code being generated by recent cython 0.29.21): compilation fails.\r\n\r\nThere are very little differences between 1.3.6 and 1.3.7, so the regression is likely caused by the more recent cython version used to generate llfuse.c.\r\n\r\nThe only reason for the 1.3.7 release was that 1.3.6 did not compile on python 3.9.\r\n\r\n**Environment:**\r\n - OS: FreeBSD 12.1\r\n - Python version 3.6.10\r\n - Cython version 0.29.21\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "BTW: llfuse 1.3.7 works on Linux.\r\n",
            "created_at": "2020-10-04T21:02:44Z",
            "html_url": "https://github.com/cython/cython/issues/3860#issuecomment-703315741",
            "id": 703315741,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3860",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzMxNTc0MQ==",
            "performed_via_github_app": null,
            "updated_at": "2020-10-04T21:02:44Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/703315741",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/356103?v=4",
                "events_url": "https://api.github.com/users/ThomasWaldmann/events{/privacy}",
                "followers_url": "https://api.github.com/users/ThomasWaldmann/followers",
                "following_url": "https://api.github.com/users/ThomasWaldmann/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThomasWaldmann/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ThomasWaldmann",
                "id": 356103,
                "login": "ThomasWaldmann",
                "node_id": "MDQ6VXNlcjM1NjEwMw==",
                "organizations_url": "https://api.github.com/users/ThomasWaldmann/orgs",
                "received_events_url": "https://api.github.com/users/ThomasWaldmann/received_events",
                "repos_url": "https://api.github.com/users/ThomasWaldmann/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ThomasWaldmann/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThomasWaldmann/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ThomasWaldmann"
            }
        },
        {
            "author_association": "COLLABORATOR",
            "body": "I'd suggest https://github.com/python-llfuse/python-llfuse/blob/afb3fd1da89947f7bf286b3b4c87ed5f687b762a/Include/pthread.pxd#L17 might be why Cython thinks that pthread can be treated as an integer.\r\n\r\nNot 100% sure what the fix is, but I think Cython is acting reasonably with the information given to it. You possibly just want to change the definition to be an empty struct (e.g. `ctypedef struct pthread: pass`, or something similar). Or maybe try declaring it as an unsigned int instead (not confident this'll work though)",
            "created_at": "2020-10-04T22:17:37Z",
            "html_url": "https://github.com/cython/cython/issues/3860#issuecomment-703323923",
            "id": 703323923,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3860",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzMyMzkyMw==",
            "performed_via_github_app": null,
            "updated_at": "2020-10-04T22:26:31Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/703323923",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3860/comments",
    "created_at": "2020-10-04T21:01:26Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3860/events",
    "html_url": "https://github.com/cython/cython/issues/3860",
    "id": 714401771,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3860/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU3MTQ0MDE3NzE=",
    "number": 3860,
    "performed_via_github_app": null,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "[BUG] issue in recent cython code generation for freebsd?",
    "updated_at": "2020-10-04T22:26:31Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3860",
    "user": {
        "avatar_url": "https://avatars0.githubusercontent.com/u/356103?v=4",
        "events_url": "https://api.github.com/users/ThomasWaldmann/events{/privacy}",
        "followers_url": "https://api.github.com/users/ThomasWaldmann/followers",
        "following_url": "https://api.github.com/users/ThomasWaldmann/following{/other_user}",
        "gists_url": "https://api.github.com/users/ThomasWaldmann/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ThomasWaldmann",
        "id": 356103,
        "login": "ThomasWaldmann",
        "node_id": "MDQ6VXNlcjM1NjEwMw==",
        "organizations_url": "https://api.github.com/users/ThomasWaldmann/orgs",
        "received_events_url": "https://api.github.com/users/ThomasWaldmann/received_events",
        "repos_url": "https://api.github.com/users/ThomasWaldmann/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ThomasWaldmann/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ThomasWaldmann/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ThomasWaldmann"
    }
}