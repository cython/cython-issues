{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nWhen `PACKAGE` is a namespace package, then both:\r\n```cython\r\ncimport PACKAGE\r\n```\r\nor\r\n```cython\r\nfrom PACKAGE cimport MODULE\r\n```\r\nfail at compilation, complaining that `PACKAGE.pxd` can't be found.\r\n\r\nPresumably cython has looked for `PACKAGE/__init__.*` and `PACKAGE.*` which are not available for a namespace package.\r\n\r\nThis was discovered as part of https://github.com/sagemath/sage/pull/35322.\n\n### Code to reproduce the behaviour:\n\n1. Patch the pep420 test in master as follows:\r\n```diff\r\n--- a/tests/build/cythonize_pep420_namespace.srctree\r\n+++ b/tests/build/cythonize_pep420_namespace.srctree\r\n@@ -31,9 +31,17 @@ cdef class A:\r\n \r\n ######## nsp/m2/b.pyx ########\r\n \r\n+from nsp.m1 cimport a\r\n from nsp.m1.a cimport A\r\n+from nsp.m3.c cimport d   ### BROKEN\r\n from nsp.m3.c.d cimport D\r\n \r\n+cimport nsp.m1\r\n+cimport nsp.m1.a\r\n+cimport nsp.m3\r\n+cimport nsp.m3.c  ### BROKEN\r\n+cimport nsp.m3.c.d\r\n+\r\n cdef class B(A):\r\n     pass\r\n \r\n``` \r\nI added several new tests for the different ways one can `cimport` modules. All of them work ok, except the two I've marked BROKEN which corresponds to the ones mentioned in the description.\r\n\r\n2. Build and run `./runtests.py cythonize_pep420_namespace`, to get:\r\n```\r\nError compiling Cython file:\r\n------------------------------------------------------------\r\n...\r\n\r\nfrom nsp.m1 cimport a\r\nfrom nsp.m1.a cimport A\r\nfrom nsp.m3.c cimport d\r\n^\r\n------------------------------------------------------------\r\n\r\nnsp/m2/b.pyx:4:0: 'nsp/m3/c.pxd' not found\r\n```\r\n\r\n3. Comment out the first line marked BROKEN above and repeat the test to get:\r\n```\r\nError compiling Cython file:\r\n------------------------------------------------------------\r\n...\r\nfrom nsp.m3.c.d cimport D\r\n\r\ncimport nsp.m1\r\ncimport nsp.m1.a\r\ncimport nsp.m3\r\ncimport nsp.m3.c\r\n        ^\r\n------------------------------------------------------------\r\n\r\nnsp/m2/b.pyx:10:8: 'nsp/m3/c.pxd' not found\r\n```\r\n\r\n4. Comment out the second line marked BROKEN, now all tests pass.\n\n### Expected behaviour\n\nAll tests pass, including the two marked BROKEN.\n\n### OS\n\nlinux\n\n### Python version\n\n3.11.2\n\n### Cython version\n\n3.0.0b1+master (2ea4f96af474fd818621bcaca4d2578d558e0908)\n\n### Additional context\n\nIn sagemath we still use 0.29.33, with #2946 backported (see https://github.com/sagemath/sage/blob/develop/build/pkgs/cython/patches/4918.patch) so other uses of namespace packages work ok.\r\n\r\nWhatever is the solution, it'd be nice to have it backported to 0.29.x.\r\n\r\nIt would also be wonderful if 0.29.34 could include #2946.",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5335/comments",
    "created_at": "2023-03-24T23:26:03Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8345221?v=4",
                "events_url": "https://api.github.com/users/mkoeppe/events{/privacy}",
                "followers_url": "https://api.github.com/users/mkoeppe/followers",
                "following_url": "https://api.github.com/users/mkoeppe/following{/other_user}",
                "gists_url": "https://api.github.com/users/mkoeppe/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mkoeppe",
                "id": 8345221,
                "login": "mkoeppe",
                "node_id": "MDQ6VXNlcjgzNDUyMjE=",
                "organizations_url": "https://api.github.com/users/mkoeppe/orgs",
                "received_events_url": "https://api.github.com/users/mkoeppe/received_events",
                "repos_url": "https://api.github.com/users/mkoeppe/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mkoeppe/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mkoeppe/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mkoeppe"
            },
            "commit_id": "f13d6e93ead771b0acf7769f442ad662ef3ffa71",
            "commit_url": "https://api.github.com/repos/mkoeppe/sage/commits/f13d6e93ead771b0acf7769f442ad662ef3ffa71",
            "created_at": "2023-03-25T00:42:37Z",
            "event": "referenced",
            "id": 8843902565,
            "node_id": "REFE_lADOABDGAc5hw0HFzwAAAAIPIz5l",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8843902565"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8345221?v=4",
                "events_url": "https://api.github.com/users/mkoeppe/events{/privacy}",
                "followers_url": "https://api.github.com/users/mkoeppe/followers",
                "following_url": "https://api.github.com/users/mkoeppe/following{/other_user}",
                "gists_url": "https://api.github.com/users/mkoeppe/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mkoeppe",
                "id": 8345221,
                "login": "mkoeppe",
                "node_id": "MDQ6VXNlcjgzNDUyMjE=",
                "organizations_url": "https://api.github.com/users/mkoeppe/orgs",
                "received_events_url": "https://api.github.com/users/mkoeppe/received_events",
                "repos_url": "https://api.github.com/users/mkoeppe/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mkoeppe/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mkoeppe/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mkoeppe"
            },
            "commit_id": "5ee730dbb56fa85d3657f7968b0ab0bdefa59a9a",
            "commit_url": "https://api.github.com/repos/mkoeppe/sage/commits/5ee730dbb56fa85d3657f7968b0ab0bdefa59a9a",
            "created_at": "2023-03-25T00:42:37Z",
            "event": "referenced",
            "id": 8843902579,
            "node_id": "REFE_lADOABDGAc5hw0HFzwAAAAIPIz5z",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8843902579"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5335/events",
    "html_url": "https://github.com/cython/cython/issues/5335",
    "id": 1640186309,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5335/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5hw0HF",
    "number": 5335,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5335/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5335/timeline",
    "title": "[BUG] namespace packages as in pep 420 cannot be `cimport`ed",
    "updated_at": "2023-03-24T23:26:03Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5335",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1581419?v=4",
        "events_url": "https://api.github.com/users/tornaria/events{/privacy}",
        "followers_url": "https://api.github.com/users/tornaria/followers",
        "following_url": "https://api.github.com/users/tornaria/following{/other_user}",
        "gists_url": "https://api.github.com/users/tornaria/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tornaria",
        "id": 1581419,
        "login": "tornaria",
        "node_id": "MDQ6VXNlcjE1ODE0MTk=",
        "organizations_url": "https://api.github.com/users/tornaria/orgs",
        "received_events_url": "https://api.github.com/users/tornaria/received_events",
        "repos_url": "https://api.github.com/users/tornaria/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tornaria/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tornaria/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tornaria"
    }
}