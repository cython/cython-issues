{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "**Describe the bug**\r\nI tried building [yt](https://github.com/yt-project/yt) using the latest Cython alpha (3.0.0a10), which failed with\r\n\r\n```\r\nAttributeError: cython_sources\r\n```\r\n\r\nSee an example failed job here for full traceback\r\nhttps://github.com/yt-project/yt/runs/7598205895?check_suite_focus=true\r\n\r\n**To Reproduce**\r\nhere's the exact workflow file used https://github.com/neutrinoceros/yt/blob/test_cython_3/.github/workflows/bleeding-edge.yaml\r\n\r\nThese are the command invoked to build yt in this test env\r\n```\r\npython setup.py build_ext -q -j2                                 # runs fine\r\npython -m pip install -e .[test] --no-build-isolation            # crashes\r\n```\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Ubuntu 20.04.4\r\n - Python version: 3.11.0b5\r\n - Cython version: 3.0.0a10\r\n\r\n**Additional context**\r\n\r\nMost recent releases for pip and setuptools are used\r\n- pip 22.2.1\r\n- setuptools 63.2.0\r\n\r\nI have very little understanding of the traceback. I *think* the problem comes from Cython because I'm just getting started testing 3.0, and the error also seems to hint that way. I'll happily provide any further details upon request.",
    "closed_at": "2022-07-31T14:15:55Z",
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "The test failed on `Collecting PyYAML`, so it's not about the code in the yt (maybe except the setup), although the error suggests that it does have something to do with the cython:\r\n```\r\nCollecting PyYAML\r\n  Downloading PyYAML-6.0.tar.gz (124 kB)\r\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 125.0/125.0 kB 34.3 MB/s eta 0:00:00\r\n  Preparing metadata (pyproject.toml): started\r\n  Preparing metadata (pyproject.toml): finished with status 'error'\r\n  error: subprocess-exited-with-error\r\n  \r\n  × Preparing metadata (pyproject.toml) did not run successfully.\r\n  │ exit code: 1\r\n  ╰─> [53 lines of output]\r\n      running dist_info\r\n      creating /tmp/pip-modern-metadata-30a1v8vn/PyYAML.egg-info\r\n      writing /tmp/pip-modern-metadata-30a1v8vn/PyYAML.egg-info/PKG-INFO\r\n      writing dependency_links to /tmp/pip-modern-metadata-30a1v8vn/PyYAML.egg-info/dependency_links.txt\r\n      writing top-level names to /tmp/pip-modern-metadata-30a1v8vn/PyYAML.egg-info/top_level.txt\r\n      writing manifest file '/tmp/pip-modern-metadata-30a1v8vn/PyYAML.egg-info/SOURCES.txt'\r\n      Traceback (most recent call last):\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 363, in <module>\r\n          main()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 345, in main\r\n          json_out['return_val'] = hook(**hook_input['kwargs'])\r\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 164, in prepare_metadata_for_build_wheel\r\n          return hook(metadata_directory, config_settings)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/build_meta.py\", line 188, in prepare_metadata_for_build_wheel\r\n          self.run_setup()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/build_meta.py\", line 174, in run_setup\r\n          exec(code, locals())\r\n        File \"<string>\", line 288, in <module>\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/__init__.py\", line 87, in setup\r\n          return distutils.core.setup(**attrs)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/core.py\", line 177, in setup\r\n          return run_commands(dist)\r\n                 ^^^^^^^^^^^^^^^^^^\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/core.py\", line 193, in run_commands\r\n          dist.run_commands()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/dist.py\", line 968, in run_commands\r\n          self.run_command(cmd)\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/dist.py\", line 1217, in run_command\r\n          super().run_command(command)\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/dist.py\", line 987, in run_command\r\n          cmd_obj.run()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/command/dist_info.py\", line 35, in run\r\n          egg_info.run()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/command/egg_info.py\", line 307, in run\r\n          self.find_sources()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/command/egg_info.py\", line 314, in find_sources\r\n          mm.run()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/command/egg_info.py\", line 549, in run\r\n          self.add_defaults()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/command/egg_info.py\", line 586, in add_defaults\r\n          sdist.add_defaults(self)\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/command/sdist.py\", line 252, in add_defaults\r\n          self._add_defaults_ext()\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/command/sdist.py\", line 337, in _add_defaults_ext\r\n          self.filelist.extend(build_ext.get_source_files())\r\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n        File \"<string>\", line 204, in get_source_files\r\n        File \"/opt/hostedtoolcache/Python/3.11.0-beta.5/x64/lib/python3.11/site-packages/setuptools/_distutils/cmd.py\", line 103, in __getattr__\r\n          raise AttributeError(attr)\r\n      AttributeError: cython_sources\r\n      [end of output]\r\n  \r\n  note: This error originates from a subprocess, and is likely not a problem with pip.\r\nerror: metadata-generation-failed\r\n\r\n× Encountered error while generating package metadata.\r\n╰─> See above for output.\r\n\r\n```",
            "created_at": "2022-07-31T12:52:16Z",
            "html_url": "https://github.com/cython/cython/issues/4940#issuecomment-1200419282",
            "id": 1200419282,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4940",
            "node_id": "IC_kwDOABDGAc5HjPHS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1200419282/reactions"
            },
            "updated_at": "2022-07-31T13:03:21Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1200419282",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/52697657?v=4",
                "events_url": "https://api.github.com/users/0dminnimda/events{/privacy}",
                "followers_url": "https://api.github.com/users/0dminnimda/followers",
                "following_url": "https://api.github.com/users/0dminnimda/following{/other_user}",
                "gists_url": "https://api.github.com/users/0dminnimda/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/0dminnimda",
                "id": 52697657,
                "login": "0dminnimda",
                "node_id": "MDQ6VXNlcjUyNjk3NjU3",
                "organizations_url": "https://api.github.com/users/0dminnimda/orgs",
                "received_events_url": "https://api.github.com/users/0dminnimda/received_events",
                "repos_url": "https://api.github.com/users/0dminnimda/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/0dminnimda/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/0dminnimda/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/0dminnimda"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "PyYAML was [hooking into](https://github.com/yaml/pyyaml/blob/8cdff2c80573b8be8e8ad28929264a913a63aa33/setup.py#L204) `old_build_ext` here, which was replaced by `new_build_ext` in 3.0a10 (https://github.com/cython/cython/pull/4498). The [old version](https://github.com/cython/cython/blob/master/Cython/Distutils/old_build_ext.py) had a method called `cython_sources()`.",
            "created_at": "2022-07-31T14:12:09Z",
            "html_url": "https://github.com/cython/cython/issues/4940#issuecomment-1200433308",
            "id": 1200433308,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4940",
            "node_id": "IC_kwDOABDGAc5HjSic",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1200433308/reactions"
            },
            "updated_at": "2022-07-31T14:12:09Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1200433308",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Duplicate of #4568.",
            "created_at": "2022-07-31T14:15:55Z",
            "html_url": "https://github.com/cython/cython/issues/4940#issuecomment-1200434053",
            "id": 1200434053,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4940",
            "node_id": "IC_kwDOABDGAc5HjSuF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1200434053/reactions"
            },
            "updated_at": "2022-07-31T14:15:55Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1200434053",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks for the clarification. Sorry I wasn't able to connect the dots myself.",
            "created_at": "2022-07-31T14:37:42Z",
            "html_url": "https://github.com/cython/cython/issues/4940#issuecomment-1200438078",
            "id": 1200438078,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4940",
            "node_id": "IC_kwDOABDGAc5HjTs-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1200438078/reactions"
            },
            "updated_at": "2022-07-31T14:37:42Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1200438078",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14075922?v=4",
                "events_url": "https://api.github.com/users/neutrinoceros/events{/privacy}",
                "followers_url": "https://api.github.com/users/neutrinoceros/followers",
                "following_url": "https://api.github.com/users/neutrinoceros/following{/other_user}",
                "gists_url": "https://api.github.com/users/neutrinoceros/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neutrinoceros",
                "id": 14075922,
                "login": "neutrinoceros",
                "node_id": "MDQ6VXNlcjE0MDc1OTIy",
                "organizations_url": "https://api.github.com/users/neutrinoceros/orgs",
                "received_events_url": "https://api.github.com/users/neutrinoceros/received_events",
                "repos_url": "https://api.github.com/users/neutrinoceros/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neutrinoceros/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neutrinoceros/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/neutrinoceros"
            }
        },
        {
            "author_association": "NONE",
            "body": "Just to further confirm there wasn't any other incompatibilities for building yt, thanks again !",
            "created_at": "2022-07-31T16:40:15Z",
            "html_url": "https://github.com/cython/cython/issues/4940#issuecomment-1200459157",
            "id": 1200459157,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4940",
            "node_id": "IC_kwDOABDGAc5HjY2V",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1200459157/reactions"
            },
            "updated_at": "2022-07-31T16:40:15Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1200459157",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14075922?v=4",
                "events_url": "https://api.github.com/users/neutrinoceros/events{/privacy}",
                "followers_url": "https://api.github.com/users/neutrinoceros/followers",
                "following_url": "https://api.github.com/users/neutrinoceros/following{/other_user}",
                "gists_url": "https://api.github.com/users/neutrinoceros/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neutrinoceros",
                "id": 14075922,
                "login": "neutrinoceros",
                "node_id": "MDQ6VXNlcjE0MDc1OTIy",
                "organizations_url": "https://api.github.com/users/neutrinoceros/orgs",
                "received_events_url": "https://api.github.com/users/neutrinoceros/received_events",
                "repos_url": "https://api.github.com/users/neutrinoceros/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neutrinoceros/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neutrinoceros/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/neutrinoceros"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/4940/comments",
    "created_at": "2022-07-31T12:14:02Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2022-07-31T14:15:56Z",
            "event": "closed",
            "id": 7096382237,
            "node_id": "CE_lADOABDGAc5O4iybzwAAAAGm-jMd",
            "performed_via_github_app": null,
            "state_reason": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/7096382237"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2022-07-31T14:16:07Z",
            "event": "labeled",
            "id": 7096382454,
            "label": {
                "color": "444444",
                "name": "R: duplicate"
            },
            "node_id": "LE_lADOABDGAc5O4iybzwAAAAGm-jP2",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/7096382454"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/4940/events",
    "html_url": "https://github.com/cython/cython/issues/4940",
    "id": 1323445403,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425556894,
            "name": "R: duplicate",
            "node_id": "MDU6TGFiZWw0MjU1NTY4OTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/R:%20duplicate"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/4940/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5O4iyb",
    "number": 4940,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/4940/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/4940/timeline",
    "title": "[BUG] fail to build yt with Cython 3.0.0a10 (AttributeError: cython_sources)",
    "updated_at": "2022-07-31T16:40:15Z",
    "url": "https://api.github.com/repos/cython/cython/issues/4940",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/14075922?v=4",
        "events_url": "https://api.github.com/users/neutrinoceros/events{/privacy}",
        "followers_url": "https://api.github.com/users/neutrinoceros/followers",
        "following_url": "https://api.github.com/users/neutrinoceros/following{/other_user}",
        "gists_url": "https://api.github.com/users/neutrinoceros/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/neutrinoceros",
        "id": 14075922,
        "login": "neutrinoceros",
        "node_id": "MDQ6VXNlcjE0MDc1OTIy",
        "organizations_url": "https://api.github.com/users/neutrinoceros/orgs",
        "received_events_url": "https://api.github.com/users/neutrinoceros/received_events",
        "repos_url": "https://api.github.com/users/neutrinoceros/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/neutrinoceros/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/neutrinoceros/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/neutrinoceros"
    }
}