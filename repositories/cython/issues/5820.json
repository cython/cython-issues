{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Describe the bug\r\n\r\nSee also [numpygh-25135](https://github.com/numpy/numpy/issues/25135) at least for in-place builds with a hook, Cython cannot find the `__init__.pyd`.\r\n\r\nNow, to some degree, that is not surprising and maybe just expected, because `sys.path` doesn't include the module *unless* it is imported first.\r\n(The issue creator says there is some other path a wrong `__init__.pyd` might be found, but I am not sure.)\r\n\r\n\r\n### Solution(?)\r\n\r\nI *suspect*, the solution has to be to add an explicit import (e.g. `import numpy`) if a development/inplace install is hooked (i.e. when a `<top-level-module>-editable.pth` is found).\r\n(Or whatever is exactly the normal import machineries behavior here.)\r\n\r\n### Additional context\r\n\r\nThis isn't high priority at least for me; I taped it over in the NumPy tests.  And I doubt there are many who use in-place builds of NumPy to then build a different project.\r\n\r\n(Maybe our in-place build setup could also be improved to help Cython.)",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "I just realized that there is also a way to install zips of a package loaded via [`zipimport`](https://docs.python.org/3/library/zipimport.html).\r\nNot dealing with that (if that is the case, I have not checked) could be a bigger issue in practice than the editable install issue.\r\n\r\nEDIT: Although, nvm, maybe... In that case you would also have problems with finding the right headers during compilation anyway.",
            "created_at": "2023-11-15T08:46:08Z",
            "html_url": "https://github.com/cython/cython/issues/5820#issuecomment-1812029443",
            "id": 1812029443,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5820",
            "node_id": "IC_kwDOABDGAc5sAWAD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1812029443/reactions"
            },
            "updated_at": "2023-11-15T09:11:13Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1812029443",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61977?v=4",
                "events_url": "https://api.github.com/users/seberg/events{/privacy}",
                "followers_url": "https://api.github.com/users/seberg/followers",
                "following_url": "https://api.github.com/users/seberg/following{/other_user}",
                "gists_url": "https://api.github.com/users/seberg/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seberg",
                "id": 61977,
                "login": "seberg",
                "node_id": "MDQ6VXNlcjYxOTc3",
                "organizations_url": "https://api.github.com/users/seberg/orgs",
                "received_events_url": "https://api.github.com/users/seberg/received_events",
                "repos_url": "https://api.github.com/users/seberg/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seberg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seberg/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seberg"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Copying a comment [from elsewhere](https://github.com/cython/cython/issues/2905#issuecomment-476170510), The heuristic used to find include files is:\r\n- user provided `include_directories`\r\n- `sys.path`\r\n- `Cython/Includes`\r\n\r\n----\r\nThere are situations like editable installs where a project's top-level `__init__.pxd` is not on `sys.path`, and the only reliable place to find it is via `import <project>; <project>.__file__`",
            "created_at": "2023-11-15T10:29:56Z",
            "html_url": "https://github.com/cython/cython/issues/5820#issuecomment-1812198110",
            "id": 1812198110,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5820",
            "node_id": "IC_kwDOABDGAc5sA_Le",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1812198110/reactions"
            },
            "updated_at": "2023-11-15T10:29:56Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1812198110",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/823911?v=4",
                "events_url": "https://api.github.com/users/mattip/events{/privacy}",
                "followers_url": "https://api.github.com/users/mattip/followers",
                "following_url": "https://api.github.com/users/mattip/following{/other_user}",
                "gists_url": "https://api.github.com/users/mattip/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mattip",
                "id": 823911,
                "login": "mattip",
                "node_id": "MDQ6VXNlcjgyMzkxMQ==",
                "organizations_url": "https://api.github.com/users/mattip/orgs",
                "received_events_url": "https://api.github.com/users/mattip/received_events",
                "repos_url": "https://api.github.com/users/mattip/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mattip/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mattip/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mattip"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "One way to change this from a potentially confusing error (where the duplicate files get out of sync) to a clear error would be to drop the Cython include files for NumPy. The Numpy ones have been pretty stable since NumPy 1.20 or so (released in Jan 2021), which was the first release with the Cython3.0-specific `__init__.cython-30.pxd`. Going forward (cython3.1) maybe we could set a minimum numpy requirement to 1.20 ?\r\n\r\nEdit: just to be clear: the intention is to drop the files from Cython/Include",
            "created_at": "2023-11-15T12:57:43Z",
            "html_url": "https://github.com/cython/cython/issues/5820#issuecomment-1812491784",
            "id": 1812491784,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5820",
            "node_id": "IC_kwDOABDGAc5sCG4I",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1812491784/reactions"
            },
            "updated_at": "2023-11-15T12:58:42Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1812491784",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/823911?v=4",
                "events_url": "https://api.github.com/users/mattip/events{/privacy}",
                "followers_url": "https://api.github.com/users/mattip/followers",
                "following_url": "https://api.github.com/users/mattip/following{/other_user}",
                "gists_url": "https://api.github.com/users/mattip/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mattip",
                "id": 823911,
                "login": "mattip",
                "node_id": "MDQ6VXNlcjgyMzkxMQ==",
                "organizations_url": "https://api.github.com/users/mattip/orgs",
                "received_events_url": "https://api.github.com/users/mattip/received_events",
                "repos_url": "https://api.github.com/users/mattip/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mattip/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mattip/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mattip"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5820/comments",
    "created_at": "2023-11-15T08:31:47Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5820/events",
    "html_url": "https://github.com/cython/cython/issues/5820",
    "id": 1994292676,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5820/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc523n3E",
    "number": 5820,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5820/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5820/timeline",
    "title": "[BUG] Cython doesn't understand inplace build mechanics when searching for `__init__.pyd`",
    "updated_at": "2023-11-15T12:58:42Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5820",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/61977?v=4",
        "events_url": "https://api.github.com/users/seberg/events{/privacy}",
        "followers_url": "https://api.github.com/users/seberg/followers",
        "following_url": "https://api.github.com/users/seberg/following{/other_user}",
        "gists_url": "https://api.github.com/users/seberg/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/seberg",
        "id": 61977,
        "login": "seberg",
        "node_id": "MDQ6VXNlcjYxOTc3",
        "organizations_url": "https://api.github.com/users/seberg/orgs",
        "received_events_url": "https://api.github.com/users/seberg/received_events",
        "repos_url": "https://api.github.com/users/seberg/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/seberg/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/seberg/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/seberg"
    }
}