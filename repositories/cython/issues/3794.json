{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "**Describe the bug**\r\nInitializing a subclass of typing.Dict results in a runtime error.\r\n\r\n**To Reproduce**\r\nCode to reproduce the behaviour:\r\n`test.py`\r\n```cython\r\nimport typing\r\n\r\nclass MyDict(typing.Dict[int, float]):\r\n    pass\r\n```\r\n`$ cython test.py -3 --inplace`\r\n`$ python -c \"import test\"`\r\n```\r\nPython 3.8.5 (default, Jul 27 2020, 08:42:51) \r\n[GCC 10.1.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import test\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"test.py\", line 4, in init test\r\n    class MyDict(typing.Dict[int, float]):\r\nTypeError: __init__() takes 3 positional arguments but 4 were given\r\n```\r\n\r\n**Expected behavior**\r\nIt should initialize successfully.\r\n\r\nUsing `dict` instead of `typing.Dict` works fine, but `typing.Dict` has `dict` in its MRO anyway, so I am not sure why this isn't working.\r\n\r\n```py\r\n>>> typing.Dict.mro()\r\n[<class 'dict'>, <class 'object'>]\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: [e.g. Linux, Windows, macOS]\r\n`$ uname -a`\r\n```\r\nLinux z170x 5.8.1-3-MANJARO #1 SMP PREEMPT Sat Aug 15 19:17:30 UTC 2020 x86_64 GNU/Linux\r\n```\r\n - Python version [e.g. 3.8.4]\r\n`$ python -VV`\r\n```\r\nPython 3.8.5 (default, Jul 27 2020, 08:42:51) \r\n[GCC 10.1.0]\r\n```\r\n - Cython version [e.g. 0.29.18]\r\n[`git+https://github.com/cython/cython@4d54aeff34753551cf0ac9977d50c292dbf9d5d5` - origin/master](https://github.com/cython/cython/commit/4d54aeff34753551cf0ac9977d50c292dbf9d5d5)\r\n\r\n----\r\n\r\nI have made a diff of the generated source between using `class MyDict(dict)` which works and `class MyDict(typing.Dict[int, float])` which doesn't.\r\n\r\n[generated.diff.txt](https://github.com/cython/cython/files/5141149/generated.diff.txt)\r\n\r\nI can also confirm that it still breaks if I use `MyDict(typing.Dict)` without typevars, so it is the call to one of the subclassing hooks, rather than the class getitem.\r\n\r\n----\r\n\r\nLooks like it is definitely this line that is causing the issue:\r\n`2091      __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_MyDict, __pyx_t_1, __pyx_t_3, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4, __pyx_L1_error)`. I'll try installing cygdb and see if I can get any other details.",
    "closed_at": "2020-08-28T11:36:36Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Ok, from what I can tell, it looks like the class is being initialized with `(NULL, name, bases, dict)` when it is only expecting `(NULL, name, bases)`. \r\n\r\nIs this an overly easy fix?\r\n",
            "created_at": "2020-08-28T09:39:57Z",
            "html_url": "https://github.com/cython/cython/issues/3794#issuecomment-682431859",
            "id": 682431859,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3794",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY4MjQzMTg1OQ==",
            "performed_via_github_app": null,
            "updated_at": "2020-08-28T09:39:57Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/682431859",
            "user": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/69713762?v=4",
                "events_url": "https://api.github.com/users/nekokatt/events{/privacy}",
                "followers_url": "https://api.github.com/users/nekokatt/followers",
                "following_url": "https://api.github.com/users/nekokatt/following{/other_user}",
                "gists_url": "https://api.github.com/users/nekokatt/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nekokatt",
                "id": 69713762,
                "login": "nekokatt",
                "node_id": "MDQ6VXNlcjY5NzEzNzYy",
                "organizations_url": "https://api.github.com/users/nekokatt/orgs",
                "received_events_url": "https://api.github.com/users/nekokatt/received_events",
                "repos_url": "https://api.github.com/users/nekokatt/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nekokatt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nekokatt/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nekokatt"
            }
        },
        {
            "author_association": "COLLABORATOR",
            "body": "Duplicate of https://github.com/cython/cython/issues/3537\r\n\r\nLooks like we don't support it at the moment. Obviously if you get anywhere with your investigations the a PR (or further details) would be welcome.",
            "created_at": "2020-08-28T11:36:36Z",
            "html_url": "https://github.com/cython/cython/issues/3794#issuecomment-682477277",
            "id": 682477277,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3794",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY4MjQ3NzI3Nw==",
            "performed_via_github_app": null,
            "updated_at": "2020-08-28T11:36:36Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/682477277",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3794/comments",
    "created_at": "2020-08-28T09:00:14Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-08-28T11:36:37Z",
            "event": "closed",
            "id": 3703546235,
            "node_id": "MDExOkNsb3NlZEV2ZW50MzcwMzU0NjIzNQ==",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/3703546235"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-08-28T11:37:12Z",
            "event": "labeled",
            "id": 3703548151,
            "label": {
                "color": "444444",
                "name": "R: duplicate"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDM3MDM1NDgxNTE=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/3703548151"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3794/events",
    "html_url": "https://github.com/cython/cython/issues/3794",
    "id": 687924259,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425556894,
            "name": "R: duplicate",
            "node_id": "MDU6TGFiZWw0MjU1NTY4OTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/R:%20duplicate"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3794/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU2ODc5MjQyNTk=",
    "number": 3794,
    "performed_via_github_app": null,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "Initializing a typing.Dict subclass leads to runtime errors.",
    "updated_at": "2020-08-28T11:37:12Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3794",
    "user": {
        "avatar_url": "https://avatars3.githubusercontent.com/u/69713762?v=4",
        "events_url": "https://api.github.com/users/nekokatt/events{/privacy}",
        "followers_url": "https://api.github.com/users/nekokatt/followers",
        "following_url": "https://api.github.com/users/nekokatt/following{/other_user}",
        "gists_url": "https://api.github.com/users/nekokatt/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/nekokatt",
        "id": 69713762,
        "login": "nekokatt",
        "node_id": "MDQ6VXNlcjY5NzEzNzYy",
        "organizations_url": "https://api.github.com/users/nekokatt/orgs",
        "received_events_url": "https://api.github.com/users/nekokatt/received_events",
        "repos_url": "https://api.github.com/users/nekokatt/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/nekokatt/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/nekokatt/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/nekokatt"
    }
}