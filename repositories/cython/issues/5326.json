{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Is your feature request related to a problem? Please describe.\r\n\r\nWe should have a way to show additional performance hints in the annotated HTML file.\r\n\r\nIt sometimes happens that Cython detects potentially sub-optimal code, e.g. exception checks in nogil code or costly array bounds checks, and could notify users about them. We already point users to the annotated HTML file for performance inspection, so that seems a good place to add such hints.\r\n\r\n### Describe the solution you'd like.\r\n\r\nWe could add additional colour markers and/or mouse-over hints, or show the hints above the unfolded C code block. Or have a separate side-area (code lines are usually short compared to the screen width) that shows the hints when clicking on or hovering over a code line.\r\n\r\nWe could also mark certain C-API calls and utility functions as particularly slow (e.g. `__Pyx_ErrOccurredWithGIL`) and add a shade of red to the line colour if they are found.\r\n\r\n### Describe alternatives you've considered.\r\n\r\nWe could add performance warnings, but many projects regard compiler warnings as something bad and enable `-Werror` and the like to prevent them from sneaking in. That makes performance warnings somewhat annoying since they are not always important and not always worth changing working code. They hint at potential optimisations, not necessarily bugs.\r\n\r\n### Additional context\r\n\r\nThis came up while discussing https://github.com/cython/cython/issues/5324, where missing `noexcept` markers in internal Cython utility code lead to a major performance regression in memoryview code. Users will probably run into similar issues on their side.",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "As a short-term solution I've documented the specific performance pitfall that led to this in #5327.\r\n\r\nI agree that html annotations would be a nice way to present this kind of stuff.\r\n\r\nAnother option (which is potentially in addition to HTML hints rather than instead of them) is to add a separate category of message for performance hints which wouldn't get hit by `-Werror`. I imagine the same text would be produced in both cases.\r\n\r\nLike you, I think we should keep \"real\" warnings manageable for people that want to use `-Werror`",
            "created_at": "2023-03-20T20:48:34Z",
            "html_url": "https://github.com/cython/cython/issues/5326#issuecomment-1476914360",
            "id": 1476914360,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5326",
            "node_id": "IC_kwDOABDGAc5YB-y4",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1476914360/reactions"
            },
            "updated_at": "2023-03-20T20:48:34Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1476914360",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5326/comments",
    "created_at": "2023-03-20T09:20:57Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-03-20T09:20:57Z",
            "event": "labeled",
            "id": 8792062062,
            "label": {
                "color": "c2e0c6",
                "name": "feature"
            },
            "node_id": "LE_lADOABDGAc5hQdKezwAAAAIMDDhu",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8792062062"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-03-20T09:20:57Z",
            "event": "labeled",
            "id": 8792062069,
            "label": {
                "color": "444444",
                "name": "Error Reporting"
            },
            "node_id": "LE_lADOABDGAc5hQdKezwAAAAIMDDh1",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8792062069"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5326/events",
    "html_url": "https://github.com/cython/cython/issues/5326",
    "id": 1631703710,
    "labels": [
        {
            "color": "c2e0c6",
            "default": false,
            "description": null,
            "id": 414805463,
            "name": "feature",
            "node_id": "MDU6TGFiZWw0MTQ4MDU0NjM=",
            "url": "https://api.github.com/repos/cython/cython/labels/feature"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425557478,
            "name": "Error Reporting",
            "node_id": "MDU6TGFiZWw0MjU1NTc0Nzg=",
            "url": "https://api.github.com/repos/cython/cython/labels/Error%20Reporting"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5326/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5hQdKe",
    "number": 5326,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5326/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5326/timeline",
    "title": "[ENH] Show performance hints in HTML annotations",
    "updated_at": "2023-03-20T20:48:34Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5326",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
        "events_url": "https://api.github.com/users/scoder/events{/privacy}",
        "followers_url": "https://api.github.com/users/scoder/followers",
        "following_url": "https://api.github.com/users/scoder/following{/other_user}",
        "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/scoder",
        "id": 491659,
        "login": "scoder",
        "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
        "organizations_url": "https://api.github.com/users/scoder/orgs",
        "received_events_url": "https://api.github.com/users/scoder/received_events",
        "repos_url": "https://api.github.com/users/scoder/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/scoder"
    }
}