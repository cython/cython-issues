{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "In https://github.com/scipy/scipy/issues/12489 I report errors raised whilst trying to run scipy after building with:\r\n\r\nmacOS 10.15.5\r\nPython 3.8.3\r\nnumpy 1.19.0\r\ncython 0.29.20\r\n\r\nI get the following stacktrace upon import:\r\n\r\n```\r\n>>> import scipy.optimize as sciopt\r\nsciopt.Traceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/andrew/miniconda3/envs/dev3/lib/python3.8/site-packages/scipy/optimize/__init__.py\", line 387, in <module>\r\n    from .optimize import *\r\n  File \"/Users/andrew/miniconda3/envs/dev3/lib/python3.8/site-packages/scipy/optimize/optimize.py\", line 33, in <module>\r\n    from .linesearch import (line_search_wolfe1, line_search_wolfe2,\r\n  File \"/Users/andrew/miniconda3/envs/dev3/lib/python3.8/site-packages/scipy/optimize/linesearch.py\", line 16, in <module>\r\n    from scipy.optimize import minpack2\r\nImportError: dlopen(/Users/andrew/miniconda3/envs/dev3/lib/python3.8/site-packages/scipy/optimize/minpack2.cpython-38-darwin.so, 2): Symbol not found: _Py_SET_TYPE\r\n  Referenced from: /Users/andrew/miniconda3/envs/dev3/lib/python3.8/site-packages/scipy/optimize/minpack2.cpython-38-darwin.so\r\n  Expected in: flat namespace\r\n in /Users/andrew/miniconda3/envs/dev3/lib/python3.8/site-packages/scipy/optimize/minpack2.cpython-38-darwin.so\r\n```\r\n\r\nThe same import works when I use cython 0.29.18 to build scipy. I'm guessing this may be a cython issue, so reporting here.",
    "closed_at": "2020-08-10T09:41:16Z",
    "comment_data": [
        {
            "author_association": "COLLABORATOR",
            "body": "As far as I can tell Cython doesn't (and has never) contained the symbol `_Py_SET_TYPE`.\r\n\r\nIt was added to CPython fairly recently https://github.com/python/cpython/commit/d2ec81a8c99796b51fb8c49b77a7fe369863226f#diff-dab5801649f1809dca3b570bd3a86f05 and looks to appear in the upcoming version 3.9. Therefore I wouldn't expect it to appear in a Python 3.8 module at all.\r\n\r\nIs it possible that you're somehow accidently including some Python 3.9 headers installed somewhere in your PC while compiling your module? I'm not sure how the Cython version you have installed should affect this though.",
            "created_at": "2020-07-21T05:46:40Z",
            "html_url": "https://github.com/cython/cython/issues/3748#issuecomment-661647544",
            "id": 661647544,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3748",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2MTY0NzU0NA==",
            "performed_via_github_app": null,
            "updated_at": "2020-07-21T05:46:40Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/661647544",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "NONE",
            "body": "No 3.9 headers on my Mac. But I am using miniconda env python I wonder if that has anything to do with it.",
            "created_at": "2020-07-21T06:05:43Z",
            "html_url": "https://github.com/cython/cython/issues/3748#issuecomment-661654009",
            "id": 661654009,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3748",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2MTY1NDAwOQ==",
            "performed_via_github_app": null,
            "updated_at": "2020-07-21T06:05:43Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/661654009",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/702934?v=4",
                "events_url": "https://api.github.com/users/andyfaff/events{/privacy}",
                "followers_url": "https://api.github.com/users/andyfaff/followers",
                "following_url": "https://api.github.com/users/andyfaff/following{/other_user}",
                "gists_url": "https://api.github.com/users/andyfaff/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andyfaff",
                "id": 702934,
                "login": "andyfaff",
                "node_id": "MDQ6VXNlcjcwMjkzNA==",
                "organizations_url": "https://api.github.com/users/andyfaff/orgs",
                "received_events_url": "https://api.github.com/users/andyfaff/received_events",
                "repos_url": "https://api.github.com/users/andyfaff/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andyfaff/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andyfaff/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andyfaff"
            }
        },
        {
            "author_association": "NONE",
            "body": "I think the issue is due to doing a:\r\n\r\n```\r\npython setup.py build\r\npip install .\r\n```\r\n\r\nInstead of a straightforward:\r\n```\r\npip install .\r\n```\r\n\r\nI think the former builds against the installed version of (a newer) numpy, whereas the latter builds against a pinned numpy version. So I think that there are symbols that don't get defined correctly with the former.",
            "created_at": "2020-08-10T09:41:16Z",
            "html_url": "https://github.com/cython/cython/issues/3748#issuecomment-671258536",
            "id": 671258536,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3748",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTI1ODUzNg==",
            "performed_via_github_app": null,
            "updated_at": "2020-08-10T09:41:16Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/671258536",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/702934?v=4",
                "events_url": "https://api.github.com/users/andyfaff/events{/privacy}",
                "followers_url": "https://api.github.com/users/andyfaff/followers",
                "following_url": "https://api.github.com/users/andyfaff/following{/other_user}",
                "gists_url": "https://api.github.com/users/andyfaff/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andyfaff",
                "id": 702934,
                "login": "andyfaff",
                "node_id": "MDQ6VXNlcjcwMjkzNA==",
                "organizations_url": "https://api.github.com/users/andyfaff/orgs",
                "received_events_url": "https://api.github.com/users/andyfaff/received_events",
                "repos_url": "https://api.github.com/users/andyfaff/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andyfaff/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andyfaff/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andyfaff"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3748/comments",
    "created_at": "2020-07-20T22:35:27Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/702934?v=4",
                "events_url": "https://api.github.com/users/andyfaff/events{/privacy}",
                "followers_url": "https://api.github.com/users/andyfaff/followers",
                "following_url": "https://api.github.com/users/andyfaff/following{/other_user}",
                "gists_url": "https://api.github.com/users/andyfaff/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/andyfaff",
                "id": 702934,
                "login": "andyfaff",
                "node_id": "MDQ6VXNlcjcwMjkzNA==",
                "organizations_url": "https://api.github.com/users/andyfaff/orgs",
                "received_events_url": "https://api.github.com/users/andyfaff/received_events",
                "repos_url": "https://api.github.com/users/andyfaff/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/andyfaff/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/andyfaff/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/andyfaff"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-08-10T09:41:16Z",
            "event": "closed",
            "id": 3637989663,
            "node_id": "MDExOkNsb3NlZEV2ZW50MzYzNzk4OTY2Mw==",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/3637989663"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3748/events",
    "html_url": "https://github.com/cython/cython/issues/3748",
    "id": 662334907,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3748/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU2NjIzMzQ5MDc=",
    "number": 3748,
    "performed_via_github_app": null,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "Symbol not found: Py_SET_TYPE",
    "updated_at": "2020-08-10T09:41:16Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3748",
    "user": {
        "avatar_url": "https://avatars2.githubusercontent.com/u/702934?v=4",
        "events_url": "https://api.github.com/users/andyfaff/events{/privacy}",
        "followers_url": "https://api.github.com/users/andyfaff/followers",
        "following_url": "https://api.github.com/users/andyfaff/following{/other_user}",
        "gists_url": "https://api.github.com/users/andyfaff/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/andyfaff",
        "id": 702934,
        "login": "andyfaff",
        "node_id": "MDQ6VXNlcjcwMjkzNA==",
        "organizations_url": "https://api.github.com/users/andyfaff/orgs",
        "received_events_url": "https://api.github.com/users/andyfaff/received_events",
        "repos_url": "https://api.github.com/users/andyfaff/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/andyfaff/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/andyfaff/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/andyfaff"
    }
}