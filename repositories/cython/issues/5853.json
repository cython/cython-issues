{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\r\n\r\nenum.IntEnum objects are incompatible with `int` builtin type hint in Cython, but mypy and Python do not complain. See the code below.\r\n\r\n### Code to reproduce the behaviour:\r\n\r\nFirst define a new subclass of IntEnum and one helper function depending on it. The minimal example below seems silly but it's greatly simplified code from dnspython library where it makes more sense.\r\n\r\n```cython\r\nimport enum\r\n\r\nclass RdataClass(enum.IntEnum):\r\n    IN = 1\r\n    CH = 3\r\n\r\n# please note that enum.IntEnum inherits from the builtin int type\r\ndef to_text(value: int) -> str:\r\n    return RdataClass(value).name\r\n```\r\n\r\nUse this module:\r\n```\r\nimport rdataclass\r\nprint(rdataclass.to_text(dns.rdataclass.RdataClass.IN))\r\n```\r\n\r\nCython throws an exception:\r\n```\r\nTypeError: Argument 'value' has incorrect type (expected int, got RdataClass)\r\n```\r\n\r\n### Expected behaviour\r\n```\r\n'IN'\r\n```\r\n\r\n### OS\r\n\r\nLinux\r\n\r\n### Python version\r\n\r\n3.11.5\r\n\r\n### Cython version\r\n\r\n3.0.5\r\n\r\n### Additional context\r\n\r\nmypy 1.3.0 does not complain about this code",
    "closed_at": "2023-11-21T08:31:49Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "This applies to typing in Cython in general. Static typing makes no sense if you allow subtypes, because subtypes can override arbitrary behaviour of the type. So, Cython does not allow subtypes (or similar types) in order to make use of the types for optimisation purposes.",
            "created_at": "2023-11-20T14:47:42Z",
            "html_url": "https://github.com/cython/cython/issues/5853#issuecomment-1819206035",
            "id": 1819206035,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5853",
            "node_id": "IC_kwDOABDGAc5sbuGT",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1819206035/reactions"
            },
            "updated_at": "2023-11-20T14:47:42Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1819206035",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "I might be missing something, but \"Cython does not allow subtypes (or similar types) in order to make use of the types for optimisation purposes.\" sounds like a statement that cython would prevent optimization if subtypes are involved.  In this case, the type checker is outright failing, which is not the same thing.",
            "created_at": "2023-11-20T19:02:46Z",
            "html_url": "https://github.com/cython/cython/issues/5853#issuecomment-1819638918",
            "id": 1819638918,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5853",
            "node_id": "IC_kwDOABDGAc5sdXyG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1819638918/reactions"
            },
            "updated_at": "2023-11-20T19:02:46Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1819638918",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14351114?v=4",
                "events_url": "https://api.github.com/users/bwelling/events{/privacy}",
                "followers_url": "https://api.github.com/users/bwelling/followers",
                "following_url": "https://api.github.com/users/bwelling/following{/other_user}",
                "gists_url": "https://api.github.com/users/bwelling/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bwelling",
                "id": 14351114,
                "login": "bwelling",
                "node_id": "MDQ6VXNlcjE0MzUxMTE0",
                "organizations_url": "https://api.github.com/users/bwelling/orgs",
                "received_events_url": "https://api.github.com/users/bwelling/received_events",
                "repos_url": "https://api.github.com/users/bwelling/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bwelling/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bwelling/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bwelling"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "So Cython has long interpreted the old style syntax of\r\n\r\n```\r\ncdef f(list x):\r\n   ...\r\n```\r\n\r\nas \"exact list\" and generated code that *requires* an exact list. Because actually nothing else is useful to us - a list subclass has to be treated as a plain object.\r\n\r\nWhen we decided to support annotations we followed the same rules, even though it puts us shortly out of sync with the described Python rules.\r\n\r\nBasically Cython isn't viewing itself as a type-checker - it's viewing itself as a way of generating optimised code. We don't want to have to generate multiple paths based on the actual types so it suits Cython's goals to be strict.\r\n\r\nIf you don't want Cython to follow its annotation rules then you can use `cython.annotation_typing(False)` and it'll behave like Python and accept any object. You can apply this compiler directive as locally or as globally as you like.\r\n\r\n(For completeness, the one exception to this \"no subclassess rule is `cdef classes`, since they're generated in a way that we can make subclassess quick)",
            "created_at": "2023-11-20T19:13:48Z",
            "html_url": "https://github.com/cython/cython/issues/5853#issuecomment-1819653044",
            "id": 1819653044,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5853",
            "node_id": "IC_kwDOABDGAc5sdbO0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1819653044/reactions"
            },
            "updated_at": "2023-11-20T19:13:48Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1819653044",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thank you for explanation. I think this can be closed.",
            "created_at": "2023-11-21T08:28:13Z",
            "html_url": "https://github.com/cython/cython/issues/5853#issuecomment-1820447339",
            "id": 1820447339,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5853",
            "node_id": "IC_kwDOABDGAc5sgdJr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1820447339/reactions"
            },
            "updated_at": "2023-11-21T08:28:13Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1820447339",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11509590?v=4",
                "events_url": "https://api.github.com/users/pspacek/events{/privacy}",
                "followers_url": "https://api.github.com/users/pspacek/followers",
                "following_url": "https://api.github.com/users/pspacek/following{/other_user}",
                "gists_url": "https://api.github.com/users/pspacek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pspacek",
                "id": 11509590,
                "login": "pspacek",
                "node_id": "MDQ6VXNlcjExNTA5NTkw",
                "organizations_url": "https://api.github.com/users/pspacek/orgs",
                "received_events_url": "https://api.github.com/users/pspacek/received_events",
                "repos_url": "https://api.github.com/users/pspacek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pspacek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pspacek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pspacek"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5853/comments",
    "created_at": "2023-11-20T14:29:49Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-11-21T08:31:46Z",
            "event": "labeled",
            "id": 11021027486,
            "label": {
                "color": "444444",
                "name": "R: wontfix"
            },
            "node_id": "LE_lADOABDGAc53WSvPzwAAAAKQ54ie",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11021027486"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-11-21T08:31:50Z",
            "event": "closed",
            "id": 11021028055,
            "node_id": "CE_lADOABDGAc53WSvPzwAAAAKQ54rX",
            "performed_via_github_app": null,
            "state_reason": "not_planned",
            "url": "https://api.github.com/repos/cython/cython/issues/events/11021028055"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5853/events",
    "html_url": "https://github.com/cython/cython/issues/5853",
    "id": 2002332623,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425557400,
            "name": "R: wontfix",
            "node_id": "MDU6TGFiZWw0MjU1NTc0MDA=",
            "url": "https://api.github.com/repos/cython/cython/labels/R:%20wontfix"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5853/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc53WSvP",
    "number": 5853,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5853/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5853/timeline",
    "title": "[BUG] enum.IntEnum objects are incompatible with `int` builtin type hint",
    "updated_at": "2023-11-21T08:31:50Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5853",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11509590?v=4",
        "events_url": "https://api.github.com/users/pspacek/events{/privacy}",
        "followers_url": "https://api.github.com/users/pspacek/followers",
        "following_url": "https://api.github.com/users/pspacek/following{/other_user}",
        "gists_url": "https://api.github.com/users/pspacek/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/pspacek",
        "id": 11509590,
        "login": "pspacek",
        "node_id": "MDQ6VXNlcjExNTA5NTkw",
        "organizations_url": "https://api.github.com/users/pspacek/orgs",
        "received_events_url": "https://api.github.com/users/pspacek/received_events",
        "repos_url": "https://api.github.com/users/pspacek/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/pspacek/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pspacek/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/pspacek"
    }
}