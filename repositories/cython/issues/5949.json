{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Is your feature request related to a problem? Please describe.\r\n\r\nWhile working on [reproducible builds](https://reproducible-builds.org/) for [openSUSE](https://en.opensuse.org/openSUSE:Reproducible_Builds), I found that \r\nour `python-frozenlist` and `python-yarl` packages vary in every build, because\r\nhttps://github.com/aio-libs/yarl/blob/8ba2714/packaging/pep517_backend/_backend.py#L199\r\npasses a random tmp path to Cython-3.0.8\r\nand Cython embeds that in the produced `.so` files.\r\n\r\n### Describe the solution you'd like.\r\n\r\nCython could use gcc's `-ffile-prefix-map=` option (where available) to normalize these path-names.\r\n\r\n### Describe alternatives you've considered.\r\n\r\nCython could omit path names from output objects altogether, but debuginfo might still be affected from random path names.\r\n\r\n### Additional context\r\n\r\n_No response_",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "> passes a random tmp path to Cython-3.0.8\n\nClarification: it doesn't *pass* the path but creates a temporary directory, copies the project there and does chdir before invoking Cython.",
            "created_at": "2024-01-16T13:38:16Z",
            "html_url": "https://github.com/cython/cython/issues/5949#issuecomment-1893760930",
            "id": 1893760930,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5949",
            "node_id": "IC_kwDOABDGAc5w4H-i",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1893760930/reactions"
            },
            "updated_at": "2024-01-16T13:38:24Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1893760930",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/578543?v=4",
                "events_url": "https://api.github.com/users/webknjaz/events{/privacy}",
                "followers_url": "https://api.github.com/users/webknjaz/followers",
                "following_url": "https://api.github.com/users/webknjaz/following{/other_user}",
                "gists_url": "https://api.github.com/users/webknjaz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/webknjaz",
                "id": 578543,
                "login": "webknjaz",
                "node_id": "MDQ6VXNlcjU3ODU0Mw==",
                "organizations_url": "https://api.github.com/users/webknjaz/orgs",
                "received_events_url": "https://api.github.com/users/webknjaz/received_events",
                "repos_url": "https://api.github.com/users/webknjaz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/webknjaz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/webknjaz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/webknjaz"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@bmwiedemann could you update `master` to a commit hash in the link so it doesn't break if refactored?",
            "created_at": "2024-01-16T13:39:38Z",
            "html_url": "https://github.com/cython/cython/issues/5949#issuecomment-1893763296",
            "id": 1893763296,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5949",
            "node_id": "IC_kwDOABDGAc5w4Ijg",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1893763296/reactions"
            },
            "updated_at": "2024-01-16T13:39:38Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1893763296",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/578543?v=4",
                "events_url": "https://api.github.com/users/webknjaz/events{/privacy}",
                "followers_url": "https://api.github.com/users/webknjaz/followers",
                "following_url": "https://api.github.com/users/webknjaz/following{/other_user}",
                "gists_url": "https://api.github.com/users/webknjaz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/webknjaz",
                "id": 578543,
                "login": "webknjaz",
                "node_id": "MDQ6VXNlcjU3ODU0Mw==",
                "organizations_url": "https://api.github.com/users/webknjaz/orgs",
                "received_events_url": "https://api.github.com/users/webknjaz/received_events",
                "repos_url": "https://api.github.com/users/webknjaz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/webknjaz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/webknjaz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/webknjaz"
            }
        },
        {
            "author_association": "NONE",
            "body": "I think it's a little subtler than that; somewhere in the `Cython/Compiler` directory, there is code which creates the names of variables in the generated C++ code.  Somehow, the absolute filename path is embedded in some of the created variables.  A solution to this problem would be to have something like an environment variable `CYTHON_PROJECT_ROOT`, and if this this set to a path, this part of the generated name would be changed to `projectroot`, or perhaps there would also have to be a second environment variable `CYTHON_PROJECT_NAME`, and then the root path would instead be changed to, say, `<project>_root` or `root_<project>`.  But I don't know exactly where the pathname is picked up for naming the variables, so I can't propose a PR at this point.",
            "created_at": "2024-03-06T07:08:56Z",
            "html_url": "https://github.com/cython/cython/issues/5949#issuecomment-1980220867",
            "id": 1980220867,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5949",
            "node_id": "IC_kwDOABDGAc52B8XD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1980220867/reactions"
            },
            "updated_at": "2024-03-06T07:08:56Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1980220867",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1658936?v=4",
                "events_url": "https://api.github.com/users/juliangilbey/events{/privacy}",
                "followers_url": "https://api.github.com/users/juliangilbey/followers",
                "following_url": "https://api.github.com/users/juliangilbey/following{/other_user}",
                "gists_url": "https://api.github.com/users/juliangilbey/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/juliangilbey",
                "id": 1658936,
                "login": "juliangilbey",
                "node_id": "MDQ6VXNlcjE2NTg5MzY=",
                "organizations_url": "https://api.github.com/users/juliangilbey/orgs",
                "received_events_url": "https://api.github.com/users/juliangilbey/received_events",
                "repos_url": "https://api.github.com/users/juliangilbey/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/juliangilbey/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/juliangilbey/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/juliangilbey"
            }
        },
        {
            "author_association": "NONE",
            "body": "A little more on this.  Looking at the results of compiling [RapidFuzz](https://github.com/rapidfuzz/RapidFuzz), I see the following:\r\n* The line `include \"fuzz_cpp.pyx\"` in `fuzz_cpp_avx2.cxx` gives rise to these lines of code in the resulting `.cxx` file:\r\n```c++\r\nstatic const char __pyx_k_home_jdg_debian_spyder_packages[] = \"/home/jdg/debian/spyder-packages/rapidfuzz/build-area/rapidfuzz-3.6.2+ds/src/rapidfuzz/fuzz_cpp.pyx\";\r\n  PyObject *__pyx_kp_s_home_jdg_debian_spyder_packages;\r\n  Py_CLEAR(clear_module_state->__pyx_kp_s_home_jdg_debian_spyder_packages);\r\n  Py_VISIT(traverse_module_state->__pyx_kp_s_home_jdg_debian_spyder_packages);\r\n#define __pyx_kp_s_home_jdg_debian_spyder_packages __pyx_mstate_global->__pyx_kp_s_home_jdg_debian_spyder_packages\r\n...\r\n```\r\nand several more. \r\n\r\n`fuzz_cpp.pyx` itself, without an include line, gives rise to very similar lines.\r\n\r\nSo there are two places where the path is embedded in the resulting C++ files: it is in the variable names, and it is in the value of the constant string `__pyx_k_<truncated_filepath>[]`.",
            "created_at": "2024-03-06T09:55:44Z",
            "html_url": "https://github.com/cython/cython/issues/5949#issuecomment-1980489932",
            "id": 1980489932,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5949",
            "node_id": "IC_kwDOABDGAc52C-DM",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1980489932/reactions"
            },
            "updated_at": "2024-03-06T09:55:44Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1980489932",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1658936?v=4",
                "events_url": "https://api.github.com/users/juliangilbey/events{/privacy}",
                "followers_url": "https://api.github.com/users/juliangilbey/followers",
                "following_url": "https://api.github.com/users/juliangilbey/following{/other_user}",
                "gists_url": "https://api.github.com/users/juliangilbey/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/juliangilbey",
                "id": 1658936,
                "login": "juliangilbey",
                "node_id": "MDQ6VXNlcjE2NTg5MzY=",
                "organizations_url": "https://api.github.com/users/juliangilbey/orgs",
                "received_events_url": "https://api.github.com/users/juliangilbey/received_events",
                "repos_url": "https://api.github.com/users/juliangilbey/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/juliangilbey/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/juliangilbey/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/juliangilbey"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5949/comments",
    "created_at": "2024-01-16T13:24:59Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/637990?v=4",
                "events_url": "https://api.github.com/users/bmwiedemann/events{/privacy}",
                "followers_url": "https://api.github.com/users/bmwiedemann/followers",
                "following_url": "https://api.github.com/users/bmwiedemann/following{/other_user}",
                "gists_url": "https://api.github.com/users/bmwiedemann/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bmwiedemann",
                "id": 637990,
                "login": "bmwiedemann",
                "node_id": "MDQ6VXNlcjYzNzk5MA==",
                "organizations_url": "https://api.github.com/users/bmwiedemann/orgs",
                "received_events_url": "https://api.github.com/users/bmwiedemann/received_events",
                "repos_url": "https://api.github.com/users/bmwiedemann/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bmwiedemann/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bmwiedemann/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bmwiedemann"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-16T13:39:38Z",
            "event": "mentioned",
            "id": 11499055495,
            "node_id": "MEE_lADOABDGAc58Nr0EzwAAAAKtZamH",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11499055495"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/637990?v=4",
                "events_url": "https://api.github.com/users/bmwiedemann/events{/privacy}",
                "followers_url": "https://api.github.com/users/bmwiedemann/followers",
                "following_url": "https://api.github.com/users/bmwiedemann/following{/other_user}",
                "gists_url": "https://api.github.com/users/bmwiedemann/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bmwiedemann",
                "id": 637990,
                "login": "bmwiedemann",
                "node_id": "MDQ6VXNlcjYzNzk5MA==",
                "organizations_url": "https://api.github.com/users/bmwiedemann/orgs",
                "received_events_url": "https://api.github.com/users/bmwiedemann/received_events",
                "repos_url": "https://api.github.com/users/bmwiedemann/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bmwiedemann/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bmwiedemann/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bmwiedemann"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-01-16T13:39:38Z",
            "event": "subscribed",
            "id": 11499055511,
            "node_id": "SE_lADOABDGAc58Nr0EzwAAAAKtZamX",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/11499055511"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5949/events",
    "html_url": "https://github.com/cython/cython/issues/5949",
    "id": 2083962116,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5949/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc58Nr0E",
    "number": 5949,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5949/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5949/timeline",
    "title": "[ENH] normalize build path",
    "updated_at": "2024-03-06T09:55:45Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5949",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/637990?v=4",
        "events_url": "https://api.github.com/users/bmwiedemann/events{/privacy}",
        "followers_url": "https://api.github.com/users/bmwiedemann/followers",
        "following_url": "https://api.github.com/users/bmwiedemann/following{/other_user}",
        "gists_url": "https://api.github.com/users/bmwiedemann/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/bmwiedemann",
        "id": 637990,
        "login": "bmwiedemann",
        "node_id": "MDQ6VXNlcjYzNzk5MA==",
        "organizations_url": "https://api.github.com/users/bmwiedemann/orgs",
        "received_events_url": "https://api.github.com/users/bmwiedemann/received_events",
        "repos_url": "https://api.github.com/users/bmwiedemann/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/bmwiedemann/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bmwiedemann/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/bmwiedemann"
    }
}