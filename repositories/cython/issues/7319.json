{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\n`%%cython -a` magic in JupyterLab does not annotate with colours\n\n### Code to reproduce the behaviour:\n\nRun `%load_ext cython` in a cell, followed by:\n\n```py\n%%cython -a\n\nimport numpy as np\n\ndef foo(x):\n    return x * (x - 1)\n```\n\n<img width=\"777\" height=\"424\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c4f6bd70-dd5e-4d25-8463-018a461a209d\" />\n\n### Expected behaviour\n\nIt should display coloured annotation\n\n<img width=\"754\" height=\"249\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/afc14c62-d809-48ba-9f2b-917e54239edf\" />\n\n<img width=\"774\" height=\"241\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ee72daaf-e0fa-405f-b254-82f6500d2452\" />\n\n## Known workarounds\n\nI can get back the colours either by:\n- using `jupyter-nbclassic` (the old notebook frontend) instead of `jupyter-lab`\n- disabling the following CSS rule from browser's developer tools (see the commented out `background-color` directive:\n\n```css\n.jp-ThemedContainer .jp-RenderedHTMLCommon pre, .jp-ThemedContainer .jp-RenderedHTMLCommon code {\n\tborder: 0;\n\t/* background-color: var(--jp-layout-color0); */\n\tcolor: var(--jp-content-font-color1);\n\tfont-family: var(--jp-code-font-family);\n\tfont-size: inherit;\n\tline-height: var(--jp-code-line-height);\n\tpadding: 0;\n\twhite-space: pre-wrap;\n}\n```\n\n### OS\n\nLinux\n\n### Python version\n\n3.13.8\n\n### Cython version\n\n3.3.0a0\n\n### Additional context\n\n- jupyterlab, version: 4.4.10\n- nbclassic, version 1.3.3\n- browser: firefox, version 143.0.4\n\nOther unrelated incompatibilities with cython+jupyterlab has happened in the past (for ex. #1775). Let me know if this should be raised on JupyterLab's issue tracker instead.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "I think it's worth raising it on JupyterLab's issue tracker. The fact you can fix it by modifying their CSS suggests it should probably be fixed on their side.\n\nI'll leave this open for now though just because it's always possible there might be a better fix here",
            "created_at": "2025-11-12T20:28:04Z",
            "html_url": "https://github.com/cython/cython/issues/7319#issuecomment-3523778427",
            "id": 3523778427,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7319",
            "node_id": "IC_kwDOABDGAc7SCJd7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3523778427/reactions"
            },
            "updated_at": "2025-11-12T20:28:04Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3523778427",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/7319/comments",
    "created_at": "2025-11-12T10:38:30Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9155111?v=4",
                "events_url": "https://api.github.com/users/ashwinvis/events{/privacy}",
                "followers_url": "https://api.github.com/users/ashwinvis/followers",
                "following_url": "https://api.github.com/users/ashwinvis/following{/other_user}",
                "gists_url": "https://api.github.com/users/ashwinvis/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ashwinvis",
                "id": 9155111,
                "login": "ashwinvis",
                "node_id": "MDQ6VXNlcjkxNTUxMTE=",
                "organizations_url": "https://api.github.com/users/ashwinvis/orgs",
                "received_events_url": "https://api.github.com/users/ashwinvis/received_events",
                "repos_url": "https://api.github.com/users/ashwinvis/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ashwinvis/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ashwinvis/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ashwinvis",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-11-12T10:39:33Z",
            "event": "renamed",
            "id": 20885129203,
            "node_id": "RTE_lADOABDGAc7Xh2R2zwAAAATc2cfz",
            "performed_via_github_app": null,
            "rename": {
                "from": "[BUG]",
                "to": "[BUG] colours do not appear when `%%cython -a` is used in JupyterLab"
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/20885129203"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/7319/events",
    "html_url": "https://github.com/cython/cython/issues/7319",
    "id": 3615974518,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/7319/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc7Xh2R2",
    "number": 7319,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/7319/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/7319/timeline",
    "title": "[BUG] colours do not appear when `%%cython -a` is used in JupyterLab",
    "type": null,
    "updated_at": "2025-11-12T20:28:04Z",
    "url": "https://api.github.com/repos/cython/cython/issues/7319",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/9155111?v=4",
        "events_url": "https://api.github.com/users/ashwinvis/events{/privacy}",
        "followers_url": "https://api.github.com/users/ashwinvis/followers",
        "following_url": "https://api.github.com/users/ashwinvis/following{/other_user}",
        "gists_url": "https://api.github.com/users/ashwinvis/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ashwinvis",
        "id": 9155111,
        "login": "ashwinvis",
        "node_id": "MDQ6VXNlcjkxNTUxMTE=",
        "organizations_url": "https://api.github.com/users/ashwinvis/orgs",
        "received_events_url": "https://api.github.com/users/ashwinvis/received_events",
        "repos_url": "https://api.github.com/users/ashwinvis/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ashwinvis/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ashwinvis/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ashwinvis",
        "user_view_type": "public"
    }
}