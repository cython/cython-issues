{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nIt seems that Cython arrays do not report their size correctly.\n\nWhile this is not strictly a bug (the [spec](https://docs.python.org/3/library/sys.html) of `sys.getsizeof` indicates that extensions might not have `__sizeof__` implemented and thus report a wrong size), I believe this can almost qualify as one.\n\n\n\n\n### Code to reproduce the behaviour:\n\n\n```cython\nfrom cpython cimport array\nfrom cython.view cimport array as cvarray\nimport numpy as np\nimport sys\n\na = array.array('i', [0]*1000_000)\nb = cvarray(shape=(1000_000,), itemsize=sizeof(int), format=\"i\")\nc = np.empty([1000_1000], dtype=np.uint32)\n\nprint(sys.getsizeof(a), sys.getsizeof(b), sys.getsizeof(c))\n```\n\nReports `4000080 112 40004112`\n\n### Expected behaviour\n\nIt should report the size of the allocation when it owns it.\n\n### OS\n\n_No response_\n\n### Python version\n\n3.12\n\n### Cython version\n\n3.1.1\n\n### Additional context\n\nI found this issue while investigating a leak, printing the size of all objects the gc knows. It was surprised to not see the Cython arrays among the top items. In the end the leak turned out to be due to not enough gc collections.\n\nI use Cython arrays for my extensions rather than numpy arrays since I do not want to link to numpy.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "That does seem reasonable for owned arrays\n\nIt should be relatively easy to implement -  it's just defined as a `cdef class` in the Cython utility code https://github.com/cython/cython/blob/4b7cb2e7b0b8eb97863d1df01145b02fd3f90212/Cython/Utility/MemoryView.pyx#L112",
            "created_at": "2025-08-04T19:04:02Z",
            "html_url": "https://github.com/cython/cython/issues/7073#issuecomment-3152009938",
            "id": 3152009938,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/7073",
            "node_id": "IC_kwDOABDGAc6739rS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3152009938/reactions"
            },
            "updated_at": "2025-08-04T19:04:02Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3152009938",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/7073/comments",
    "created_at": "2025-08-04T11:57:46Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/7073/events",
    "html_url": "https://github.com/cython/cython/issues/7073",
    "id": 3289137114,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/7073/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc7EDD_a",
    "number": 7073,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/7073/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/7073/timeline",
    "title": "[BUG] Cython array reports wrong size",
    "type": null,
    "updated_at": "2025-08-04T19:04:03Z",
    "url": "https://api.github.com/repos/cython/cython/issues/7073",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/2546609?v=4",
        "events_url": "https://api.github.com/users/axeldavy/events{/privacy}",
        "followers_url": "https://api.github.com/users/axeldavy/followers",
        "following_url": "https://api.github.com/users/axeldavy/following{/other_user}",
        "gists_url": "https://api.github.com/users/axeldavy/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/axeldavy",
        "id": 2546609,
        "login": "axeldavy",
        "node_id": "MDQ6VXNlcjI1NDY2MDk=",
        "organizations_url": "https://api.github.com/users/axeldavy/orgs",
        "received_events_url": "https://api.github.com/users/axeldavy/received_events",
        "repos_url": "https://api.github.com/users/axeldavy/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/axeldavy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/axeldavy/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/axeldavy",
        "user_view_type": "public"
    }
}