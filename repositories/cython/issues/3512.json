{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "> You didn't say what kind of error you got, but I guess it's some kind of \"something isn't initialised or available\" error. The reason for that would be that you are calling `PyInit_some()` directly, which is not the right way to initialise an embedded module.\r\n> \r\n> Instead, call `PyImport_AppendInittab(\"some\", &PyInit_some)` before calling `Py_initialize()`.\r\n> \r\n> We should make that clear in the documentation. Currently, only the [CPython docs](https://docs.python.org/3/extending/embedding.html) mention it.\r\n\r\nNot any error messages\r\nI found some problems that I may describe\r\nIn fact, no function can run, such as print\r\ni modify the code:\r\ndllmain.c\r\n```C\r\n#include <Python.h>\r\n#include <Windows.h>\r\n#include \"some.h\"\r\n\r\nextern __declspec(dllexport) char*  __stdcall test() {\r\n    return _test();\r\n}\r\n\r\nBOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason,LPVOID lpReserved) {\r\n    switch( fdwReason ) {\r\n        case DLL_PROCESS_ATTACH:\r\n            PyImport_AppendInittab(\"some\", &PyInit_some) ;\r\n            Py_Initialize();\r\n            break;\r\n        case DLL_PROCESS_DETACH:\r\n            Py_Finalize();\r\n            break;\r\n    }\r\n    return TRUE;\r\n}\r\n```\r\nsome.pyx\r\n```python\r\ncdef public char* _test():\r\n    return \"ok return well\"\r\n```\r\nand write a c program to call it:\r\n```C\r\n#include \"stdio.h\"\r\n\r\nextern char* __stdcall test(void);\r\nint main(void){\r\n    printf(\"%s\",test());\r\n}\r\n```\r\nthe result is:\r\nD:\\msys64\\home\\songwz\\cytest\\diff_no>loaddll\r\nok return well\r\n\r\nbut i change the code:\r\n\r\nsome.pyx\r\n```python\r\ncdef public char* _test():\r\n    print(\"hello\")\r\n    return \"ok return well\"\r\n```\r\nHe will not return anything\r\nThe code below is the same\r\n```python\r\ndef hello():\r\n    pass\r\ncdef public char* _test():\r\n    hello()\r\n    return \"ok return well\"\r\n```\r\nBut the code below worksï¼š\r\n```python\r\ncdef hello():   #<-----cdef works\r\n    pass\r\ncdef public char* _test():\r\n    hello()\r\n    return \"ok return well\"\r\n```\r\n\r\n_Originally posted by @yafengabc in https://github.com/cython/cython/issues/3509#issuecomment-613237803_",
    "closed_at": "2020-04-14T05:57:52Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Let's keep this in context. I'll reply in the original ticket.",
            "created_at": "2020-04-14T05:57:52Z",
            "html_url": "https://github.com/cython/cython/issues/3512#issuecomment-613241489",
            "id": 613241489,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3512",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYxMzI0MTQ4OQ==",
            "updated_at": "2020-04-14T05:57:52Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/613241489",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3512/comments",
    "created_at": "2020-04-14T05:53:11Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/292905?v=4",
                "events_url": "https://api.github.com/users/yafengabc/events{/privacy}",
                "followers_url": "https://api.github.com/users/yafengabc/followers",
                "following_url": "https://api.github.com/users/yafengabc/following{/other_user}",
                "gists_url": "https://api.github.com/users/yafengabc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yafengabc",
                "id": 292905,
                "login": "yafengabc",
                "node_id": "MDQ6VXNlcjI5MjkwNQ==",
                "organizations_url": "https://api.github.com/users/yafengabc/orgs",
                "received_events_url": "https://api.github.com/users/yafengabc/received_events",
                "repos_url": "https://api.github.com/users/yafengabc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yafengabc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yafengabc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yafengabc"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-14T05:53:11Z",
            "event": "mentioned",
            "id": 3229576151,
            "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzIyOTU3NjE1MQ==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/3229576151"
        },
        {
            "actor": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/292905?v=4",
                "events_url": "https://api.github.com/users/yafengabc/events{/privacy}",
                "followers_url": "https://api.github.com/users/yafengabc/followers",
                "following_url": "https://api.github.com/users/yafengabc/following{/other_user}",
                "gists_url": "https://api.github.com/users/yafengabc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yafengabc",
                "id": 292905,
                "login": "yafengabc",
                "node_id": "MDQ6VXNlcjI5MjkwNQ==",
                "organizations_url": "https://api.github.com/users/yafengabc/orgs",
                "received_events_url": "https://api.github.com/users/yafengabc/received_events",
                "repos_url": "https://api.github.com/users/yafengabc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yafengabc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yafengabc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yafengabc"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-14T05:53:11Z",
            "event": "subscribed",
            "id": 3229576155,
            "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMyMjk1NzYxNTU=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/3229576155"
        },
        {
            "actor": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/292905?v=4",
                "events_url": "https://api.github.com/users/yafengabc/events{/privacy}",
                "followers_url": "https://api.github.com/users/yafengabc/followers",
                "following_url": "https://api.github.com/users/yafengabc/following{/other_user}",
                "gists_url": "https://api.github.com/users/yafengabc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yafengabc",
                "id": 292905,
                "login": "yafengabc",
                "node_id": "MDQ6VXNlcjI5MjkwNQ==",
                "organizations_url": "https://api.github.com/users/yafengabc/orgs",
                "received_events_url": "https://api.github.com/users/yafengabc/received_events",
                "repos_url": "https://api.github.com/users/yafengabc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yafengabc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yafengabc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yafengabc"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-14T05:54:37Z",
            "event": "renamed",
            "id": 3229579058,
            "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MzIyOTU3OTA1OA==",
            "rename": {
                "from": "> You didn't say what kind of error you got, but I guess it's some kind of \"something isn't initialised or available\" error. The reason for that would be that you are calling `PyInit_some()` directly, which is not the right way to initialise an embedded module.",
                "to": "Still having problems to complie to dll"
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/3229579058"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-04-14T05:57:53Z",
            "event": "closed",
            "id": 3229588647,
            "node_id": "MDExOkNsb3NlZEV2ZW50MzIyOTU4ODY0Nw==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/3229588647"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3512/events",
    "html_url": "https://github.com/cython/cython/issues/3512",
    "id": 599315008,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3512/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU1OTkzMTUwMDg=",
    "number": 3512,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "Still having problems to complie to dll",
    "updated_at": "2020-04-14T05:57:53Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3512",
    "user": {
        "avatar_url": "https://avatars3.githubusercontent.com/u/292905?v=4",
        "events_url": "https://api.github.com/users/yafengabc/events{/privacy}",
        "followers_url": "https://api.github.com/users/yafengabc/followers",
        "following_url": "https://api.github.com/users/yafengabc/following{/other_user}",
        "gists_url": "https://api.github.com/users/yafengabc/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/yafengabc",
        "id": 292905,
        "login": "yafengabc",
        "node_id": "MDQ6VXNlcjI5MjkwNQ==",
        "organizations_url": "https://api.github.com/users/yafengabc/orgs",
        "received_events_url": "https://api.github.com/users/yafengabc/received_events",
        "repos_url": "https://api.github.com/users/yafengabc/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/yafengabc/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yafengabc/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/yafengabc"
    }
}