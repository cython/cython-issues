{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Is your feature request related to a problem? Please describe.\n\nIt would be nice to see some different functions in the cython compiler modules being annotated to improve the workflow of code. One of the biggest problems I've had with adding in new features to the compiler has been the lack of typehint support. Since Python 2.7 is not supported anymore annotating these variables and checking the compiler code with mypy or other linters would improve the overall workflow as well as possibly optimizing the current compiler. \n\nOne of the reasons I ended my pull request with making [stubfile generator](https://github.com/cython/cython/pull/5744) was because of the fact that pyright and other linters would not tell me what variables certain Compiler Nodes were being carried around with it and to add to this deadly confusion the public pressure to get this in was not helping.\n\n### Describe the solution you'd like.\n\nAdding changes to the compiler as well as adding typehints or even Cython's typehints and annotating functions with what kinds of objects different nodes are carrying would help to improve the code as well as help newcomers contribute to cython and learn how the compiler ultimately works. \n\nHere I have an example of some cython code that would benefit from making these changes utlimately prevent the spread of spaghetti code.\n```python\n\n# for the sake of demonstration purposes Lets take a smaller function that might benefit from having readability\ndef check_c_declarations_pxd(module_node):\n    module_node.scope.check_c_classes_pxd()\n    return module_node\n\n# you'll notice one of the glaring problems with it would be that the module_node has not been properly annotated \n# And a tool such as mypy or pyright will not be able to tell you what kind of scope it's carrying. \n# This could become a problem for someone who might want to learn how the compiler works.\n# The way we could start fixing this code is by having MoudleNode annotated inside this function.\n\n# We can use double quotes around ModuleNode to define it if it's being defined later \ndef check_c_declarations_pxd(module_node: \"ModuleNode\") -> \"ModuleNode\":\n    # we could also annotate the scope variable in one of our nodes to figure out what kind of \n    # scope is being utilized to further verify if the scope can make this call or not\n    module_node.scope.check_c_classes_pxd()\n    return module_node\n```\nIn fact using cython's pure python approach on these could be beneficial when it comes to speeding up the compiler as well especially in the messier areas of the code.\n\n\n### Describe alternatives you've considered.\n\nFor now as an alternative approach I'm planning on generating stubfiles for many files such as the Symtab module to help me enhance the readability for linters to figure out what the code is doing. Incase this request gets rejected I can always make a separate pypi package for doing all of this so that maybe I could save some people a few burdens when contributing to this project.\n\n\n### Additional context\n\n_No response_",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "We do now have some annotations in Cython (but not many). We haven't wanted to encourage people to do enormous PRs adding annotations everywhere, but we're happy to add them as code is worked on. Perhaps we should speed some of that process up?\n\nPersonally I'm not a big believer in any annotation more complex that (e.g.) `list[int]` - I think the more complex ones rapidly become unreadable, and usually aren't even \"right\". With that said, most of what we do could be annotated quite simply.\n\nThe other thing that was mentioned last time - a lot of the typing in Cython is pretty implicit. e.g. `def visit_NameNode(self, node)` - the type of `node` here is hopefully obvious from the context. Similarly, variables called `env` are inevitably a `Scope` and `code` is inevitably a `Code` so typing these doesn't add a lot of extra information (although might help the IDE a little).",
            "created_at": "2025-05-13T07:51:23Z",
            "html_url": "https://github.com/cython/cython/issues/6866#issuecomment-2875422534",
            "id": 2875422534,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6866",
            "node_id": "IC_kwDOABDGAc6rY3dG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2875422534/reactions"
            },
            "updated_at": "2025-05-13T07:51:23Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2875422534",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "@da-woods Gald to see you guys are at least willing accept these ideas with open arms and I would be happy to work on it since I have a lot of time on hand. Before I get started I do have a question.\n\n> The other thing that was mentioned last time - a lot of the typing in Cython is pretty implicit. e.g. `def visit_NameNode(self, node)` - the type of `node` here is hopefully obvious from the context. Similarly, variables called `env` are inevitably a `Scope` and `code` is inevitably a `Code` so typing these doesn't add a lot of extra information (although might help the IDE a little).\n\nIs it possible for me to use `from __future__ import annotations` so that I can introduce pipe styled type unions to hopefully keep the code a bit cleaner since I know that one of your concerns is readability? \n\n\n",
            "created_at": "2025-05-13T17:41:32Z",
            "html_url": "https://github.com/cython/cython/issues/6866#issuecomment-2877437530",
            "id": 2877437530,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6866",
            "node_id": "IC_kwDOABDGAc6rgjZa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2877437530/reactions"
            },
            "updated_at": "2025-05-13T17:48:10Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2877437530",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/114684698?v=4",
                "events_url": "https://api.github.com/users/Vizonex/events{/privacy}",
                "followers_url": "https://api.github.com/users/Vizonex/followers",
                "following_url": "https://api.github.com/users/Vizonex/following{/other_user}",
                "gists_url": "https://api.github.com/users/Vizonex/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Vizonex",
                "id": 114684698,
                "login": "Vizonex",
                "node_id": "U_kgDOBtXzGg",
                "organizations_url": "https://api.github.com/users/Vizonex/orgs",
                "received_events_url": "https://api.github.com/users/Vizonex/received_events",
                "repos_url": "https://api.github.com/users/Vizonex/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Vizonex/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Vizonex/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Vizonex",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I have one point regarding the typing in Cython. I think that biggest drawback typing in Cython is that they are not checked in any way. I think that it will be easy to have typings wrong after some time. Unfortunately, typing verifiers like mypy requires to have large portion of code base typed which is kind of difficult in Cython. I am not sure whether there is an alternative to it viable for us...\n\n\n> Is it possible for me to use from __future__ import annotations\n\nMy humble opinion is that yes.",
            "created_at": "2025-05-13T19:32:15Z",
            "html_url": "https://github.com/cython/cython/issues/6866#issuecomment-2877715787",
            "id": 2877715787,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6866",
            "node_id": "IC_kwDOABDGAc6rhnVL",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2877715787/reactions"
            },
            "updated_at": "2025-05-13T19:32:25Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2877715787",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yes - agree with @matusvalo that unchecked type annotations risk becoming untrue. (And checked type annotations tend to force you to make code changes to fit with mypy)\n\nI'm also OK with the `__future__`. Although union types are about the point when I start to think \"this is getting noisy, just use duck-typing\". (Except for `x | None`, which is pretty clear)",
            "created_at": "2025-05-14T07:09:34Z",
            "html_url": "https://github.com/cython/cython/issues/6866#issuecomment-2878968997",
            "id": 2878968997,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6866",
            "node_id": "IC_kwDOABDGAc6rmZSl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2878968997/reactions"
            },
            "updated_at": "2025-05-14T07:09:34Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2878968997",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/6866/comments",
    "created_at": "2025-05-12T21:01:21Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/5534781?v=4",
                "events_url": "https://api.github.com/users/leofang/events{/privacy}",
                "followers_url": "https://api.github.com/users/leofang/followers",
                "following_url": "https://api.github.com/users/leofang/following{/other_user}",
                "gists_url": "https://api.github.com/users/leofang/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/leofang",
                "id": 5534781,
                "login": "leofang",
                "node_id": "MDQ6VXNlcjU1MzQ3ODE=",
                "organizations_url": "https://api.github.com/users/leofang/orgs",
                "received_events_url": "https://api.github.com/users/leofang/received_events",
                "repos_url": "https://api.github.com/users/leofang/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/leofang/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/leofang/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/leofang",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-05-13T00:34:25Z",
            "event": "subscribed",
            "id": 17626251162,
            "node_id": "SE_lADOABDGAc62R2KMzwAAAAQamz-a",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/17626251162"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-05-13T17:41:34Z",
            "event": "mentioned",
            "id": 17640067484,
            "node_id": "MEE_lADOABDGAc62R2KMzwAAAAQbbhGc",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/17640067484"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-05-13T17:41:34Z",
            "event": "subscribed",
            "id": 17640067499,
            "node_id": "SE_lADOABDGAc62R2KMzwAAAAQbbhGr",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/17640067499"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-05-14T07:09:36Z",
            "event": "mentioned",
            "id": 17647681837,
            "node_id": "MEE_lADOABDGAc62R2KMzwAAAAQb4kEt",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/17647681837"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/827060?v=4",
                "events_url": "https://api.github.com/users/matusvalo/events{/privacy}",
                "followers_url": "https://api.github.com/users/matusvalo/followers",
                "following_url": "https://api.github.com/users/matusvalo/following{/other_user}",
                "gists_url": "https://api.github.com/users/matusvalo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matusvalo",
                "id": 827060,
                "login": "matusvalo",
                "node_id": "MDQ6VXNlcjgyNzA2MA==",
                "organizations_url": "https://api.github.com/users/matusvalo/orgs",
                "received_events_url": "https://api.github.com/users/matusvalo/received_events",
                "repos_url": "https://api.github.com/users/matusvalo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matusvalo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matusvalo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matusvalo",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-05-14T07:09:36Z",
            "event": "subscribed",
            "id": 17647681850,
            "node_id": "SE_lADOABDGAc62R2KMzwAAAAQb4kE6",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/17647681850"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/6866/events",
    "html_url": "https://github.com/cython/cython/issues/6866",
    "id": 3058131596,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/6866/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc62R2KM",
    "number": 6866,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/6866/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/6866/timeline",
    "title": "Annotating Modules in the Cython Compiler Functions and Node Variables to help improve maintaining the code or adding new features to it.",
    "type": null,
    "updated_at": "2025-05-14T07:09:36Z",
    "url": "https://api.github.com/repos/cython/cython/issues/6866",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/114684698?v=4",
        "events_url": "https://api.github.com/users/Vizonex/events{/privacy}",
        "followers_url": "https://api.github.com/users/Vizonex/followers",
        "following_url": "https://api.github.com/users/Vizonex/following{/other_user}",
        "gists_url": "https://api.github.com/users/Vizonex/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Vizonex",
        "id": 114684698,
        "login": "Vizonex",
        "node_id": "U_kgDOBtXzGg",
        "organizations_url": "https://api.github.com/users/Vizonex/orgs",
        "received_events_url": "https://api.github.com/users/Vizonex/received_events",
        "repos_url": "https://api.github.com/users/Vizonex/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Vizonex/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Vizonex/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Vizonex",
        "user_view_type": "public"
    }
}