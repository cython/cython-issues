{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nHi there,\n\nI encountered a bug where my code had different behaviour on Windows and Linux, and managed to pinpoint the issue the function described below. Basically despite declaring uint32_t types, signed long arithmetic is used, which is incorrect (and leads to different results on Windows and Linux since the size of a long differs).\n\nThe code generated by the function `fast_rgba_from_color` described below uses for the division the following function:\n```\n/* ModInt[long] */\nstatic CYTHON_INLINE long __Pyx_div_long(long a, long b) {\n    long q = a / b;\n    long r = a - q*b;\n    q -= ((r != 0) & ((r ^ b) < 0));\n    return q;\n}\n```\n\nWriting the function input to a temporary uint32_t does not solve the issue, but writing to an uint64_t does solve it, as it uses the normal integer division in this case rather than `__Pyx_div_long`.\n\n### Code to reproduce the behaviour:\n\n```cython\nfrom libc.stdint cimport uint32_t\n\ncdef inline void fast_rgba_from_color(uint32_t *dst, uint32_t c) noexcept nogil:\n    dst[0] = c % 256\n    c = c // 256\n    dst[1] = c % 256\n    c = c // 256\n    dst[2] = c % 256\n    dst[3] = c // 256\n```\n\n\n### Expected behaviour\n\n`long` should not be used in the generated cython ever when specifying uint32 or uint64 or similar, as its size if not well defined.\nsigned division should not be used for unsigned arithmetic.\n\n\n\n### OS\n\nWindows\n\n### Python version\n\n3.12.8\n\n### Cython version\n\n3.0.11\n\n### Additional context\n\n_No response_",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/6635/comments",
    "created_at": "2025-01-28T12:46:46Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/6635/events",
    "html_url": "https://github.com/cython/cython/issues/6635",
    "id": 2815565770,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/6635/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc6n0h_K",
    "number": 6635,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/6635/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/6635/timeline",
    "title": "[BUG] Incorrect arithmetic operation for an uint32_t",
    "updated_at": "2025-01-28T12:46:46Z",
    "url": "https://api.github.com/repos/cython/cython/issues/6635",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/2546609?v=4",
        "events_url": "https://api.github.com/users/axeldavy/events{/privacy}",
        "followers_url": "https://api.github.com/users/axeldavy/followers",
        "following_url": "https://api.github.com/users/axeldavy/following{/other_user}",
        "gists_url": "https://api.github.com/users/axeldavy/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/axeldavy",
        "id": 2546609,
        "login": "axeldavy",
        "node_id": "MDQ6VXNlcjI1NDY2MDk=",
        "organizations_url": "https://api.github.com/users/axeldavy/orgs",
        "received_events_url": "https://api.github.com/users/axeldavy/received_events",
        "repos_url": "https://api.github.com/users/axeldavy/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/axeldavy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/axeldavy/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/axeldavy",
        "user_view_type": "public"
    }
}