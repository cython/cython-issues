{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Minimal example would be something like\r\n\r\nmodule.pxd\r\n```\r\nfrom libcpp.string cimport string       # \"Normal\" imports like this can be here\r\n```\r\n\r\nmodule.pyx\r\n```\r\nfrom cython.operator cimport dereference as deref      # This _has_ to be here and not in module.pxd\r\n\r\ncdef string food = b'Pizza'\r\ncdef string* ptr = &food\r\n\r\nprint(\"{0:x}\".format(<long long>&ptr))\r\nprint(deref(ptr))\r\n```\r\nIf `deref `is cimported in the *.pxd I get `undeclared name not builtin: deref`.\r\n\r\nTo my understanding these kind of operators are handled here\r\nhttps://github.com/cython/cython/blob/fb02b15da178e58ff2ce3bccd29eaeecc287dda9/Cython/Compiler/ParseTreeTransforms.py#L640\r\n\r\nThere might be a reason to why this doesn't (or shouldn't) work, but I'm guessing the imports have just to look in the *.pxd for those special operators like for normal imports.\r\n\r\nRegards\r\nOliver",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for the report, good call.\r\n\r\nIt doesn't really fell like a clear-cut decision, though.\r\nOn the one hand, `.pyx` files and their corresponding `.pxd` files share a common namespace, so this request makes sense.\r\nOn the other hand, why should names that were cimported to be used in a `.pxd` file leak into the `.pyx` file? If a `.pyx` file uses something provided by an external module, it can cimport it itself, right? The question then is, should it have to?\r\n\r\nI'm slightly leaning towards keeping the cimport explicit for the `.pyx` file. It should definitely be consistent with other cimports (i.e. from actual `.pyx` implemented modules and not only apply to Cython's internally defined tools), but it doesn't feel like the current behaviour is inherently wrong.",
            "created_at": "2020-08-13T08:01:55Z",
            "html_url": "https://github.com/cython/cython/issues/3781#issuecomment-673327077",
            "id": 673327077,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3781",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY3MzMyNzA3Nw==",
            "performed_via_github_app": null,
            "updated_at": "2020-08-13T08:01:55Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/673327077",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "Personally I like moving all imports to the *.pxd file, but this of course is just personal preference.\r\n\r\nMost users won't know the difference of `cython.operator` and let's say `libcpp.string`, so the main argument is consistency and beginner-friendliness.\r\n\r\nI'd say this is low priority, but at least people should be able to find this issue now and understand what's happening.",
            "created_at": "2020-08-13T09:18:41Z",
            "html_url": "https://github.com/cython/cython/issues/3781#issuecomment-673365533",
            "id": 673365533,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3781",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY3MzM2NTUzMw==",
            "performed_via_github_app": null,
            "updated_at": "2020-08-13T09:18:41Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/673365533",
            "user": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/4050664?v=4",
                "events_url": "https://api.github.com/users/oliverhaas/events{/privacy}",
                "followers_url": "https://api.github.com/users/oliverhaas/followers",
                "following_url": "https://api.github.com/users/oliverhaas/following{/other_user}",
                "gists_url": "https://api.github.com/users/oliverhaas/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/oliverhaas",
                "id": 4050664,
                "login": "oliverhaas",
                "node_id": "MDQ6VXNlcjQwNTA2NjQ=",
                "organizations_url": "https://api.github.com/users/oliverhaas/orgs",
                "received_events_url": "https://api.github.com/users/oliverhaas/received_events",
                "repos_url": "https://api.github.com/users/oliverhaas/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/oliverhaas/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/oliverhaas/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/oliverhaas"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3781/comments",
    "created_at": "2020-08-13T07:12:11Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-08-13T07:43:07Z",
            "event": "labeled",
            "id": 3650825320,
            "label": {
                "color": "444444",
                "name": "Type Analysis"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDM2NTA4MjUzMjA=",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/3650825320"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3781/events",
    "html_url": "https://github.com/cython/cython/issues/3781",
    "id": 678209162,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425558824,
            "name": "Type Analysis",
            "node_id": "MDU6TGFiZWw0MjU1NTg4MjQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/Type%20Analysis"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3781/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU2NzgyMDkxNjI=",
    "number": 3781,
    "performed_via_github_app": null,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "[BUG] cython.operators cimported in *.pxd --> undeclared in *.pyx",
    "updated_at": "2020-08-13T09:18:41Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3781",
    "user": {
        "avatar_url": "https://avatars1.githubusercontent.com/u/4050664?v=4",
        "events_url": "https://api.github.com/users/oliverhaas/events{/privacy}",
        "followers_url": "https://api.github.com/users/oliverhaas/followers",
        "following_url": "https://api.github.com/users/oliverhaas/following{/other_user}",
        "gists_url": "https://api.github.com/users/oliverhaas/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/oliverhaas",
        "id": 4050664,
        "login": "oliverhaas",
        "node_id": "MDQ6VXNlcjQwNTA2NjQ=",
        "organizations_url": "https://api.github.com/users/oliverhaas/orgs",
        "received_events_url": "https://api.github.com/users/oliverhaas/received_events",
        "repos_url": "https://api.github.com/users/oliverhaas/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/oliverhaas/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/oliverhaas/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/oliverhaas"
    }
}