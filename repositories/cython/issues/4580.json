{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "<!--\r\n**PLEASE READ THIS FIRST:**\r\n- Do not use the bug and feature tracker for support requests. Use the `cython-users` mailing list instead.\r\n- Did you search for similar issues already? Please do, it helps to save us precious time that we otherwise could not invest into development.\r\n- Did you try the latest master branch or pre-release? It might already have what you want to report. Also see the [Changelog](https://github.com/cython/cython/blob/master/CHANGES.rst) regarding recent changes.\r\n-->\r\n\r\n**Prerequisites**\r\nI spotted this problem some while ago but didn't report it, probably because I didn't want to investigate it. And now, when I thought about it I think that it's some problem in cython.\r\n\r\n\r\n**Describe the bug**\r\nSo the deal is my vc build tools by default had only Russian localization installed therefore error messages were in it, but an output looks like this \r\n```\r\nerror C3861: getDriverMode: �����䨪��� �� ������\r\nerror C2664: \"int main(int,const char **)\": ���������� �८�ࠧ����� ��㬥�� 2 �� \"_Ty *\"\r\nnote: � १���� �८�ࠧ������ ������� �����䨪����\r\n```\r\nwhen I just run the path of cl (it shows help) which cython outputs then I see no such gibberish.\r\nProbably the problem is with the encoding of stderr that cython collects of the process, but I'm not sure.\r\nTherefore I can't supply any other way to reproduce this than to install Russian language packages for vs build tools and set it as default (idk how, probably it's easier to just momentarily remove any other language packages )\r\n\r\n---\r\n\r\nI create this issue more as a reminder to myself because it's such a rare problem that hardly anyone would care, so if it'll be solved, then it's likely to be me ... for anyone without easy access to windows and vs build tools installed it's gonna be harder or maybe impossible to reproduce this, therefore, no simple way to know if fix worked.\r\n\r\n**Lasy fix**\r\nI removed the Russian localization package and now there's only English, finally something that I can understand as opposed to some gibberish :]\r\n\r\n```\r\nerror C3861: 'getDriverMode': identifier not found\r\nerror C2664: 'int main(int,const char **)': cannot convert argument 2 from '_Ty *' to 'const char **'\r\nnote: Conversion loses qualifiers\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows\r\n - Python version 3.9.0\r\n - Cython version 3.0.0a8\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "COLLABORATOR",
            "body": "How are you calling the C compiler? Because it's probably setuptools that's calling it and forwarding the message.\r\n\r\nObviously if it's coming from a Cython tool like cythonize or the ipython-magic then that may be a Cython issue.",
            "created_at": "2022-01-18T22:00:12Z",
            "html_url": "https://github.com/cython/cython/issues/4580#issuecomment-1015872756",
            "id": 1015872756,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4580",
            "node_id": "IC_kwDOABDGAc48jPz0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1015872756/reactions"
            },
            "updated_at": "2022-01-18T22:00:12Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1015872756",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> How are you calling the C compiler?\r\n\r\nCython shows that\r\n```\r\nrunning build_ext\r\nNo module named 'numpy.distutils._msvccompiler' in numpy.distutils; trying from distutils\r\nbuilding 'test_ext' extension\r\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.29.30133\\bin\\HostX86\\x64\\cl.exe /c /nologo /Ox /Wnclude -IC:/C++/projects/<...> -IC:/C++/projects/<...> -IC:\\Program Files\\Pmunity\\VC\\Tools\\MSVC\\14.29.30133\\include -IC:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.8\\include\\um -IC:\\Program Files (x86)\\\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um -IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrtcpp /Fobuild\\temp.win-amd64-3.9\\Release\\cython_build/<...>/run.obj /Od /w\r\n```\r\nso I just ran `\"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.29.30133\\bin\\HostX86\\x64\\cl.exe\"`\r\nand got something like this\r\n```\r\nОптимизирующий компилятор Microsoft (R) C/C++ версии 19.29.30137 для x64\r\n(C) Корпорация Майкрософт (Microsoft Corporation).  Все права защищены.        \r\n\r\nиспользование: cl [ параметр... ] имя_файла... [ /link параметр_компоновки... ]\r\n```\r\n\r\njust info about compiler and usage, nothing too interesting...",
            "created_at": "2022-01-18T22:38:43Z",
            "html_url": "https://github.com/cython/cython/issues/4580#issuecomment-1015897409",
            "id": 1015897409,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4580",
            "node_id": "IC_kwDOABDGAc48jV1B",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1015897409/reactions"
            },
            "updated_at": "2022-01-18T22:38:43Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1015897409",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/52697657?v=4",
                "events_url": "https://api.github.com/users/0dminnimda/events{/privacy}",
                "followers_url": "https://api.github.com/users/0dminnimda/followers",
                "following_url": "https://api.github.com/users/0dminnimda/following{/other_user}",
                "gists_url": "https://api.github.com/users/0dminnimda/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/0dminnimda",
                "id": 52697657,
                "login": "0dminnimda",
                "node_id": "MDQ6VXNlcjUyNjk3NjU3",
                "organizations_url": "https://api.github.com/users/0dminnimda/orgs",
                "received_events_url": "https://api.github.com/users/0dminnimda/received_events",
                "repos_url": "https://api.github.com/users/0dminnimda/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/0dminnimda/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/0dminnimda/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/0dminnimda"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/4580/comments",
    "created_at": "2022-01-18T21:31:27Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/4580/events",
    "html_url": "https://github.com/cython/cython/issues/4580",
    "id": 1107383839,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/4580/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5CAVYf",
    "number": 4580,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/4580/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/4580/timeline",
    "title": "[BUG] C compiler error output in another language is gibberish",
    "updated_at": "2022-01-18T22:38:43Z",
    "url": "https://api.github.com/repos/cython/cython/issues/4580",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/52697657?v=4",
        "events_url": "https://api.github.com/users/0dminnimda/events{/privacy}",
        "followers_url": "https://api.github.com/users/0dminnimda/followers",
        "following_url": "https://api.github.com/users/0dminnimda/following{/other_user}",
        "gists_url": "https://api.github.com/users/0dminnimda/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/0dminnimda",
        "id": 52697657,
        "login": "0dminnimda",
        "node_id": "MDQ6VXNlcjUyNjk3NjU3",
        "organizations_url": "https://api.github.com/users/0dminnimda/orgs",
        "received_events_url": "https://api.github.com/users/0dminnimda/received_events",
        "repos_url": "https://api.github.com/users/0dminnimda/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/0dminnimda/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/0dminnimda/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/0dminnimda"
    }
}