{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "Cython seems to support packages with pxd files. However, they behave different than in Python.\r\n\r\nLet's assume this structure:\r\n```\r\n|- foo\r\n|   |- __init__.pxd\r\n|    `- bar.pxd\r\n`- test.pyx\r\n```\r\nWith the following content:\r\n\r\n`test.pyx`:\r\n```\r\nfrom foo cimport Bar\r\n```\r\n\r\n`foo/__init__.pxd`:\r\n```\r\n# expose to package scope\r\nfrom .bar cimport Bar\r\n```\r\n\r\n`foo/bar.pxd`:\r\n```\r\ncdef class Bar:\r\n    pass\r\n```\r\n\r\nThis does not work: `'foo/Bar.pxd' not found`. However, the same code in Python would work because you can export classes to the package scope. I found this kind of unintuitive.\r\n\r\nInterestingly, the following code works again.\r\nDelete `foo/bar.pxd` and change `foo/__init__.pxd` to:\r\n```\r\ncdef class Bar:\r\n    pass\r\n```\r\n\r\nPlease make the exposing also possible because it allows a better structuring of source files.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Worth verifying, but I think a `cimport` doesn't re-export the name and only makes it available internally. This is usually what people want in `.pyx` files. There might be an argument for differing behaviour in `.pxd` files, as you show, but I'm not sure if such a difference is better or worse for users to understand.",
            "created_at": "2019-12-23T19:55:08Z",
            "html_url": "https://github.com/cython/cython/issues/3270#issuecomment-568567090",
            "id": 568567090,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3270",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODU2NzA5MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/568567090/reactions"
            },
            "updated_at": "2019-12-23T19:55:08Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568567090",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Python behave exactly this way, when using `import` in `__init__.py`, so I guess, users are already familiar with it. It is also common practice to use the `__init__.py` to expose classes to the package scope (e.g. [1](https://mikegrouchy.com/blog/be-pythonic-__init__py), [2](https://timothybramlett.com/How_to_create_a_Python_Package_with___init__py.html)).\r\n",
            "created_at": "2019-12-23T22:06:53Z",
            "html_url": "https://github.com/cython/cython/issues/3270#issuecomment-568592661",
            "id": 568592661,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3270",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODU5MjY2MQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/568592661/reactions"
            },
            "updated_at": "2019-12-23T22:06:53Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/568592661",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/32870336?v=4",
                "events_url": "https://api.github.com/users/gerion0/events{/privacy}",
                "followers_url": "https://api.github.com/users/gerion0/followers",
                "following_url": "https://api.github.com/users/gerion0/following{/other_user}",
                "gists_url": "https://api.github.com/users/gerion0/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gerion0",
                "id": 32870336,
                "login": "gerion0",
                "node_id": "MDQ6VXNlcjMyODcwMzM2",
                "organizations_url": "https://api.github.com/users/gerion0/orgs",
                "received_events_url": "https://api.github.com/users/gerion0/received_events",
                "repos_url": "https://api.github.com/users/gerion0/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gerion0/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gerion0/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gerion0",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Hi, and sorry for digging this old issue ðŸ˜… \n\nHas this behavior changed in Cython 3 ? And if not is there an alternative way to re-expose definitions ?\n\nI fell like [current .pxd documentation](https://cython.readthedocs.io/en/stable/src/tutorial/pxd_files.html#init-pxd) is somewhat lacking information on this topic:\n- It only talks about re-exposing in `__init__.pxd`, so the user has to guess what happen when doing the same from other kind of .pxd\n- It is not clear what happen if a directory has no `__init__.pxd` (from my experience, a directory containing a `__init__.py` is also considered a valid package for cimport resolution)\n- It is not clear why `__init__.pxd` needs to contain `from CyIntegration cimport integrate` (since in Python having an empty `__init__.py` is enough to declare a directory as package and make the sub modules available. It would be expected that doing a cimport in `__init__.pxd` would only be needed to rename a submodule or expose submodule's items at package level...)\n- The example re-expose a module, but nothing is said about re-exposing a module's items (e.g. `from CyIntegration.integrate cimport Function`). From my experience this is not possible, however it is unexpected from a Pythonista point of view ^^\n\nAlso I have the feeling `from foo cimport * ` works differently when using a `foo/__init__.pxd` containing a `from . cimport bar` compared than having an empty `__init__.py`:\n- Considering we have `foo/bar.pxd` containing two lines: `from . bar2 cimport *` and `ctypedef int my_bar_int`\n- Considering we also have `foo/bar2.pxd` containing `ctypedef int my_bar2_int`\n- Considering we also have a .pyx file (outside of the `foo` package) containing `from foo.bar cimport *`\n- With an empty `__init__.py`: both `my_bar_int` and `my_bar2_int` will be accessible\n- with a `foo/__init__.pxd` containing `from . cimport bar`: only `my_bar_int` is accessible ðŸ¤” \n\n@scoder I work on a PR to improve the documentation if you want ;-)\n\nTo add more context: I'm writting Python bindings for the [Godot game engine using Cython](https://github.com/touilleMan/godot-python/tree/godot4-meson). A key feature I'm planning to offer is a first class integration of Cython so that end user can use Cython to interact with the Godot engine \\o/\nSo to achieve this I want to expose a public .pxd API, while still having plenty of other .pxd definitions that are only for the sole internal use of my binding code.\n\nCurrently the thee ways I see to achieve this are:\n- Only have a single .pyx file (well code can be splitted in multiple .pxi, but only one compilation unit). This way all internal definitions don't have to be defined in the .pxd. However it is very cumbersome, and make the incremental compilation time obviously much worst!\n- Use the [cdef public declaration](https://cython.readthedocs.io/en/stable/src/userguide/external_C_code.html#public-declarations) to only expose the private API through a .h header that won't be provided to the end user. However I guess this doesn't work to expose fused types and `cdef inline` functions...\n- The good old Python way: everything is public, use underscore to mark the \"private\" stuff, and trust your end users ðŸ˜„ ",
            "created_at": "2025-09-12T07:47:59Z",
            "html_url": "https://github.com/cython/cython/issues/3270#issuecomment-3284163921",
            "id": 3284163921,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3270",
            "node_id": "IC_kwDOABDGAc7DwF1R",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/3284163921/reactions"
            },
            "updated_at": "2025-09-12T08:09:33Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/3284163921",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4",
                "events_url": "https://api.github.com/users/touilleMan/events{/privacy}",
                "followers_url": "https://api.github.com/users/touilleMan/followers",
                "following_url": "https://api.github.com/users/touilleMan/following{/other_user}",
                "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/touilleMan",
                "id": 3187637,
                "login": "touilleMan",
                "node_id": "MDQ6VXNlcjMxODc2Mzc=",
                "organizations_url": "https://api.github.com/users/touilleMan/orgs",
                "received_events_url": "https://api.github.com/users/touilleMan/received_events",
                "repos_url": "https://api.github.com/users/touilleMan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/touilleMan",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3270/comments",
    "created_at": "2019-12-12T00:16:47Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3187637?v=4",
                "events_url": "https://api.github.com/users/touilleMan/events{/privacy}",
                "followers_url": "https://api.github.com/users/touilleMan/followers",
                "following_url": "https://api.github.com/users/touilleMan/following{/other_user}",
                "gists_url": "https://api.github.com/users/touilleMan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/touilleMan",
                "id": 3187637,
                "login": "touilleMan",
                "node_id": "MDQ6VXNlcjMxODc2Mzc=",
                "organizations_url": "https://api.github.com/users/touilleMan/orgs",
                "received_events_url": "https://api.github.com/users/touilleMan/received_events",
                "repos_url": "https://api.github.com/users/touilleMan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/touilleMan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/touilleMan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/touilleMan",
                "user_view_type": "public"
            },
            "commit_id": "3c65c6634ad20b241de339a43f3888e60206efc6",
            "commit_url": "https://api.github.com/repos/touilleMan/godot-python/commits/3c65c6634ad20b241de339a43f3888e60206efc6",
            "created_at": "2022-08-16T17:09:35Z",
            "event": "referenced",
            "id": 7199051210,
            "node_id": "REFE_lADOABDGAc4f_Sm7zwAAAAGtGM3K",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/7199051210"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-09-12T07:48:01Z",
            "event": "mentioned",
            "id": 19654243947,
            "node_id": "MEE_lADOABDGAc4f_Sm7zwAAAASTe_Zr",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/19654243947"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-09-12T07:48:01Z",
            "event": "subscribed",
            "id": 19654243967,
            "node_id": "SE_lADOABDGAc4f_Sm7zwAAAASTe_Z_",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/19654243967"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3270/events",
    "html_url": "https://github.com/cython/cython/issues/3270",
    "id": 536684987,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3270/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU1MzY2ODQ5ODc=",
    "number": 3270,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/3270/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/3270/timeline",
    "title": "Expose classes in package scope with __init__.pxd",
    "type": null,
    "updated_at": "2025-09-12T08:09:33Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3270",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/32870336?v=4",
        "events_url": "https://api.github.com/users/gerion0/events{/privacy}",
        "followers_url": "https://api.github.com/users/gerion0/followers",
        "following_url": "https://api.github.com/users/gerion0/following{/other_user}",
        "gists_url": "https://api.github.com/users/gerion0/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/gerion0",
        "id": 32870336,
        "login": "gerion0",
        "node_id": "MDQ6VXNlcjMyODcwMzM2",
        "organizations_url": "https://api.github.com/users/gerion0/orgs",
        "received_events_url": "https://api.github.com/users/gerion0/received_events",
        "repos_url": "https://api.github.com/users/gerion0/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/gerion0/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gerion0/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/gerion0",
        "user_view_type": "public"
    }
}