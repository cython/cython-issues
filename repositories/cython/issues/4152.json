{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "<!--\r\n**PLEASE READ THIS FIRST:**\r\n- Do not use the bug and feature tracker for support requests. Use the `cython-users` mailing list instead.\r\n- Did you search for similar issues already? Please do, it helps to save us precious time that we otherwise could not invest into development.\r\n- Did you try the latest master branch or pre-release? It might already have what you want to report. Also see the [Changelog](https://github.com/cython/cython/blob/master/CHANGES.rst) regarding recent changes.\r\n-->\r\n\r\n**Describe the bug**\r\nI compiled the [imagecodecs](https://github.com/cgohlke/imagecodecs) package for testing purposes with Cython 0.29.x (commit 019aebdf5a345087cf4051d3c63d43f6984d7503) on python-3.8.10-amd64 and get the following error when importing any Cython extension. E.g.:\r\n\r\n```\r\n> py -c\"from imagecodecs import _imcd\"\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"imagecodecs\\_imcd.pyx\", line 1, in init imagecodecs._imcd\r\n    # imagecodecs/_imcd.pyx\r\nTypeError: Shared Cython type generator has the wrong size, try recompiling\r\n```\r\n\r\nI traced this to commit cb53a50cf30aa75cbc98c31292a5e5a914c3f4a4: **Implement \"gen.gi_frame\" and \"coro.cr_frame\" attributes on generators and coroutines that return an inspectable (although otherwise dead) frame object.**\r\n\r\nCython extensions built with this version fail to import. Cython extensions built with earlier versions import without error.\r\n\r\n**Environment (please complete the following information):**\r\n```\r\n - Microsoft Windows [Version 10.0.19042.964]\r\n - Python 3.8.10 (tags/v3.8.10:3d8993a, May  3 2021, 11:48:03) [MSC v.1928 64 bit (AMD64)] on win32\r\n - numpy 1.20.3 compiled with Cython 0.29.23\r\n - Cython version 0.29.x 019aebdf5a345087cf4051d3c63d43f6984d7503\r\n",
    "closed_at": "2021-05-10T18:02:46Z",
    "comment_data": [
        {
            "author_association": "COLLABORATOR",
            "body": "I suspect that this is the same issue as https://github.com/cython/cython/issues/4069 was: Cython tries to share common objects such as CyFunction and its generator type. It uses the version string as a disambiguation. There's been some change that's made the generators incompatible with the ones in 0.29.23, but the version string hasn't changed, because it only gets bumped on an actual release.\r\n\r\n Try changing the version number in https://github.com/cython/cython/blob/019aebdf5a345087cf4051d3c63d43f6984d7503/Cython/Shadow.py#L4\r\n\r\nGiven that this has come up a couple of times recently it makes me wonder if there's a better solution (but I don't quite know what the solution is...)",
            "created_at": "2021-05-10T17:46:57Z",
            "html_url": "https://github.com/cython/cython/issues/4152#issuecomment-837036288",
            "id": 837036288,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4152",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgzNzAzNjI4OA==",
            "performed_via_github_app": null,
            "updated_at": "2021-05-10T17:51:13Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/837036288",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Try changing the version number\r\n\r\nThat worked. Thank you!",
            "created_at": "2021-05-10T18:02:46Z",
            "html_url": "https://github.com/cython/cython/issues/4152#issuecomment-837061213",
            "id": 837061213,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/4152",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgzNzA2MTIxMw==",
            "performed_via_github_app": null,
            "updated_at": "2021-05-10T18:02:46Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/837061213",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/483428?v=4",
                "events_url": "https://api.github.com/users/cgohlke/events{/privacy}",
                "followers_url": "https://api.github.com/users/cgohlke/followers",
                "following_url": "https://api.github.com/users/cgohlke/following{/other_user}",
                "gists_url": "https://api.github.com/users/cgohlke/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/cgohlke",
                "id": 483428,
                "login": "cgohlke",
                "node_id": "MDQ6VXNlcjQ4MzQyOA==",
                "organizations_url": "https://api.github.com/users/cgohlke/orgs",
                "received_events_url": "https://api.github.com/users/cgohlke/received_events",
                "repos_url": "https://api.github.com/users/cgohlke/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/cgohlke/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cgohlke/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/cgohlke"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/4152/comments",
    "created_at": "2021-05-10T17:36:40Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/483428?v=4",
                "events_url": "https://api.github.com/users/cgohlke/events{/privacy}",
                "followers_url": "https://api.github.com/users/cgohlke/followers",
                "following_url": "https://api.github.com/users/cgohlke/following{/other_user}",
                "gists_url": "https://api.github.com/users/cgohlke/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/cgohlke",
                "id": 483428,
                "login": "cgohlke",
                "node_id": "MDQ6VXNlcjQ4MzQyOA==",
                "organizations_url": "https://api.github.com/users/cgohlke/orgs",
                "received_events_url": "https://api.github.com/users/cgohlke/received_events",
                "repos_url": "https://api.github.com/users/cgohlke/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/cgohlke/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cgohlke/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/cgohlke"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2021-05-10T18:02:46Z",
            "event": "closed",
            "id": 4719331845,
            "node_id": "MDExOkNsb3NlZEV2ZW50NDcxOTMzMTg0NQ==",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/4719331845"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/4152/events",
    "html_url": "https://github.com/cython/cython/issues/4152",
    "id": 884717496,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/4152/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU4ODQ3MTc0OTY=",
    "number": 4152,
    "performed_via_github_app": null,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "[BUG] TypeError: Shared Cython type generator has the wrong size",
    "updated_at": "2021-05-10T18:02:46Z",
    "url": "https://api.github.com/repos/cython/cython/issues/4152",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/483428?v=4",
        "events_url": "https://api.github.com/users/cgohlke/events{/privacy}",
        "followers_url": "https://api.github.com/users/cgohlke/followers",
        "following_url": "https://api.github.com/users/cgohlke/following{/other_user}",
        "gists_url": "https://api.github.com/users/cgohlke/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/cgohlke",
        "id": 483428,
        "login": "cgohlke",
        "node_id": "MDQ6VXNlcjQ4MzQyOA==",
        "organizations_url": "https://api.github.com/users/cgohlke/orgs",
        "received_events_url": "https://api.github.com/users/cgohlke/received_events",
        "repos_url": "https://api.github.com/users/cgohlke/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/cgohlke/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/cgohlke/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/cgohlke"
    }
}