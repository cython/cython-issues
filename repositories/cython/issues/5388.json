{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Is your feature request related to a problem? Please describe.\n\nThe C++ custom exception handler is almost certainly an advanced feature to help a small number of users, but it doesn't seem like it's particularly easy to use (see discussion in https://github.com/cython/cython/pull/5334).\r\n\r\nOne of the obvious issues is that it's hard to *extend* the default Cython behaviour - you basically need to replace it or duplicate a bunch of Cython utility code yourself.\n\n### Describe the solution you'd like.\n\nMy proposal was:\r\n\r\n1. make it so that `__Pyx_CppExn2PyErr` is always generated for users generating custom exception handlers, so that they're able to call it manually themselves if they want.\r\n2. expose `__Pyx_CppExn2PyErr` as a callable attribute of the cython module, so it's usable from Cython code too. I'm not sure how useful that's likely to be, but it gives options.\r\n\r\n(we'd obviously also want to generate something so that it doesn't give unused code errors).\r\n\r\nThis at least would make it easier to add to the default Cython behaviour.\r\n\n\n### Describe alternatives you've considered.\n\nI haven't really considered... to be honest, I don't have a huge understanding of how people are using these custom exception handlers, so suggestions are welcome.\r\n\r\nOne thing I could imagine being useful (but don't know how/if we'd want to expose it) is the C++11 standard library `https://en.cppreference.com/w/cpp/error/make_exception_ptr`. Potentially that'd give a way for someone to stash a C++ exception in a cdef class so that it could be converted back to a C++ exception later.\n\n### Additional context\n\n_No response_",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "1. I definitely like the idea of that function always being generated so that custom exception handlers can call it. That can only be a helpful addition IMO.\r\n2. I'm having a bit of trouble wrapping my head around how exactly this would get used since I feel like any practical use case of a custom exception handler would require custom C++ code anyway in order to add new exceptions, but maybe there is a way to make use of this.\r\n\r\nI agree, I don't have a great idea of how people are currently using this feature, if at all. The one other case that is familiar to me is something that @pentschev worked on for [ucxx](https://github.com/rapidsai/ucxx/), which can be seen [here](https://github.com/rapidsai/ucxx/blob/branch-0.31/python/ucxx/_lib/libucxx.pyx#L67), but that is ultimately very similar to what I'm doing myself. It would certainly be nice to know what others are doing, if anything. @shwina may have more ideas.\r\n\r\nWhen I first started implementing a prototype of this, I don't even think the possibility of introducing a custom handler was in the documentation, and I found it by trawling through the Cython source code, so at least the situation has already improved since then even prior to #5334!",
            "created_at": "2023-04-19T23:49:35Z",
            "html_url": "https://github.com/cython/cython/issues/5388#issuecomment-1515518759",
            "id": 1515518759,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5388",
            "node_id": "IC_kwDOABDGAc5aVPsn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1515518759/reactions"
            },
            "updated_at": "2023-04-19T23:49:35Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1515518759",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1538165?v=4",
                "events_url": "https://api.github.com/users/vyasr/events{/privacy}",
                "followers_url": "https://api.github.com/users/vyasr/followers",
                "following_url": "https://api.github.com/users/vyasr/following{/other_user}",
                "gists_url": "https://api.github.com/users/vyasr/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vyasr",
                "id": 1538165,
                "login": "vyasr",
                "node_id": "MDQ6VXNlcjE1MzgxNjU=",
                "organizations_url": "https://api.github.com/users/vyasr/orgs",
                "received_events_url": "https://api.github.com/users/vyasr/received_events",
                "repos_url": "https://api.github.com/users/vyasr/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vyasr/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vyasr/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vyasr"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5388/comments",
    "created_at": "2023-04-16T15:14:40Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-04-16T15:14:49Z",
            "event": "labeled",
            "id": 9017701868,
            "label": {
                "color": "f9d0c4",
                "name": "C++"
            },
            "node_id": "LE_lADOABDGAc5jil5ozwAAAAIZfzXs",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/9017701868"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3190405?v=4",
                "events_url": "https://api.github.com/users/shwina/events{/privacy}",
                "followers_url": "https://api.github.com/users/shwina/followers",
                "following_url": "https://api.github.com/users/shwina/following{/other_user}",
                "gists_url": "https://api.github.com/users/shwina/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shwina",
                "id": 3190405,
                "login": "shwina",
                "node_id": "MDQ6VXNlcjMxOTA0MDU=",
                "organizations_url": "https://api.github.com/users/shwina/orgs",
                "received_events_url": "https://api.github.com/users/shwina/received_events",
                "repos_url": "https://api.github.com/users/shwina/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shwina/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shwina/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shwina"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-04-19T23:49:35Z",
            "event": "mentioned",
            "id": 9051765329,
            "node_id": "MEE_lADOABDGAc5jil5ozwAAAAIbhvpR",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/9051765329"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3190405?v=4",
                "events_url": "https://api.github.com/users/shwina/events{/privacy}",
                "followers_url": "https://api.github.com/users/shwina/followers",
                "following_url": "https://api.github.com/users/shwina/following{/other_user}",
                "gists_url": "https://api.github.com/users/shwina/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shwina",
                "id": 3190405,
                "login": "shwina",
                "node_id": "MDQ6VXNlcjMxOTA0MDU=",
                "organizations_url": "https://api.github.com/users/shwina/orgs",
                "received_events_url": "https://api.github.com/users/shwina/received_events",
                "repos_url": "https://api.github.com/users/shwina/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shwina/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shwina/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shwina"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-04-19T23:49:35Z",
            "event": "subscribed",
            "id": 9051765332,
            "node_id": "SE_lADOABDGAc5jil5ozwAAAAIbhvpU",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/9051765332"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
                "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
                "followers_url": "https://api.github.com/users/pentschev/followers",
                "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
                "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pentschev",
                "id": 4398246,
                "login": "pentschev",
                "node_id": "MDQ6VXNlcjQzOTgyNDY=",
                "organizations_url": "https://api.github.com/users/pentschev/orgs",
                "received_events_url": "https://api.github.com/users/pentschev/received_events",
                "repos_url": "https://api.github.com/users/pentschev/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pentschev"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-04-19T23:49:35Z",
            "event": "mentioned",
            "id": 9051765341,
            "node_id": "MEE_lADOABDGAc5jil5ozwAAAAIbhvpd",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/9051765341"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
                "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
                "followers_url": "https://api.github.com/users/pentschev/followers",
                "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
                "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pentschev",
                "id": 4398246,
                "login": "pentschev",
                "node_id": "MDQ6VXNlcjQzOTgyNDY=",
                "organizations_url": "https://api.github.com/users/pentschev/orgs",
                "received_events_url": "https://api.github.com/users/pentschev/received_events",
                "repos_url": "https://api.github.com/users/pentschev/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pentschev"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-04-19T23:49:35Z",
            "event": "subscribed",
            "id": 9051765345,
            "node_id": "SE_lADOABDGAc5jil5ozwAAAAIbhvph",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/9051765345"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5388/events",
    "html_url": "https://github.com/cython/cython/issues/5388",
    "id": 1670012520,
    "labels": [
        {
            "color": "f9d0c4",
            "default": false,
            "description": null,
            "id": 414805136,
            "name": "C++",
            "node_id": "MDU6TGFiZWw0MTQ4MDUxMzY=",
            "url": "https://api.github.com/repos/cython/cython/labels/C++"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5388/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5jil5o",
    "number": 5388,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5388/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5388/timeline",
    "title": "[ENH] Improve support for C++ custom exception handlers",
    "updated_at": "2023-04-19T23:49:35Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5388",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
        "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
        "followers_url": "https://api.github.com/users/da-woods/followers",
        "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
        "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/da-woods",
        "id": 10536947,
        "login": "da-woods",
        "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
        "organizations_url": "https://api.github.com/users/da-woods/orgs",
        "received_events_url": "https://api.github.com/users/da-woods/received_events",
        "repos_url": "https://api.github.com/users/da-woods/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/da-woods"
    }
}