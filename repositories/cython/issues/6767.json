{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\n\nAccording to the latest doc section about pickling of extension types ([ref](https://cython.readthedocs.io/en/latest/src/userguide/extension_types.html#controlling-pickling)) cython will throw an error at compile time if it cannot create a `__reduce__` method. The wording is, that the attribute must be convertible to Python, which might be the case with memoryviews, so the following behaviour is technicallyy correct. However, the reason to specify the decorator is to make sure that the class can be pickled, which is not the case.\n\n```cython\n@cython.auto_pickle(True)\ncdef class TestClass:\n\n    cdef:\n        double[:,:] x\n\n    def __init__(self, cnp.ndarray[double, ndim=2] x):\n        self.x = x\n```\n\nThe example class above does compile without problems but fails at pickling with the following error:\n\n```\nFile <stringsource>:2, in View.MemoryView._memoryviewslice.__reduce_cython__()\nTypeError: no default __reduce__ due to non-trivial __cinit__\n```\n\nTo my knowledge memoryviews cannot be pickled, as they are just, well, views. Nevertheless I would expect an error at compile them due to the decorator if memoryviews are class attributes. In the best case the documentation would include some hints how to write the reduce method to allow pickling of the data (e.g. like [this ](https://stackoverflow.com/a/22252368) stackoverflow answer).\n\n### Code to reproduce the behaviour:\n\n\n\n\n### Expected behaviour\n\n_No response_\n\n### OS\n\nWindows 10\n\n### Python version\n\n3.10.9\n\n### Cython version\n\n3.0.11\n\n### Additional context\n\nThere are related issues like #5629 which proposes to make pickling of memoryviews possible. This issue is about throwing an error as expected from the description in the docs.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "What's happening is that Cython assumes that everything that can be coerced to/from a Python object might be pickleable. Which includes typed memoryviews (even though in this case we control what Python object it is and know that they aren't pickleable).\n\nObviously it'd be possible to special-case memoryviews so they're known not to be pickleable.\n\nI still think it's probably possible to make some memoryviews pickleable. But I could be wrong.\n\n",
            "created_at": "2025-03-29T12:44:35Z",
            "html_url": "https://github.com/cython/cython/issues/6767#issuecomment-2763348398",
            "id": 2763348398,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6767",
            "node_id": "IC_kwDOABDGAc6ktVmu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2763348398/reactions"
            },
            "updated_at": "2025-03-29T12:44:35Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2763348398",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Until a way is found to make memoryviews pickleable, I think it is a good solution to special-case memoryviews and at least warn the user.",
            "created_at": "2025-04-07T11:49:46Z",
            "html_url": "https://github.com/cython/cython/issues/6767#issuecomment-2783058042",
            "id": 2783058042,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6767",
            "node_id": "IC_kwDOABDGAc6l4hh6",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2783058042/reactions"
            },
            "updated_at": "2025-04-07T11:49:56Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2783058042",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62036826?v=4",
                "events_url": "https://api.github.com/users/leo-hstone/events{/privacy}",
                "followers_url": "https://api.github.com/users/leo-hstone/followers",
                "following_url": "https://api.github.com/users/leo-hstone/following{/other_user}",
                "gists_url": "https://api.github.com/users/leo-hstone/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/leo-hstone",
                "id": 62036826,
                "login": "leo-hstone",
                "node_id": "MDQ6VXNlcjYyMDM2ODI2",
                "organizations_url": "https://api.github.com/users/leo-hstone/orgs",
                "received_events_url": "https://api.github.com/users/leo-hstone/received_events",
                "repos_url": "https://api.github.com/users/leo-hstone/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/leo-hstone/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/leo-hstone/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/leo-hstone",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/6767/comments",
    "created_at": "2025-03-28T14:42:02Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62036826?v=4",
                "events_url": "https://api.github.com/users/leo-hstone/events{/privacy}",
                "followers_url": "https://api.github.com/users/leo-hstone/followers",
                "following_url": "https://api.github.com/users/leo-hstone/following{/other_user}",
                "gists_url": "https://api.github.com/users/leo-hstone/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/leo-hstone",
                "id": 62036826,
                "login": "leo-hstone",
                "node_id": "MDQ6VXNlcjYyMDM2ODI2",
                "organizations_url": "https://api.github.com/users/leo-hstone/orgs",
                "received_events_url": "https://api.github.com/users/leo-hstone/received_events",
                "repos_url": "https://api.github.com/users/leo-hstone/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/leo-hstone/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/leo-hstone/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/leo-hstone",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2025-03-28T14:42:20Z",
            "event": "renamed",
            "id": 17033826828,
            "node_id": "RTE_lADOABDGAc6wNqk2zwAAAAP3S5IM",
            "performed_via_github_app": null,
            "rename": {
                "from": "[BUG] Decorator @cython.auto_pickle(true) does not raise exeption with cdef memoryviews.",
                "to": "[BUG] Decorator @cython.auto_pickle(true) does not throw error with cdef memoryviews."
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/17033826828"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/6767/events",
    "html_url": "https://github.com/cython/cython/issues/6767",
    "id": 2956372278,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/6767/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc6wNqk2",
    "number": 6767,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/6767/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/6767/timeline",
    "title": "[BUG] Decorator @cython.auto_pickle(true) does not throw error with cdef memoryviews.",
    "type": null,
    "updated_at": "2025-04-07T11:49:58Z",
    "url": "https://api.github.com/repos/cython/cython/issues/6767",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/62036826?v=4",
        "events_url": "https://api.github.com/users/leo-hstone/events{/privacy}",
        "followers_url": "https://api.github.com/users/leo-hstone/followers",
        "following_url": "https://api.github.com/users/leo-hstone/following{/other_user}",
        "gists_url": "https://api.github.com/users/leo-hstone/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/leo-hstone",
        "id": 62036826,
        "login": "leo-hstone",
        "node_id": "MDQ6VXNlcjYyMDM2ODI2",
        "organizations_url": "https://api.github.com/users/leo-hstone/orgs",
        "received_events_url": "https://api.github.com/users/leo-hstone/received_events",
        "repos_url": "https://api.github.com/users/leo-hstone/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/leo-hstone/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/leo-hstone/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/leo-hstone",
        "user_view_type": "public"
    }
}