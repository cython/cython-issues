{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Trying to use @compile on an annotated function in python 3.8.1:\r\n\r\n```python\r\n@compile\r\ndef func(z: c.int):\r\n    pass\r\n```\r\n\r\nI get:\r\n\r\n```\r\nc.int):\r\n    ^\r\n------------------------------------------------------------\r\n\r\n(tree fragment):1:5: Syntax error in simple statement list\r\n```\r\n\r\nIs it possible to add a `language_level` parameter to `compile()`, or have it infer it from `sys.version` or something to that effect? \r\n\r\nOr perhaps better, can we  set the default language level to 3 at this time?\r\n\r\n\r\nThanks,\r\nEli",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "(Ignore my previous, now deleted comment, about how it works for me - I forgot that the functions are only compiled when you actually use them)\r\n\r\nThe `@compile` decorator is very crude and assumes that the function definition starts after the first `:` - https://github.com/cython/cython/blob/a73815042ea40373b098a5efba264f72dfe60ec6/Cython/Build/Inline.py#L330-L335. It's a bug but it has nothing to do with `language_level` (annotations should work fine at any `language_level`)",
            "created_at": "2020-01-19T22:12:16Z",
            "html_url": "https://github.com/cython/cython/issues/3317#issuecomment-576053129",
            "id": 576053129,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3317",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjA1MzEyOQ==",
            "updated_at": "2020-01-19T22:13:23Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/576053129",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks!  Sorry for the double, edited the title\r\n\r\nThat's almost crudely accurate - if it's not a lambda, it starts after the first `:\\n` :)\r\n\r\nHow about\r\n\r\n```python\r\ndef get_body(source):\r\n    ''' Crude attempt at getting the function body '''\r\n\r\n    # first_newline = source.index('\\n') \r\n    body = ''\r\n    ix = -1\r\n    while not body:\r\n        ix = source.index(':', ix+1)\r\n        # Does this work? I think the indices should be -\r\n        # if source[ix-5:ix] == 'lambda':\r\n        if source[:5] == 'lambda':\r\n            body = \"return %s\" % source[ix+1:]\r\n        elif source[ix+1] in ('\\r', '\\n'):\r\n            body = source[ix+2:]\r\n        else:\r\n            continue\r\n\r\n    return body \r\n```",
            "created_at": "2020-01-20T07:14:34Z",
            "html_url": "https://github.com/cython/cython/issues/3317#issuecomment-576137991",
            "id": 576137991,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3317",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjEzNzk5MQ==",
            "updated_at": "2020-01-20T07:38:53Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/576137991",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/24714022?v=4",
                "events_url": "https://api.github.com/users/h5rdly/events{/privacy}",
                "followers_url": "https://api.github.com/users/h5rdly/followers",
                "following_url": "https://api.github.com/users/h5rdly/following{/other_user}",
                "gists_url": "https://api.github.com/users/h5rdly/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/h5rdly",
                "id": 24714022,
                "login": "h5rdly",
                "node_id": "MDQ6VXNlcjI0NzE0MDIy",
                "organizations_url": "https://api.github.com/users/h5rdly/orgs",
                "received_events_url": "https://api.github.com/users/h5rdly/received_events",
                "repos_url": "https://api.github.com/users/h5rdly/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/h5rdly/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/h5rdly/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/h5rdly"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "```def f(): return 1```\r\n\r\nFor a function containing a single statement there's no need for a newline...\r\n\r\n```lambda x, y=\"colon! :\", z=2: 1```\r\n\r\nLambda's can have colons....\r\n\r\nIt actually look pretty hard to get right - I'd guess that it'd be best taken from Cython's parser, because anything else would need to replicate a good chunk of the parser to cover all the corner cases. I realise I'm being more unhelpful than helpful here.",
            "created_at": "2020-01-20T08:53:43Z",
            "html_url": "https://github.com/cython/cython/issues/3317#issuecomment-576171822",
            "id": 576171822,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3317",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjE3MTgyMg==",
            "updated_at": "2020-01-20T08:58:36Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/576171822",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3317/comments",
    "created_at": "2020-01-18T17:27:02Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/2030909?v=4",
                "events_url": "https://api.github.com/users/compile/events{/privacy}",
                "followers_url": "https://api.github.com/users/compile/followers",
                "following_url": "https://api.github.com/users/compile/following{/other_user}",
                "gists_url": "https://api.github.com/users/compile/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/compile",
                "id": 2030909,
                "login": "compile",
                "node_id": "MDQ6VXNlcjIwMzA5MDk=",
                "organizations_url": "https://api.github.com/users/compile/orgs",
                "received_events_url": "https://api.github.com/users/compile/received_events",
                "repos_url": "https://api.github.com/users/compile/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/compile/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/compile/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/compile"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-18T17:27:02Z",
            "event": "mentioned",
            "id": 2960348089,
            "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50Mjk2MDM0ODA4OQ==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2960348089"
        },
        {
            "actor": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/2030909?v=4",
                "events_url": "https://api.github.com/users/compile/events{/privacy}",
                "followers_url": "https://api.github.com/users/compile/followers",
                "following_url": "https://api.github.com/users/compile/following{/other_user}",
                "gists_url": "https://api.github.com/users/compile/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/compile",
                "id": 2030909,
                "login": "compile",
                "node_id": "MDQ6VXNlcjIwMzA5MDk=",
                "organizations_url": "https://api.github.com/users/compile/orgs",
                "received_events_url": "https://api.github.com/users/compile/received_events",
                "repos_url": "https://api.github.com/users/compile/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/compile/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/compile/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/compile"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-18T17:27:02Z",
            "event": "subscribed",
            "id": 2960348091,
            "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDI5NjAzNDgwOTE=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2960348091"
        },
        {
            "actor": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/24714022?v=4",
                "events_url": "https://api.github.com/users/h5rdly/events{/privacy}",
                "followers_url": "https://api.github.com/users/h5rdly/followers",
                "following_url": "https://api.github.com/users/h5rdly/following{/other_user}",
                "gists_url": "https://api.github.com/users/h5rdly/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/h5rdly",
                "id": 24714022,
                "login": "h5rdly",
                "node_id": "MDQ6VXNlcjI0NzE0MDIy",
                "organizations_url": "https://api.github.com/users/h5rdly/orgs",
                "received_events_url": "https://api.github.com/users/h5rdly/received_events",
                "repos_url": "https://api.github.com/users/h5rdly/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/h5rdly/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/h5rdly/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/h5rdly"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-20T07:15:40Z",
            "event": "renamed",
            "id": 2961816335,
            "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50Mjk2MTgxNjMzNQ==",
            "rename": {
                "from": "Allow @compile to read or accept language_level",
                "to": "@compile looks for function body without regard to type hints"
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/2961816335"
        },
        {
            "actor": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/24714022?v=4",
                "events_url": "https://api.github.com/users/h5rdly/events{/privacy}",
                "followers_url": "https://api.github.com/users/h5rdly/followers",
                "following_url": "https://api.github.com/users/h5rdly/following{/other_user}",
                "gists_url": "https://api.github.com/users/h5rdly/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/h5rdly",
                "id": 24714022,
                "login": "h5rdly",
                "node_id": "MDQ6VXNlcjI0NzE0MDIy",
                "organizations_url": "https://api.github.com/users/h5rdly/orgs",
                "received_events_url": "https://api.github.com/users/h5rdly/received_events",
                "repos_url": "https://api.github.com/users/h5rdly/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/h5rdly/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/h5rdly/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/h5rdly"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-20T07:39:54Z",
            "event": "renamed",
            "id": 2961873034,
            "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50Mjk2MTg3MzAzNA==",
            "rename": {
                "from": "@compile looks for function body without regard to type hints",
                "to": "@compile looks for function body via ':' lookup without regard to type hints"
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/2961873034"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-21T12:57:22Z",
            "event": "labeled",
            "id": 2966096334,
            "label": {
                "color": "444444",
                "name": "defect"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDI5NjYwOTYzMzQ=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2966096334"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-21T12:57:22Z",
            "event": "labeled",
            "id": 2966096335,
            "label": {
                "color": "444444",
                "name": "Parsing"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDI5NjYwOTYzMzU=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2966096335"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2020-01-21T12:57:22Z",
            "event": "labeled",
            "id": 2966096337,
            "label": {
                "color": "444444",
                "name": "Tools"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDI5NjYwOTYzMzc=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2966096337"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3317/events",
    "html_url": "https://github.com/cython/cython/issues/3317",
    "id": 551798403,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425553653,
            "name": "Parsing",
            "node_id": "MDU6TGFiZWw0MjU1NTM2NTM=",
            "url": "https://api.github.com/repos/cython/cython/labels/Parsing"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425563280,
            "name": "Tools",
            "node_id": "MDU6TGFiZWw0MjU1NjMyODA=",
            "url": "https://api.github.com/repos/cython/cython/labels/Tools"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425553654,
            "name": "defect",
            "node_id": "MDU6TGFiZWw0MjU1NTM2NTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/defect"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3317/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU1NTE3OTg0MDM=",
    "number": 3317,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "@compile looks for function body via ':' lookup without regard to type hints",
    "updated_at": "2020-01-21T12:57:22Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3317",
    "user": {
        "avatar_url": "https://avatars2.githubusercontent.com/u/24714022?v=4",
        "events_url": "https://api.github.com/users/h5rdly/events{/privacy}",
        "followers_url": "https://api.github.com/users/h5rdly/followers",
        "following_url": "https://api.github.com/users/h5rdly/following{/other_user}",
        "gists_url": "https://api.github.com/users/h5rdly/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/h5rdly",
        "id": 24714022,
        "login": "h5rdly",
        "node_id": "MDQ6VXNlcjI0NzE0MDIy",
        "organizations_url": "https://api.github.com/users/h5rdly/orgs",
        "received_events_url": "https://api.github.com/users/h5rdly/received_events",
        "repos_url": "https://api.github.com/users/h5rdly/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/h5rdly/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/h5rdly/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/h5rdly"
    }
}