{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "<!--\r\n**PLEASE READ THIS FIRST:**\r\n- Do not use the bug and feature tracker for support requests. Use the `cython-users` mailing list instead.\r\n- Did you search for similar issues already? Please do, it helps to save us precious time that we otherwise could not invest into development.\r\n- Did you try the latest master branch or pre-release? It might already have what you want to report. Also see the [Changelog](https://github.com/cython/cython/blob/master/CHANGES.rst) regarding recent changes.\r\n-->\r\n\r\n**Describe the bug**\r\n\r\nCode generated from the following Cython source, when compiled with `-DCYTHON_TRACE_NOGIL=1` generates compilation warning ``warning: ‘__pyx_gilstate_save’ may be used uninitialized in this function``.\r\n\r\n```\r\ngcc -pthread -B ~/miniconda3/envs/gh767/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -fPIC -O2 -isystem ~/miniconda3/envs/gh767/include -fPIC -O2 -isystem ~/miniconda3/envs/gh767/include -fPIC -DCYTHON_TRACE_NOGIL=1 -DCYTHON_TRACE=1 -I~/miniconda3/envs/gh767/include/python3.10 -c gh767/_ext.c -o build/temp.linux-x86_64-3.10/gh767/_ext.o\r\ngh767/_ext.c: In function ‘__pyx_pw_5gh767_4_ext_1handler’:\r\ngh767/_ext.c:898:34: warning: ‘__pyx_gilstate_save’ may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n  898 | #define __Pyx_PyGILState_Release PyGILState_Release\r\n      |                                  ^~~~~~~~~~~~~~~~~~\r\ngh767/_ext.c:1906:20: note: ‘__pyx_gilstate_save’ was declared here\r\n 1906 |   PyGILState_STATE __pyx_gilstate_save;\r\n      |                    ^~~~~~~~~~~~~~~~~~~\r\ncreating build/lib.linux-x86_64-3.10\r\n```\r\n\r\nThe warning is observed for both C and C++ generated languages. The warning goes away if `CYTHON_TRACE_NOGIL` is unset (even if `CYTHON_TRACE` is set).\r\n\r\n**To Reproduce**\r\n\r\nUse the following cython source, or clone [reproducing project](https://github.com/oleksandr-pavlyk/compiler-warning-cython-generated-source-reproducer) and execute `python setup.py build`.\r\n\r\n```cython\r\n# cython: language_level=3\r\n# cython: linetrace=True\r\n\r\ncdef class MyError(Exception):\r\n    \"\"\"\r\n    An  exception is raised when operation submission\r\n    or execution encounters an error.\r\n    \"\"\"\r\n\r\ncdef void foo(int err) nogil except *:\r\n    with gil:\r\n        raise MyError(err)\r\n\r\ndef handler(int err):\r\n    if (err % 2):\r\n        with nogil:\r\n            foo(err)\r\n    else:\r\n        print(\"All good\")\r\n```\r\n\r\n**Expected behavior**\r\n\r\nGenerated code should compile cleanly using cython=0.29.* as it already does using Cython=3.0.0a10.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Python version: all\r\n - Cython version reproduced with versions 0.29.24-0.29.27\r\n\r\n",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/4637/comments",
    "created_at": "2022-02-12T22:31:06Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/4637/events",
    "html_url": "https://github.com/cython/cython/issues/4637",
    "id": 1134718430,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/4637/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5Dom3e",
    "number": 4637,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/4637/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/4637/timeline",
    "title": "[BUG] Generated C/C++ source compiles with maybe-uninitialized warning with CYTHON_TRACE_NOGIL set",
    "updated_at": "2022-02-12T22:31:06Z",
    "url": "https://api.github.com/repos/cython/cython/issues/4637",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/21087696?v=4",
        "events_url": "https://api.github.com/users/oleksandr-pavlyk/events{/privacy}",
        "followers_url": "https://api.github.com/users/oleksandr-pavlyk/followers",
        "following_url": "https://api.github.com/users/oleksandr-pavlyk/following{/other_user}",
        "gists_url": "https://api.github.com/users/oleksandr-pavlyk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/oleksandr-pavlyk",
        "id": 21087696,
        "login": "oleksandr-pavlyk",
        "node_id": "MDQ6VXNlcjIxMDg3Njk2",
        "organizations_url": "https://api.github.com/users/oleksandr-pavlyk/orgs",
        "received_events_url": "https://api.github.com/users/oleksandr-pavlyk/received_events",
        "repos_url": "https://api.github.com/users/oleksandr-pavlyk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/oleksandr-pavlyk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/oleksandr-pavlyk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/oleksandr-pavlyk"
    }
}