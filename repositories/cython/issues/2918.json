{
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "We have a project (https://github.com/cherab) that is split into a number of different sub-packages. Different teams/labs own the different sub-packages. We use namespaces to pull the separate packages together to appear as a single package. We have recently tried to make the package installable from pypi, however we have encountered an issue with cython compilation:\r\n\r\npip install cherab\r\npip install cherab-openadas\r\n\r\nThe second package (dependent on the first) fails to compile, saying it can not find the pxd files. On investigating, pip appears to set up a PEP420 namespace where there is no `__init__.py` in the root package. If I manually add an `__init__.py` to the root of the package and try pip again, the cython compilation for cherab-openadas succeeds. Given this, I had a look through the cython source and noticed that during the pxd search, only paths with `__init__.py/pxd` files are scanned. I removed the relevant check in Cython.Utils.search_include_directories() (on 0.29.x branch) and attempted the  re-installation with pip in a clean environment. The compilation and installation was successful.\r\n\r\nGiven PEP420, is there any explicit need for the `__init__.*` check? Could it be removed? On first look, I can't see any reason it would cause a problem.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Thanks for raising @CnlPepper,  +1 for fixing this.",
            "created_at": "2019-04-11T14:02:19Z",
            "html_url": "https://github.com/cython/cython/issues/2918#issuecomment-482127146",
            "id": 482127146,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2918",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjEyNzE0Ng==",
            "updated_at": "2019-04-11T14:02:19Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/482127146",
            "user": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/8628876?v=4",
                "events_url": "https://api.github.com/users/mattngc/events{/privacy}",
                "followers_url": "https://api.github.com/users/mattngc/followers",
                "following_url": "https://api.github.com/users/mattngc/following{/other_user}",
                "gists_url": "https://api.github.com/users/mattngc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mattngc",
                "id": 8628876,
                "login": "mattngc",
                "node_id": "MDQ6VXNlcjg2Mjg4NzY=",
                "organizations_url": "https://api.github.com/users/mattngc/orgs",
                "received_events_url": "https://api.github.com/users/mattngc/received_events",
                "repos_url": "https://api.github.com/users/mattngc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mattngc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mattngc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mattngc"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The lookup algorithm in PEP-420 is a bit more complex than just leaving out the `__init__.p*` check. PR welcome that implements the correct algorithm.\r\nhttps://www.python.org/dev/peps/pep-0420/#specification",
            "created_at": "2019-04-11T16:14:40Z",
            "html_url": "https://github.com/cython/cython/issues/2918#issuecomment-482180972",
            "id": 482180972,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2918",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjE4MDk3Mg==",
            "updated_at": "2019-04-11T16:14:40Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/482180972",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I feel I might be a bit out of my depth with this one, but I can have a look. Do you want this patched against 0.29.x or master?",
            "created_at": "2019-04-11T16:17:53Z",
            "html_url": "https://github.com/cython/cython/issues/2918#issuecomment-482182306",
            "id": 482182306,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2918",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjE4MjMwNg==",
            "updated_at": "2019-04-11T16:17:53Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/482182306",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/8628770?v=4",
                "events_url": "https://api.github.com/users/CnlPepper/events{/privacy}",
                "followers_url": "https://api.github.com/users/CnlPepper/followers",
                "following_url": "https://api.github.com/users/CnlPepper/following{/other_user}",
                "gists_url": "https://api.github.com/users/CnlPepper/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/CnlPepper",
                "id": 8628770,
                "login": "CnlPepper",
                "node_id": "MDQ6VXNlcjg2Mjg3NzA=",
                "organizations_url": "https://api.github.com/users/CnlPepper/orgs",
                "received_events_url": "https://api.github.com/users/CnlPepper/received_events",
                "repos_url": "https://api.github.com/users/CnlPepper/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/CnlPepper/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CnlPepper/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/CnlPepper"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Definitely `master`.",
            "created_at": "2019-04-11T16:19:14Z",
            "html_url": "https://github.com/cython/cython/issues/2918#issuecomment-482182807",
            "id": 482182807,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2918",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjE4MjgwNw==",
            "updated_at": "2019-04-11T16:19:14Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/482182807",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@scoder I'm not 100% sure how to go about adding a test for this feature... I found test/build/package_compilation.srctree which looks like it might be a good place to get inspiration. I've not encountered srctree files before, is there any documentation and how do I run a specific test?\r\n\r\nIt looks like I just need to patch the Cython.Utils.is_package_dir() function to understand PEP420 namespace folders. Can you think of any reason this might not be a valid approach?\r\n\r\n",
            "created_at": "2019-04-11T17:30:58Z",
            "html_url": "https://github.com/cython/cython/issues/2918#issuecomment-482217376",
            "id": 482217376,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2918",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjIxNzM3Ng==",
            "updated_at": "2019-04-11T17:31:10Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/482217376",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/8628770?v=4",
                "events_url": "https://api.github.com/users/CnlPepper/events{/privacy}",
                "followers_url": "https://api.github.com/users/CnlPepper/followers",
                "following_url": "https://api.github.com/users/CnlPepper/following{/other_user}",
                "gists_url": "https://api.github.com/users/CnlPepper/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/CnlPepper",
                "id": 8628770,
                "login": "CnlPepper",
                "node_id": "MDQ6VXNlcjg2Mjg3NzA=",
                "organizations_url": "https://api.github.com/users/CnlPepper/orgs",
                "received_events_url": "https://api.github.com/users/CnlPepper/received_events",
                "repos_url": "https://api.github.com/users/CnlPepper/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/CnlPepper/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CnlPepper/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/CnlPepper"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That's a good place to start, yes. Our \"srctree\" test files are literally just a bunch of source files stuffed into one, with the commands at the top that get executed. Use \"runtests.py -vv [regex]\" to run them. See\r\nhttps://github.com/cython/cython/wiki/HackerGuide#the-test-suite",
            "created_at": "2019-04-12T05:56:46Z",
            "html_url": "https://github.com/cython/cython/issues/2918#issuecomment-482447704",
            "id": 482447704,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2918",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjQ0NzcwNA==",
            "updated_at": "2019-04-12T05:56:46Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/482447704",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2918/comments",
    "created_at": "2019-04-11T13:35:51Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/8628770?v=4",
                "events_url": "https://api.github.com/users/CnlPepper/events{/privacy}",
                "followers_url": "https://api.github.com/users/CnlPepper/followers",
                "following_url": "https://api.github.com/users/CnlPepper/following{/other_user}",
                "gists_url": "https://api.github.com/users/CnlPepper/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/CnlPepper",
                "id": 8628770,
                "login": "CnlPepper",
                "node_id": "MDQ6VXNlcjg2Mjg3NzA=",
                "organizations_url": "https://api.github.com/users/CnlPepper/orgs",
                "received_events_url": "https://api.github.com/users/CnlPepper/received_events",
                "repos_url": "https://api.github.com/users/CnlPepper/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/CnlPepper/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CnlPepper/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/CnlPepper"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-04-11T14:02:19Z",
            "event": "mentioned",
            "id": 2269343515,
            "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MjI2OTM0MzUxNQ==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2269343515"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/8628770?v=4",
                "events_url": "https://api.github.com/users/CnlPepper/events{/privacy}",
                "followers_url": "https://api.github.com/users/CnlPepper/followers",
                "following_url": "https://api.github.com/users/CnlPepper/following{/other_user}",
                "gists_url": "https://api.github.com/users/CnlPepper/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/CnlPepper",
                "id": 8628770,
                "login": "CnlPepper",
                "node_id": "MDQ6VXNlcjg2Mjg3NzA=",
                "organizations_url": "https://api.github.com/users/CnlPepper/orgs",
                "received_events_url": "https://api.github.com/users/CnlPepper/received_events",
                "repos_url": "https://api.github.com/users/CnlPepper/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/CnlPepper/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CnlPepper/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/CnlPepper"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-04-11T14:02:19Z",
            "event": "subscribed",
            "id": 2269343516,
            "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDIyNjkzNDM1MTY=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2269343516"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-04-11T16:14:55Z",
            "event": "labeled",
            "id": 2269770882,
            "label": {
                "color": "444444",
                "name": "Build System"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDIyNjk3NzA4ODI=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2269770882"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-04-11T16:14:55Z",
            "event": "labeled",
            "id": 2269770884,
            "label": {
                "color": "444444",
                "name": "Python Semantics"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDIyNjk3NzA4ODQ=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2269770884"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-04-11T17:30:59Z",
            "event": "mentioned",
            "id": 2269999082,
            "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MjI2OTk5OTA4Mg==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2269999082"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-04-11T17:30:59Z",
            "event": "subscribed",
            "id": 2269999083,
            "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDIyNjk5OTkwODM=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2269999083"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2918/events",
    "html_url": "https://github.com/cython/cython/issues/2918",
    "id": 432027632,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "id": 425556353,
            "name": "Build System",
            "node_id": "MDU6TGFiZWw0MjU1NTYzNTM=",
            "url": "https://api.github.com/repos/cython/cython/labels/Build%20System"
        },
        {
            "color": "444444",
            "default": false,
            "id": 425556315,
            "name": "Python Semantics",
            "node_id": "MDU6TGFiZWw0MjU1NTYzMTU=",
            "url": "https://api.github.com/repos/cython/cython/labels/Python%20Semantics"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2918/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU0MzIwMjc2MzI=",
    "number": 2918,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Fix for cimport from PEP420 namespace",
    "updated_at": "2019-04-12T05:56:46Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2918",
    "user": {
        "avatar_url": "https://avatars0.githubusercontent.com/u/8628770?v=4",
        "events_url": "https://api.github.com/users/CnlPepper/events{/privacy}",
        "followers_url": "https://api.github.com/users/CnlPepper/followers",
        "following_url": "https://api.github.com/users/CnlPepper/following{/other_user}",
        "gists_url": "https://api.github.com/users/CnlPepper/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/CnlPepper",
        "id": 8628770,
        "login": "CnlPepper",
        "node_id": "MDQ6VXNlcjg2Mjg3NzA=",
        "organizations_url": "https://api.github.com/users/CnlPepper/orgs",
        "received_events_url": "https://api.github.com/users/CnlPepper/received_events",
        "repos_url": "https://api.github.com/users/CnlPepper/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/CnlPepper/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/CnlPepper/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/CnlPepper"
    }
}