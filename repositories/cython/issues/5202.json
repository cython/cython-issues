{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Describe the bug\r\n\r\nAccording to the [docs](https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#types):\r\n\r\n> int, long, and float are not available for static typing and instead interpreted as C ``int``, ``long``, and ``float`` respectively\r\n\r\nThe following code snippet infers `attr` to be a Python object instead of a float.\r\n```python\r\nimport cython\r\n\r\ncdef class Test:\r\n    cdef float attr\r\n\r\n    @cython.infer_types.verbose(True)\r\n    cdef float test(self):\r\n        attr = self.attr\r\n        return attr\r\n```\r\nLooking at the c code that is generated, cython seems to think that `self.attr` is a double at first instead of a float: `PyFloat_FromDouble(__pyx_v_self->attr);`\r\n\r\n\r\nThe inference is correct when the type is a `double` or an `int`. Is this a bug or am I misinterpreting the docs? \r\n\r\n### Environment\r\n\r\nOS: Windows\r\nPython version 3.10.2\r\nCython version 3.0.0a11",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> `PyFloat_FromDouble(__pyx_v_self->attr);`\r\n\r\nThis is the correct way to create a Python float object from a C float (or double) value. Look for `float attr` in the generated C code, you'll probably find it in the object struct of your `Test` type.",
            "created_at": "2023-01-10T07:12:05Z",
            "html_url": "https://github.com/cython/cython/issues/5202#issuecomment-1376824718",
            "id": 1376824718,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5202",
            "node_id": "IC_kwDOABDGAc5SEK2O",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1376824718/reactions"
            },
            "updated_at": "2023-01-10T07:12:05Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1376824718",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I think this is probably a bug:\r\n\r\n```\r\nattr = self.attr\r\n```\r\n\r\nHere we're initializing `attr` with a known C float, so `attr` should be inferred as a C float.\r\n\r\nThere might be a good reason for it but it definitely looks wrong at first glance.",
            "created_at": "2023-01-10T07:36:31Z",
            "html_url": "https://github.com/cython/cython/issues/5202#issuecomment-1376843950",
            "id": 1376843950,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5202",
            "node_id": "IC_kwDOABDGAc5SEPiu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1376843950/reactions"
            },
            "updated_at": "2023-01-10T07:36:31Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1376843950",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Ok, sorry, I misread the bug description then (too many `attr` names in the example).\r\n\r\nIt might have to do with the fact that we often infer C double for Python float. I'm not so sure if the user intention is clear in the example. If you do any arithmetic on the variable afterwards, you'd probably end up with a C double value instead of a C float value at some point, unless you're very careful typing literals as C float instead of C double.\r\n\r\nIn any case, inferring the `attr` variable as Python float object in your example seems wrong. We should at least infer a C floating point type for it, preferably C float.",
            "created_at": "2023-01-10T07:46:24Z",
            "html_url": "https://github.com/cython/cython/issues/5202#issuecomment-1376852753",
            "id": 1376852753,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5202",
            "node_id": "IC_kwDOABDGAc5SERsR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1376852753/reactions"
            },
            "updated_at": "2023-01-10T07:47:15Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1376852753",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "Apologies for the crude example. This might be a better one:\r\n\r\n```cython\r\ncdef class Rectangle:\r\n    cdef float x_len, y_len\r\n\r\n    @cython.infer_types.verbose(True)\r\n    cdef float get_area(self):\r\n        area = self.x_len * self.y_len\r\n        return area\r\n```\r\n`area` is inferred to be a Python object, despite being the product of two floats.\r\n\r\nAlso, just for the record, manually typing it works fine:\r\n`cdef float area = self.x_len * self.y_len` generates the correct c code: `__pyx_v_area = (__pyx_v_self->x_len * __pyx_v_self->y_len);`",
            "created_at": "2023-01-10T14:31:11Z",
            "html_url": "https://github.com/cython/cython/issues/5202#issuecomment-1377367670",
            "id": 1377367670,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5202",
            "node_id": "IC_kwDOABDGAc5SGPZ2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1377367670/reactions"
            },
            "updated_at": "2023-01-10T14:46:40Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1377367670",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/39242775?v=4",
                "events_url": "https://api.github.com/users/trevor-pope/events{/privacy}",
                "followers_url": "https://api.github.com/users/trevor-pope/followers",
                "following_url": "https://api.github.com/users/trevor-pope/following{/other_user}",
                "gists_url": "https://api.github.com/users/trevor-pope/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/trevor-pope",
                "id": 39242775,
                "login": "trevor-pope",
                "node_id": "MDQ6VXNlcjM5MjQyNzc1",
                "organizations_url": "https://api.github.com/users/trevor-pope/orgs",
                "received_events_url": "https://api.github.com/users/trevor-pope/received_events",
                "repos_url": "https://api.github.com/users/trevor-pope/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/trevor-pope/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/trevor-pope/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/trevor-pope"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5202/comments",
    "created_at": "2023-01-09T22:36:36Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-01-10T07:12:04Z",
            "event": "labeled",
            "id": 8188801344,
            "label": {
                "color": "444444",
                "name": "R: worksforme"
            },
            "node_id": "LE_lADOABDGAc5a-6e_zwAAAAHoFzFA",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8188801344"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-01-10T07:12:05Z",
            "event": "closed",
            "id": 8188801487,
            "node_id": "CE_lADOABDGAc5a-6e_zwAAAAHoFzHP",
            "performed_via_github_app": null,
            "state_reason": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8188801487"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10536947?v=4",
                "events_url": "https://api.github.com/users/da-woods/events{/privacy}",
                "followers_url": "https://api.github.com/users/da-woods/followers",
                "following_url": "https://api.github.com/users/da-woods/following{/other_user}",
                "gists_url": "https://api.github.com/users/da-woods/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/da-woods",
                "id": 10536947,
                "login": "da-woods",
                "node_id": "MDQ6VXNlcjEwNTM2OTQ3",
                "organizations_url": "https://api.github.com/users/da-woods/orgs",
                "received_events_url": "https://api.github.com/users/da-woods/received_events",
                "repos_url": "https://api.github.com/users/da-woods/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/da-woods/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/da-woods/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/da-woods"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-01-10T07:36:31Z",
            "event": "reopened",
            "id": 8188954071,
            "node_id": "REE_lADOABDGAc5a-6e_zwAAAAHoGYXX",
            "performed_via_github_app": null,
            "state_reason": "reopened",
            "url": "https://api.github.com/repos/cython/cython/issues/events/8188954071"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-01-10T07:46:36Z",
            "event": "unlabeled",
            "id": 8189028689,
            "label": {
                "color": "444444",
                "name": "R: worksforme"
            },
            "node_id": "UNLE_lADOABDGAc5a-6e_zwAAAAHoGqlR",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8189028689"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-01-10T07:46:36Z",
            "event": "labeled",
            "id": 8189028697,
            "label": {
                "color": "444444",
                "name": "defect"
            },
            "node_id": "LE_lADOABDGAc5a-6e_zwAAAAHoGqlZ",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8189028697"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2023-01-10T07:46:36Z",
            "event": "labeled",
            "id": 8189028701,
            "label": {
                "color": "444444",
                "name": "Type Analysis"
            },
            "node_id": "LE_lADOABDGAc5a-6e_zwAAAAHoGqld",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/cython/cython/issues/events/8189028701"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5202/events",
    "html_url": "https://github.com/cython/cython/issues/5202",
    "id": 1526441919,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425553654,
            "name": "defect",
            "node_id": "MDU6TGFiZWw0MjU1NTM2NTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/defect"
        },
        {
            "color": "444444",
            "default": false,
            "description": null,
            "id": 425558824,
            "name": "Type Analysis",
            "node_id": "MDU6TGFiZWw0MjU1NTg4MjQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/Type%20Analysis"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5202/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5a-6e_",
    "number": 5202,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5202/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": "reopened",
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5202/timeline",
    "title": "[BUG] Incorrect type inference for floats",
    "updated_at": "2023-01-10T14:46:40Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5202",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/39242775?v=4",
        "events_url": "https://api.github.com/users/trevor-pope/events{/privacy}",
        "followers_url": "https://api.github.com/users/trevor-pope/followers",
        "following_url": "https://api.github.com/users/trevor-pope/following{/other_user}",
        "gists_url": "https://api.github.com/users/trevor-pope/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/trevor-pope",
        "id": 39242775,
        "login": "trevor-pope",
        "node_id": "MDQ6VXNlcjM5MjQyNzc1",
        "organizations_url": "https://api.github.com/users/trevor-pope/orgs",
        "received_events_url": "https://api.github.com/users/trevor-pope/received_events",
        "repos_url": "https://api.github.com/users/trevor-pope/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/trevor-pope/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/trevor-pope/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/trevor-pope"
    }
}