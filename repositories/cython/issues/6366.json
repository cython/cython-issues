{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Describe the bug\n\nCurrently python-flint has a CI job that tests against Cython master branch to measure coverage (gh-6341). That job was passing but has recently (today?) started failing.\n\n### Code to reproduce the behaviour:\n\nI don't have a simple reproducer but here is the error message:\r\n```console\r\n[34/111] Compiling Cython source /home/runner/work/python-flint/python-flint/src/flint/types/nmod.pyx\r\nFAILED: src/flint/types/nmod.cpython-312-x86_64-linux-gnu.so.p/src/flint/types/nmod.pyx.c \r\ncython -M --fast-fail -3 -X embedsignature=True -X emit_code_comments=True -X linetrace=True /home/runner/work/python-flint/python-flint/src/flint/types/nmod.pyx -o src/flint/types/nmod.cpython-312-x86_64-linux-gnu.so.p/src/flint/types/nmod.pyx.c\r\nTraceback (most recent call last):\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/bin/cython\", line 8, in <module>\r\n    sys.exit(setuptools_main())\r\n             ^^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line [74](https://github.com/flintlib/python-flint/actions/runs/10567756039/job/29278457452?pr=179#step:8:75)9, in setuptools_main\r\n    return main(command_line = 1)\r\n           ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 772, in main\r\n    result = compile(sources, options)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 668, in compile\r\n    return compile_multiple(source, options)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 642, in compile_multiple\r\n    result = run_pipeline(source, options,\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 529, in run_pipeline\r\n    err, enddata = Pipeline.run_pipeline(pipeline, source)\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 404, in run_pipeline\r\n    data = run(phase, data)\r\n           ^^^^^^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 386, in run\r\n    return phase(data)\r\n           ^^^^^^^^^^^\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 50, in generate_pyx_code_stage\r\n    module_node.process_implementation(options, result)\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/ModuleNode.py\", line 226, in process_implementation\r\n    self.generate_c_code(env, options, result)\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/ModuleNode.py\", line 548, in generate_c_code\r\n    globalstate.finalize_main_c_code()\r\n  File \"Cython/Compiler/Code.py\", line 1464, in Cython.Compiler.Code.GlobalState.finalize_main_c_code\r\n  File \"Cython/Compiler/Code.py\", line 1495, in Cython.Compiler.Code.GlobalState.close_global_decls\r\n  File \"Cython/Compiler/Code.py\", line 1727, in Cython.Compiler.Code.GlobalState.generate_const_declarations\r\n  File \"Cython/Compiler/Code.py\", line 2005, in Cython.Compiler.Code.GlobalState.generate_codeobject_constants\r\n  File \"/opt/hostedtoolcache/Python/3.12.5/x64/lib/python3.12/site-packages/Cython/Compiler/ExprNodes.py\", line 10259, in generate_codeobj\r\n    line_table = StringEncoding.bytes_literal(build_line_table(func.node_positions, first_lineno).encode('iso8[85](https://github.com/flintlib/python-flint/actions/runs/10567756039/job/29278457452?pr=179#step:8:86)9-1'), 'iso8859-1')\r\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"Cython/Compiler/LineTable.py\", line 16, in Cython.Compiler.LineTable.build_line_table\r\n  File \"Cython/Compiler/LineTable.py\", line 39, in Cython.Compiler.LineTable.encode_single_position\r\nAssertionError: 38 >= 39\r\n```\r\nNote that I am editing this source file so this might not be triggered by a very new change in Cython but this is only seen with Cython master branch and not with latest released Cython \n\n### Expected behaviour\n\n_No response_\n\n### OS\n\n_No response_\n\n### Python version\n\n_No response_\n\n### Cython version\n\n_No response_\n\n### Additional context\n\nhttps://github.com/flintlib/python-flint/actions/runs/10567756039/job/29278457452?pr=179",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for the quick report. The failing lines are (apparently) here:\r\nhttps://github.com/flintlib/python-flint/blob/53a1c3f62161d6137bcbcdbda02ee4bca411004a/src/flint/types/nmod.pyx#L38-L39\r\nThe only special thing about them is the (converted) f-string, which injects optimised syntax tree nodes. I suspect that this might make a difference. However, I tried running the above `cython` command on the file and it succeeded on my side (latest master). I noticed that the `setup.py` is different from this (meson?) build command line in that it passes `binding=False`, so I tried that as well but it also succeeded. Thus, I cannot currently reproduce this failure locally.\r\n\r\nThat said, I pushed a rewrite of the position building code that should make it more robust. Could you try if that works for you?\r\nhttps://github.com/cython/cython/commit/ccc54f9dd2e018d740d5a5cb3d03226a49f88aea",
            "created_at": "2024-08-27T05:18:18Z",
            "html_url": "https://github.com/cython/cython/issues/6366#issuecomment-2311592113",
            "id": 2311592113,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6366",
            "node_id": "IC_kwDOABDGAc6JyBix",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2311592113/reactions"
            },
            "updated_at": "2024-08-27T05:18:18Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2311592113",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I noticed that the `setup.py` is different from this (meson?) build command line in that it passes `binding=False`, so I tried that as well but it also succeeded.\r\n\r\nThe meson build is what we use now. The setup.py is just there for compatibility purposes in case someone happens to be using it. After we have had a full release with the meson build if there seem to be no problems then we will remove it.\r\n\r\nI'm not sure why setup.py sets binding=False and I don't think that it was intentional that we changed that in the meson build. Apparently I set binding=False in https://github.com/flintlib/python-flint/pull/35 which was about Cython 3's change to `__radd__` etc methods (`c_api_binop_methods`). The comments in the PR indicate that at the time I was having issues with different versions of cython so it may have just been something needed for some particular prerelease or it may have just been something that I decided was a good idea...\r\n\r\nDoes `binding=True` affect performance in any way when calling methods from cython code?\r\n\r\n> Thus, I cannot currently reproduce this failure locally.\r\n\r\nI have just reproduced it locally using the commit cython 26fd2ba9dcc37ca2a4d0b540a5102e20d8a1c4ff (current `master^` which precedes your suggested commit above) but only in python-flint's coverage-enabled build with `bin/coverage.sh`:\r\n\r\nhttps://github.com/flintlib/python-flint/blob/53a1c3f62161d6137bcbcdbda02ee4bca411004a/bin/coverage.sh#L18\r\nhttps://github.com/flintlib/python-flint/blob/53a1c3f62161d6137bcbcdbda02ee4bca411004a/meson.build#L62-L65\r\n\r\nI have just tried ccc54f9dd2e018d740d5a5cb3d03226a49f88aea (current master, i.e. your suggested commit) and I can still reproduce it so that change hasn't fixed it:\r\n```\r\n$ meson setup --wipe build --pkg-config-path=.local/lib/pkgconfig -Dadd_flint_rpath=true -Dbuildtype=debug -Dcoverage=true\r\n$ bin/coverage.sh \r\nDirectory already configured.\r\n\r\nJust run your build command (e.g. ninja) and Meson will regenerate as necessary.\r\nRun \"meson setup --reconfigure to force Meson to regenerate.\r\n\r\nIf build failures persist, run \"meson setup --wipe\" to rebuild from scratch\r\nusing the same options as passed when configuring the build.\r\n$ meson compile -C build\r\nninja: Entering directory `/home/oscar/current/active/python-flint/build'\r\n[1/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/flint_base/flint_context.pyx\r\n[2/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/pyflint.pyx\r\n[3/114] Compiling C object src/flint/pyflint.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_pyflint.pyx.c.o\r\n[4/114] Linking target src/flint/pyflint.cpython-312-x86_64-linux-gnu.so\r\n[5/114] Compiling C object src/flint/flint_base/flint_context.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_flint_base_flint_context.pyx.c.o\r\n[6/114] Linking target src/flint/flint_base/flint_context.cpython-312-x86_64-linux-gnu.so\r\n[7/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/flint_base/flint_base.pyx\r\n[8/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpz_mat.pyx\r\n[9/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpz.pyx\r\n[10/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpz_poly.pyx\r\n[11/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpz_vec.pyx\r\n[12/114] Compiling C object src/flint/types/fmpz_mat.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpz_mat.pyx.c.o\r\n[13/114] Linking target src/flint/types/fmpz_mat.cpython-312-x86_64-linux-gnu.so\r\n[14/114] Compiling C object src/flint/types/fmpz_vec.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpz_vec.pyx.c.o\r\n[15/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpz_series.pyx\r\n[16/114] Linking target src/flint/types/fmpz_vec.cpython-312-x86_64-linux-gnu.so\r\n[17/114] Compiling C object src/flint/types/fmpz.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpz.pyx.c.o\r\n[18/114] Linking target src/flint/types/fmpz.cpython-312-x86_64-linux-gnu.so\r\n[19/114] Compiling C object src/flint/types/fmpz_poly.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpz_poly.pyx.c.o\r\n[20/114] Linking target src/flint/types/fmpz_poly.cpython-312-x86_64-linux-gnu.so\r\n[21/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpq.pyx\r\n[22/114] Compiling C object src/flint/types/fmpz_series.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpz_series.pyx.c.o\r\n[23/114] Linking target src/flint/types/fmpz_series.cpython-312-x86_64-linux-gnu.so\r\n[24/114] Compiling C object src/flint/flint_base/flint_base.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_flint_base_flint_base.pyx.c.o\r\n[25/114] Linking target src/flint/flint_base/flint_base.cpython-312-x86_64-linux-gnu.so\r\n[26/114] Compiling C object src/flint/types/fmpq.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpq.pyx.c.o\r\n[27/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpq_poly.pyx\r\n[28/114] Linking target src/flint/types/fmpq.cpython-312-x86_64-linux-gnu.so\r\n[29/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpq_mat.pyx\r\n[30/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpq_vec.pyx\r\n[31/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/nmod.pyx\r\nFAILED: src/flint/types/nmod.cpython-312-x86_64-linux-gnu.so.p/src/flint/types/nmod.pyx.c \r\ncython -M --fast-fail -3 -X embedsignature=True -X emit_code_comments=True -X linetrace=True /home/oscar/current/active/python-flint/src/flint/types/nmod.pyx -o src/flint/types/nmod.cpython-312-x86_64-linux-gnu.so.p/src/flint/types/nmod.pyx.c\r\nTraceback (most recent call last):\r\n  File \"/home/oscar/.pyenv/versions/python-flint-3.12/bin/cython\", line 8, in <module>\r\n    sys.exit(setuptools_main())\r\n             ^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 749, in setuptools_main\r\n    return main(command_line = 1)\r\n           ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 772, in main\r\n    result = compile(sources, options)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 668, in compile\r\n    return compile_multiple(source, options)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 642, in compile_multiple\r\n    result = run_pipeline(source, options,\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 529, in run_pipeline\r\n    err, enddata = Pipeline.run_pipeline(pipeline, source)\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 404, in run_pipeline\r\n    data = run(phase, data)\r\n           ^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 386, in run\r\n    return phase(data)\r\n           ^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 50, in generate_pyx_code_stage\r\n    module_node.process_implementation(options, result)\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/ModuleNode.py\", line 226, in process_implementation\r\n    self.generate_c_code(env, options, result)\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/ModuleNode.py\", line 548, in generate_c_code\r\n    globalstate.finalize_main_c_code()\r\n  File \"Cython/Compiler/Code.py\", line 1464, in Cython.Compiler.Code.GlobalState.finalize_main_c_code\r\n  File \"Cython/Compiler/Code.py\", line 1495, in Cython.Compiler.Code.GlobalState.close_global_decls\r\n  File \"Cython/Compiler/Code.py\", line 1727, in Cython.Compiler.Code.GlobalState.generate_const_declarations\r\n  File \"Cython/Compiler/Code.py\", line 2005, in Cython.Compiler.Code.GlobalState.generate_codeobject_constants\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/ExprNodes.py\", line 10259, in generate_codeobj\r\n    line_table = StringEncoding.bytes_literal(build_line_table(func.node_positions, first_lineno).encode('iso8859-1'), 'iso8859-1')\r\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"Cython/Compiler/LineTable.py\", line 16, in Cython.Compiler.LineTable.build_line_table\r\n  File \"Cython/Compiler/LineTable.py\", line 39, in Cython.Compiler.LineTable.encode_single_position\r\nAssertionError: 38 >= 39\r\n[32/114] Compiling C object src/flint/types/fmpq_vec.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpq_vec.pyx.c.o\r\n[33/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/fmpq_series.pyx\r\n[34/114] Compiling C object src/flint/types/fmpq_mat.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpq_mat.pyx.c.o\r\n[35/114] Compiling C object src/flint/types/fmpq_poly.cpython-312-x86_64-linux-gnu.so.p/meson-generated_src_flint_types_fmpq_poly.pyx.c.o\r\n[36/114] Compiling Cython source /home/oscar/current/active/python-flint/src/flint/types/nmod_poly.pyx\r\nninja: build stopped: subcommand failed.\r\nINFO: autodetecting backend as ninja\r\nINFO: calculating backend command to run: /home/oscar/.pyenv/versions/python-flint-3.12/bin/ninja -C /home/oscar/current/active/python-flint/build\r\n```\r\nI can also reproduce it by running that cython command directly:\r\n```console\r\n$ cython -M --fast-fail -3 -X embedsignature=True -X emit_code_comments=True -X linetrace=True /home/oscar/current/active/python-flint/src/flint/types/nmod.pyx -o src/flint/types/nmod.cpython-312-x86_64-linux-gnu.so.p/src/flint/types/nmod.pyx.c\r\nTraceback (most recent call last):\r\n  File \"/home/oscar/.pyenv/versions/python-flint-3.12/bin/cython\", line 8, in <module>\r\n    sys.exit(setuptools_main())\r\n             ^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 749, in setuptools_main\r\n    return main(command_line = 1)\r\n           ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 772, in main\r\n    result = compile(sources, options)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 668, in compile\r\n    return compile_multiple(source, options)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 642, in compile_multiple\r\n    result = run_pipeline(source, options,\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Main.py\", line 529, in run_pipeline\r\n    err, enddata = Pipeline.run_pipeline(pipeline, source)\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 404, in run_pipeline\r\n    data = run(phase, data)\r\n           ^^^^^^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 386, in run\r\n    return phase(data)\r\n           ^^^^^^^^^^^\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/Pipeline.py\", line 50, in generate_pyx_code_stage\r\n    module_node.process_implementation(options, result)\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/ModuleNode.py\", line 226, in process_implementation\r\n    self.generate_c_code(env, options, result)\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/ModuleNode.py\", line 548, in generate_c_code\r\n    globalstate.finalize_main_c_code()\r\n  File \"Cython/Compiler/Code.py\", line 1464, in Cython.Compiler.Code.GlobalState.finalize_main_c_code\r\n  File \"Cython/Compiler/Code.py\", line 1495, in Cython.Compiler.Code.GlobalState.close_global_decls\r\n  File \"Cython/Compiler/Code.py\", line 1727, in Cython.Compiler.Code.GlobalState.generate_const_declarations\r\n  File \"Cython/Compiler/Code.py\", line 2005, in Cython.Compiler.Code.GlobalState.generate_codeobject_constants\r\n  File \"/home/oscar/.pyenv/versions/3.12.0/envs/python-flint-3.12/lib/python3.12/site-packages/Cython/Compiler/ExprNodes.py\", line 10259, in generate_codeobj\r\n    line_table = StringEncoding.bytes_literal(build_line_table(func.node_positions, first_lineno).encode('iso8859-1'), 'iso8859-1')\r\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"Cython/Compiler/LineTable.py\", line 16, in Cython.Compiler.LineTable.build_line_table\r\n  File \"Cython/Compiler/LineTable.py\", line 39, in Cython.Compiler.LineTable.encode_single_position\r\nAssertionError: 38 >= 39\r\n```\r\nHowever I only see that failure in my PR branch and not with python-flint master: https://github.com/flintlib/python-flint/pull/179.\r\n\r\nSo I guess these are the lines you wanted to point to:\r\nhttps://github.com/flintlib/python-flint/blob/bf8c48b1b1ac39d55d904bb826f1f971c414167e/src/flint/types/nmod.pyx#L38-L39",
            "created_at": "2024-08-27T09:31:22Z",
            "html_url": "https://github.com/cython/cython/issues/6366#issuecomment-2312022822",
            "id": 2312022822,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6366",
            "node_id": "IC_kwDOABDGAc6Jzqsm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2312022822/reactions"
            },
            "updated_at": "2024-08-27T09:31:22Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2312022822",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1159732?v=4",
                "events_url": "https://api.github.com/users/oscarbenjamin/events{/privacy}",
                "followers_url": "https://api.github.com/users/oscarbenjamin/followers",
                "following_url": "https://api.github.com/users/oscarbenjamin/following{/other_user}",
                "gists_url": "https://api.github.com/users/oscarbenjamin/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/oscarbenjamin",
                "id": 1159732,
                "login": "oscarbenjamin",
                "node_id": "MDQ6VXNlcjExNTk3MzI=",
                "organizations_url": "https://api.github.com/users/oscarbenjamin/orgs",
                "received_events_url": "https://api.github.com/users/oscarbenjamin/received_events",
                "repos_url": "https://api.github.com/users/oscarbenjamin/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/oscarbenjamin/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/oscarbenjamin/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/oscarbenjamin"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I'm not sure why setup.py sets binding=False\r\n\r\nNow I remember it was because binding=True made it 2-3x slower to get a coverage enabled build: https://github.com/cython/cython/issues/4425#issuecomment-1352331162\r\n\r\nThat seems less of an issue now that we have meson with fast incremental parallel rebuilds.",
            "created_at": "2024-08-27T09:44:58Z",
            "html_url": "https://github.com/cython/cython/issues/6366#issuecomment-2312054653",
            "id": 2312054653,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6366",
            "node_id": "IC_kwDOABDGAc6Jzyd9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2312054653/reactions"
            },
            "updated_at": "2024-08-27T09:44:58Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2312054653",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1159732?v=4",
                "events_url": "https://api.github.com/users/oscarbenjamin/events{/privacy}",
                "followers_url": "https://api.github.com/users/oscarbenjamin/followers",
                "following_url": "https://api.github.com/users/oscarbenjamin/following{/other_user}",
                "gists_url": "https://api.github.com/users/oscarbenjamin/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/oscarbenjamin",
                "id": 1159732,
                "login": "oscarbenjamin",
                "node_id": "MDQ6VXNlcjExNTk3MzI=",
                "organizations_url": "https://api.github.com/users/oscarbenjamin/orgs",
                "received_events_url": "https://api.github.com/users/oscarbenjamin/received_events",
                "repos_url": "https://api.github.com/users/oscarbenjamin/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/oscarbenjamin/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/oscarbenjamin/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/oscarbenjamin"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Thanks, I can also reproduce it with that branch. It's a bug. It considers 39 the first line of the function, but the first code in that function comes from the `@staticmethod` decorator, one line above. I'm glad I put in that assertion. :)",
            "created_at": "2024-08-27T10:29:30Z",
            "html_url": "https://github.com/cython/cython/issues/6366#issuecomment-2312150991",
            "id": 2312150991,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/6366",
            "node_id": "IC_kwDOABDGAc6J0J_P",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/2312150991/reactions"
            },
            "updated_at": "2024-08-27T10:29:30Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/2312150991",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/6366/comments",
    "created_at": "2024-08-26T22:30:55Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/6366/events",
    "html_url": "https://github.com/cython/cython/issues/6366",
    "id": 2487900945,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/6366/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc6USlsR",
    "number": 6366,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/6366/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/6366/timeline",
    "title": "[BUG] Assertion error from `encode_single_position`,",
    "updated_at": "2024-08-27T10:29:31Z",
    "url": "https://api.github.com/repos/cython/cython/issues/6366",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1159732?v=4",
        "events_url": "https://api.github.com/users/oscarbenjamin/events{/privacy}",
        "followers_url": "https://api.github.com/users/oscarbenjamin/followers",
        "following_url": "https://api.github.com/users/oscarbenjamin/following{/other_user}",
        "gists_url": "https://api.github.com/users/oscarbenjamin/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/oscarbenjamin",
        "id": 1159732,
        "login": "oscarbenjamin",
        "node_id": "MDQ6VXNlcjExNTk3MzI=",
        "organizations_url": "https://api.github.com/users/oscarbenjamin/orgs",
        "received_events_url": "https://api.github.com/users/oscarbenjamin/received_events",
        "repos_url": "https://api.github.com/users/oscarbenjamin/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/oscarbenjamin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/oscarbenjamin/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/oscarbenjamin"
    }
}