{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Is your feature request related to a problem? Please describe.\r\n\r\nCurrently the recommended method for building Cython modules is [using setuptools via setup.py](https://cython.readthedocs.io/en/latest/src/quickstart/build.html). While this is still completely valid, the general trend of the Python packaging ecosystem is to move away from this pattern. This is true in multiple respects:\r\n- [setuptools is migrating away from arbitrary code in setup.py to a static setup.cfg config file](https://setuptools.pypa.io/en/latest/userguide/quickstart.html#transitioning-from-setup-py-to-setup-cfg)\r\n- [PEP 517 specifies how to define build backends other than setuptools](https://peps.python.org/pep-0517/)\r\n- Support for more complex builds involving Cython and extensive C/C++ libraries has dramatically improved over the years with the advent of tools like [`meson-python`](https://github.com/mesonbuild/meson-python) and [`scikit-build`](https://github.com/scikit-build/scikit-build/)\r\n\r\nI do not know if Cython has any plans for supporting setup.cfg files (I wasn't able to find anything in the issue tracker), nor do I have enough knowledge of Cython internals to propose a plan for how Cython could be integrated into a setup.cfg-based build. For projects leveraging tools like meson or CMake, though, it there is a fairly should be possible to chart a reasonable path forward here.\r\n\r\n### Describe the solution you'd like.\r\n\r\nThe general pattern for Python builds using an underlying build system is to use `cython` to transpile Cython code into C/C++ and then to manage compilation of the resulting source file using the build generator (as opposed to using `cythonize`) since that allows users to leverage the full features of the build system to control the compilation. I do not personally make use of Meson, but I do have experience with CMake and scikit-build. To help facilitate the transition for Cython users using more extensive CMake-based builds, I would like for Cython to provide a CMake module that (at minimum) defines a function that can be used to run the `cython` CLI and generate code with it. This function would provide an interface to all the command line flags for the `cython` CLI and handle any necessary preprocessing. The resulting module could then be used by e.g. `scikit-build` users or those manually handling CMake-based compilation.\r\n\r\nIf the developers are interested in this feature, I am happy to contribute it in a PR.\r\n\r\n### Describe alternatives you've considered.\r\n\r\n[`scikit-build` currently provides a `UseCython.cmake` module for this purpose](https://github.com/scikit-build/scikit-build/blob/main/skbuild/resources/cmake/UseCython.cmake). However, the successor package [`scikit-build-core`](https://github.com/scikit-build/scikit-build-core) does not. I originally considered porting the functionality there, but the Cython project itself seems like a more appropriate home for this logic. Moreover, putting this code into Cython would allow other builders to also take advantage of it instead of relying on `scikit-build-core`.\r\n\r\n### Additional context\r\n\r\nThe one caveat with putting this module into Cython is that if Cython is installed via pip the module will go into the Python site-packages prefix. This location will not be on CMake's module search path by default, unlike if it was installed directly into the primary $PREFIX directly (e.g. a system /usr/lib directory equivalent, or perhaps a conda env prefix). That means that users would either need to query Python's CLI using a CMake custom command to get the site directory, or CMake would need to add support for this directly. Some discussion of that is in [the CMake issue I originally opened regarding Cython support](https://gitlab.kitware.com/cmake/cmake/-/issues/24982).",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "FYI, a good example of supporting this, without requiring CMake when building Cython, is at https://github.com/wjakob/nanobind/blob/master/cmake/nanobind-config.cmake (and an example that does require CMake at build time can be found in pybind11, but I think this is better). By supplying a cmake/cython-config.cmake file in the PyPI package, `find_package(cython)` will work out-of-the-box in [scikit-build-core](https://github.com/scikit-build/scikit-build-core) (and therefore eventually in scikit-build classic too). (As mentioned above, there's a bit of querying that you'd have to do if you are using CMake directly; that can be simplified a little by providing a helper function that produces the location of the cmake module; and I'm hoping to improve support for this in CMake in the future.)\r\n\r\nIf you are interested in this, I could either help develop or eventually contribute the file.",
            "created_at": "2023-06-14T19:55:28Z",
            "html_url": "https://github.com/cython/cython/issues/5486#issuecomment-1591887109",
            "id": 1591887109,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5486",
            "node_id": "IC_kwDOABDGAc5e4kUF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1591887109/reactions"
            },
            "updated_at": "2023-06-14T21:04:57Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1591887109",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4616906?v=4",
                "events_url": "https://api.github.com/users/henryiii/events{/privacy}",
                "followers_url": "https://api.github.com/users/henryiii/followers",
                "following_url": "https://api.github.com/users/henryiii/following{/other_user}",
                "gists_url": "https://api.github.com/users/henryiii/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/henryiii",
                "id": 4616906,
                "login": "henryiii",
                "node_id": "MDQ6VXNlcjQ2MTY5MDY=",
                "organizations_url": "https://api.github.com/users/henryiii/orgs",
                "received_events_url": "https://api.github.com/users/henryiii/received_events",
                "repos_url": "https://api.github.com/users/henryiii/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/henryiii/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/henryiii/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/henryiii"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Meson also added native support for Cython: https://mesonbuild.com/Cython.html",
            "created_at": "2023-06-15T04:46:33Z",
            "html_url": "https://github.com/cython/cython/issues/5486#issuecomment-1592350079",
            "id": 1592350079,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/5486",
            "node_id": "IC_kwDOABDGAc5e6VV_",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/cython/cython/issues/comments/1592350079/reactions"
            },
            "updated_at": "2023-06-15T04:46:33Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/1592350079",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33685575?v=4",
                "events_url": "https://api.github.com/users/h-vetinari/events{/privacy}",
                "followers_url": "https://api.github.com/users/h-vetinari/followers",
                "following_url": "https://api.github.com/users/h-vetinari/following{/other_user}",
                "gists_url": "https://api.github.com/users/h-vetinari/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/h-vetinari",
                "id": 33685575,
                "login": "h-vetinari",
                "node_id": "MDQ6VXNlcjMzNjg1NTc1",
                "organizations_url": "https://api.github.com/users/h-vetinari/orgs",
                "received_events_url": "https://api.github.com/users/h-vetinari/received_events",
                "repos_url": "https://api.github.com/users/h-vetinari/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/h-vetinari/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/h-vetinari/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/h-vetinari"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/5486/comments",
    "created_at": "2023-06-14T16:35:21Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/5486/events",
    "html_url": "https://github.com/cython/cython/issues/5486",
    "id": 1757278187,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/5486/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOABDGAc5ove_r",
    "number": 5486,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/cython/cython/issues/5486/reactions"
    },
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/cython/cython/issues/5486/timeline",
    "title": "[ENH] Add CMake module for compiling Cython code",
    "updated_at": "2023-06-15T04:46:34Z",
    "url": "https://api.github.com/repos/cython/cython/issues/5486",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1538165?v=4",
        "events_url": "https://api.github.com/users/vyasr/events{/privacy}",
        "followers_url": "https://api.github.com/users/vyasr/followers",
        "following_url": "https://api.github.com/users/vyasr/following{/other_user}",
        "gists_url": "https://api.github.com/users/vyasr/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/vyasr",
        "id": 1538165,
        "login": "vyasr",
        "node_id": "MDQ6VXNlcjE1MzgxNjU=",
        "organizations_url": "https://api.github.com/users/vyasr/orgs",
        "received_events_url": "https://api.github.com/users/vyasr/received_events",
        "repos_url": "https://api.github.com/users/vyasr/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/vyasr/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/vyasr/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/vyasr"
    }
}