{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "**Describe the bug**\r\n\r\nThe frame objects passed to profile or trace functions have incorrect values of `f_back` attribute\r\n\r\n**To Reproduce**\r\n\r\nCode to reproduce the behaviour:\r\n\r\n## mod.pyx file\r\n```cython\r\n# cython: profile=True\r\n# cython: trace=True\r\n\r\ndef foo(callback, *args):\r\n    bar(callback, args)\r\n\r\ndef bar(callback, args):\r\n    callback(*args)\r\n```\r\n\r\n## main.py file\r\n\r\n```python\r\nimport sys\r\nfrom mod import foo\r\n\r\ndef trace(frame, *args):\r\n    print(frame.f_code.co_name, frame.f_back.f_code.co_name if frame.f_back else None)\r\n\r\nsys.setprofile(trace)\r\n\r\ndef foop():\r\n    ...\r\n\r\nfoo(foop)\r\n```\r\n\r\nthis prints:\r\n\r\n```\r\n<module> None\r\nfoo <module>\r\nbar <module>\r\nfoop <module>\r\nfoop <module>\r\nbar <module>\r\nfoo <module>\r\n<module> None\r\n<module> None\r\n```\r\n\r\nNotice that this is incorrect as this claims that the parent frame of every cython and python frame is `<module>`, which is not correct.\r\n\r\n**Expected behavior**\r\n\r\nThis example should print:\r\n\r\n```\r\n<module> None\r\nfoo <module>\r\nbar foo\r\nfoop bar\r\nfoop bar\r\nbar foo\r\nfoo <module>\r\n<module> None\r\n<module> None\r\n```\r\n\r\nThis has to be achieved by correctly populating `f_back` when Cython creates frames that are passed to the trace function.\r\n",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/4207/comments",
    "created_at": "2021-06-01T19:07:38Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/4207/events",
    "html_url": "https://github.com/cython/cython/issues/4207",
    "id": 908604647,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/4207/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU5MDg2MDQ2NDc=",
    "number": 4207,
    "performed_via_github_app": null,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "[BUG] Cython created frame objects have an incorrect value for `f_back`",
    "updated_at": "2021-06-01T19:09:11Z",
    "url": "https://api.github.com/repos/cython/cython/issues/4207",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11718525?v=4",
        "events_url": "https://api.github.com/users/pablogsal/events{/privacy}",
        "followers_url": "https://api.github.com/users/pablogsal/followers",
        "following_url": "https://api.github.com/users/pablogsal/following{/other_user}",
        "gists_url": "https://api.github.com/users/pablogsal/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/pablogsal",
        "id": 11718525,
        "login": "pablogsal",
        "node_id": "MDQ6VXNlcjExNzE4NTI1",
        "organizations_url": "https://api.github.com/users/pablogsal/orgs",
        "received_events_url": "https://api.github.com/users/pablogsal/received_events",
        "repos_url": "https://api.github.com/users/pablogsal/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/pablogsal/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pablogsal/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/pablogsal"
    }
}