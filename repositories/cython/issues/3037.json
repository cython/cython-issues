{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Hi I have a problem while free the memory spaces after the vector usage.\r\n\r\n```\r\ncdef vector[Mystruct] cb\r\n.... #do something\r\ncb.clear()\r\n```\r\n\r\nAfter running the program, the memory usage is not reduced which indicate the usage memory is not deallocated. in vector `.clear()` function it is not free the memory usage. In C++ 11 we can use `shrink_to_fit()` function as state in [here](https://stackoverflow.com/questions/35514909/how-to-clear-vector-in-c-from-memory), however I can't use shrink_to_fit function inside the cython, and throws this error while compiling it.\r\n\r\n```\r\nhas no member named ‘shrink_to_fit’\r\n   __pyx_v_cb.shrink_to_fit();\r\n\r\n```\r\nI also consider swap() function where we can just swap the vector by 0 length vector but its still not working.\r\n```\r\ncdef vector[Mystruct] cb\r\ncdef vector[Mystruct] dummy\r\n.... #do something\r\ncb.swap(dummy)\r\n```\r\nI also use garbage collector in python but also not working.\r\n```\r\nimport gc\r\ncdef vector[Mystruct] cb\r\n.... #do something\r\ncb.clear()\r\ngc.collect()\r\n```\r\nSo is there any solution for this problem?, I am using `Cython 0.29.11` and `gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.10)`.\r\n\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> the memory usage is not reduced\r\n\r\nDo you mean the memory used by the process? That's not necessarily a good indicator as it tends to be influenced by many factors, not just single chunks of memory.\r\n\r\n> can't use `shrink_to_fit`\r\n\r\nYou have to enable C++11 support in your C compiler for that, e.g. `CXXFLAGS=-std=c++11`.\r\n\r\nCan you provide a complete example that shows your problem? It's quite likely that the `#do something` has more impact on what you are witnessing than the `cb.clear()`.\r\n\r\nIn any case, this is most likely not related to a bug in Cython, and thus shouldn't be discussed on the bug tracker. The cython-users mailing list seems a more appropriate place.",
            "created_at": "2019-07-09T07:26:24Z",
            "html_url": "https://github.com/cython/cython/issues/3037#issuecomment-509524061",
            "id": 509524061,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3037",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTUyNDA2MQ==",
            "updated_at": "2019-07-09T07:27:40Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/509524061",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "Hello @scoder, thanks for the reply. \r\nYes, it is the memory used by the process because I have assigned a huge vector to record some data, then after I used it I want to free the memory. However, I can't free it. So do something is only cython vector `push_back()` function which spends about 2GB of memory. I think `cb.clear()` is the problem because before and after call `cb.clear()` it not reduce some memory, maybe at least 1 GB or even 2GB. Second is how to enable C++11 for cython?, I have a problem while using `extra_compile_args=[\"-std=c++11\"]` in linux.  It gives me this error `ValueError: got unknown compilation option, please remove: extra_compile_args` . The last I am sorry since I am newbie in here I don't know that the mailing list is exist. Is there any cython forum discussion which more convenient rather than a mailing list?\r\n-Thank you-",
            "created_at": "2019-07-09T07:56:26Z",
            "html_url": "https://github.com/cython/cython/issues/3037#issuecomment-509533897",
            "id": 509533897,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/3037",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTUzMzg5Nw==",
            "updated_at": "2019-07-09T07:56:26Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/509533897",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/2309538?v=4",
                "events_url": "https://api.github.com/users/herleeyandi/events{/privacy}",
                "followers_url": "https://api.github.com/users/herleeyandi/followers",
                "following_url": "https://api.github.com/users/herleeyandi/following{/other_user}",
                "gists_url": "https://api.github.com/users/herleeyandi/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/herleeyandi",
                "id": 2309538,
                "login": "herleeyandi",
                "node_id": "MDQ6VXNlcjIzMDk1Mzg=",
                "organizations_url": "https://api.github.com/users/herleeyandi/orgs",
                "received_events_url": "https://api.github.com/users/herleeyandi/received_events",
                "repos_url": "https://api.github.com/users/herleeyandi/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/herleeyandi/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/herleeyandi/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/herleeyandi"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/3037/comments",
    "created_at": "2019-07-09T07:09:49Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-07-09T07:56:26Z",
            "event": "mentioned",
            "id": 2468447927,
            "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MjQ2ODQ0NzkyNw==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2468447927"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-07-09T07:56:26Z",
            "event": "subscribed",
            "id": 2468447928,
            "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDI0Njg0NDc5Mjg=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2468447928"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/3037/events",
    "html_url": "https://github.com/cython/cython/issues/3037",
    "id": 465609467,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/3037/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU0NjU2MDk0Njc=",
    "number": 3037,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Free vector memory in cython",
    "updated_at": "2019-07-09T07:56:26Z",
    "url": "https://api.github.com/repos/cython/cython/issues/3037",
    "user": {
        "avatar_url": "https://avatars2.githubusercontent.com/u/2309538?v=4",
        "events_url": "https://api.github.com/users/herleeyandi/events{/privacy}",
        "followers_url": "https://api.github.com/users/herleeyandi/followers",
        "following_url": "https://api.github.com/users/herleeyandi/following{/other_user}",
        "gists_url": "https://api.github.com/users/herleeyandi/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/herleeyandi",
        "id": 2309538,
        "login": "herleeyandi",
        "node_id": "MDQ6VXNlcjIzMDk1Mzg=",
        "organizations_url": "https://api.github.com/users/herleeyandi/orgs",
        "received_events_url": "https://api.github.com/users/herleeyandi/received_events",
        "repos_url": "https://api.github.com/users/herleeyandi/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/herleeyandi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/herleeyandi/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/herleeyandi"
    }
}