{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "```\r\ndef print_kwargs(**kwargs):\r\n    print(kwargs)\r\n\r\nprint_kwargs(**{'a': 'a', 'a': 'b'})\r\n```\r\nThis works in python, but not when compiled with Cython. I think it might have something to do with the way kwargs are unpacked.\r\n\r\nIt's good to point out that **this** is illegal in python, and will raise a SyntaxError(keyword argument repeated):\r\n`print_kwargs(a='a', a='b')`\r\n\r\nAlso worth pointing out that, Interestingly enough, this works the same in python as in cython:\r\n`print({'a': 'a', 'a': 'b'})`\r\nprinting `{'a': 'b'}`",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "One one hand, I believe I've run into this issue in another function call in my own code that's basically as follows:\r\n\r\n```python3\r\nobjecttype(**{**parameterdict, 'overwrittenparameter': x})\r\n```\r\n\r\n`TypeError: function() got multiple values for keyword argument 'overwrittenparameter'`\r\n\r\nBut on the other hand, I can't seem to reproduce it using an inline Cython version of the example in the OP:\r\n\r\n```python3\r\n>>> cprint_kwargs=cython.inline(\"def f(**kwargs):\\n print(kwargs)\\nreturn f\")\r\n>>> cprint_kwargs(**{'a': 'a', 'a': 'b'})\r\n{'a': 'b'}\r\n```\r\n",
            "created_at": "2019-05-21T18:15:58Z",
            "html_url": "https://github.com/cython/cython/issues/2963#issuecomment-494500916",
            "id": 494500916,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2963",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NDUwMDkxNg==",
            "updated_at": "2019-05-21T18:15:58Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/494500916",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/37680486?v=4",
                "events_url": "https://api.github.com/users/will-ca/events{/privacy}",
                "followers_url": "https://api.github.com/users/will-ca/followers",
                "following_url": "https://api.github.com/users/will-ca/following{/other_user}",
                "gists_url": "https://api.github.com/users/will-ca/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/will-ca",
                "id": 37680486,
                "login": "will-ca",
                "node_id": "MDQ6VXNlcjM3NjgwNDg2",
                "organizations_url": "https://api.github.com/users/will-ca/orgs",
                "received_events_url": "https://api.github.com/users/will-ca/received_events",
                "repos_url": "https://api.github.com/users/will-ca/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/will-ca/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/will-ca/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/will-ca"
            }
        },
        {
            "author_association": "NONE",
            "body": "I wonder if Python is handling the kwargs before calling the the function? Can you inline a call to the function?",
            "created_at": "2019-05-21T18:25:21Z",
            "html_url": "https://github.com/cython/cython/issues/2963#issuecomment-494504204",
            "id": 494504204,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2963",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NDUwNDIwNA==",
            "updated_at": "2019-05-21T18:25:21Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/494504204",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/16691565?v=4",
                "events_url": "https://api.github.com/users/joshuahaertel/events{/privacy}",
                "followers_url": "https://api.github.com/users/joshuahaertel/followers",
                "following_url": "https://api.github.com/users/joshuahaertel/following{/other_user}",
                "gists_url": "https://api.github.com/users/joshuahaertel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joshuahaertel",
                "id": 16691565,
                "login": "joshuahaertel",
                "node_id": "MDQ6VXNlcjE2NjkxNTY1",
                "organizations_url": "https://api.github.com/users/joshuahaertel/orgs",
                "received_events_url": "https://api.github.com/users/joshuahaertel/received_events",
                "repos_url": "https://api.github.com/users/joshuahaertel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joshuahaertel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joshuahaertel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joshuahaertel"
            }
        },
        {
            "author_association": "NONE",
            "body": "Ah, yeah. The dictionary and keyword arguments would have probably been processed and consolidated completely by CPython before being passed into the Cythonized bits.\r\n\r\nInlining the function call does produce the broken result:\r\n\r\n```python3\r\n>>> cython.inline(\"def f(**kwargs):\\n print(kwargs)\\nf(**{'a': 'a', 'a': 'b'})\")\r\nTypeError: function() got multiple values for keyword argument 'a'\r\n```\r\n",
            "created_at": "2019-05-21T18:30:45Z",
            "html_url": "https://github.com/cython/cython/issues/2963#issuecomment-494506115",
            "id": 494506115,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2963",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NDUwNjExNQ==",
            "updated_at": "2019-05-21T18:31:29Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/494506115",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/37680486?v=4",
                "events_url": "https://api.github.com/users/will-ca/events{/privacy}",
                "followers_url": "https://api.github.com/users/will-ca/followers",
                "following_url": "https://api.github.com/users/will-ca/following{/other_user}",
                "gists_url": "https://api.github.com/users/will-ca/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/will-ca",
                "id": 37680486,
                "login": "will-ca",
                "node_id": "MDQ6VXNlcjM3NjgwNDg2",
                "organizations_url": "https://api.github.com/users/will-ca/orgs",
                "received_events_url": "https://api.github.com/users/will-ca/received_events",
                "repos_url": "https://api.github.com/users/will-ca/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/will-ca/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/will-ca/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/will-ca"
            }
        },
        {
            "author_association": "NONE",
            "body": "Wrapping the dictionary in any kind of code that constructs a new dictionary does make it work however:\r\n\r\n```python3\r\n>>> cython.inline(\"return (lambda **kwargs: kwargs)(**{'a': 'a', 'a': 'b'})\")\r\nTypeError: function() got multiple values for keyword argument 'a'\r\n>>> cython.inline(\"return (lambda **kwargs: kwargs)(**dict({'a': 'a', 'a': 'b'}))\")\r\n{'a': 'b'}\r\n```\r\n\r\nBut I do find this a little strange, as I'd naively expect the original example to just call the dictionary constructor and unpackers?",
            "created_at": "2019-05-21T18:43:10Z",
            "html_url": "https://github.com/cython/cython/issues/2963#issuecomment-494510441",
            "id": 494510441,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2963",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NDUxMDQ0MQ==",
            "updated_at": "2019-05-21T18:43:10Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/494510441",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/37680486?v=4",
                "events_url": "https://api.github.com/users/will-ca/events{/privacy}",
                "followers_url": "https://api.github.com/users/will-ca/followers",
                "following_url": "https://api.github.com/users/will-ca/following{/other_user}",
                "gists_url": "https://api.github.com/users/will-ca/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/will-ca",
                "id": 37680486,
                "login": "will-ca",
                "node_id": "MDQ6VXNlcjM3NjgwNDg2",
                "organizations_url": "https://api.github.com/users/will-ca/orgs",
                "received_events_url": "https://api.github.com/users/will-ca/received_events",
                "repos_url": "https://api.github.com/users/will-ca/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/will-ca/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/will-ca/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/will-ca"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2963/comments",
    "created_at": "2019-05-20T22:45:21Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2963/events",
    "html_url": "https://github.com/cython/cython/issues/2963",
    "id": 446341921,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2963/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU0NDYzNDE5MjE=",
    "number": 2963,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Properly Handle Duplicate Kwargs",
    "updated_at": "2019-05-21T18:43:10Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2963",
    "user": {
        "avatar_url": "https://avatars0.githubusercontent.com/u/16691565?v=4",
        "events_url": "https://api.github.com/users/joshuahaertel/events{/privacy}",
        "followers_url": "https://api.github.com/users/joshuahaertel/followers",
        "following_url": "https://api.github.com/users/joshuahaertel/following{/other_user}",
        "gists_url": "https://api.github.com/users/joshuahaertel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/joshuahaertel",
        "id": 16691565,
        "login": "joshuahaertel",
        "node_id": "MDQ6VXNlcjE2NjkxNTY1",
        "organizations_url": "https://api.github.com/users/joshuahaertel/orgs",
        "received_events_url": "https://api.github.com/users/joshuahaertel/received_events",
        "repos_url": "https://api.github.com/users/joshuahaertel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/joshuahaertel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joshuahaertel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/joshuahaertel"
    }
}